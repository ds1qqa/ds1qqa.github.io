<!DOCType HTML>
<HTML xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#" manifest="cache.manifest" lang="ko">
<HEAD>
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<meta name="mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width">
<title>Morse Trainer</title>
<link rel='stylesheet' href='script/codemirror.css'>
<script>window.console = window.console || function(t) {};</script>
<script src='script/codemirror.js'></script>
<script src='script/xml.js'></script>
<script src='script/mark-selection.js'></script>
<script src="script/hangul.js"></script>
<link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square-round.css" rel="stylesheet">
<link href="https://hangeul.pstatic.net/hangeul_static/css/maru-buri.css" rel="stylesheet">
<link rel='stylesheet' href='script/style.css'>
</HEAD>
<BODY>
<Table id="main_table" cellspacing=0 cellpadding=0 bordercolor="#F2F2F2" bgcolor="white" border=0 align="center" valign="top">
    <tr><td align="center" valign="middle" class="sticky-row" bgcolor="white" width="500" height="60">
        <div id="main_button">
            <fieldset id="main_control" style="text-align:center;">
            <legend> ğŸ£ Main Menu ğŸ£ </legend>
            <button id="play" class="main_button" style="width:80px;" title="PLAY, PAUSE ALT+P" accesskey="p">PLAY</button>
            <button id="stop" class="main_button" title="STOP ALT+S" accesskey="s">STOP</button>
            <button id="make_mp3" class="main_button" title="CREATE MP3 FILE ALT+M" accesskey="m">ğŸ’¾ MP3</button>
            <button id="make_tze" class="main_button" title="MAKE 1TZE FILE ALT+T" accesskey="t">ğŸ’¾ 1TZE</button>
            <button id="reset" class="main_button" title="OPTION RESET ALT+R" accesskey="r">RESET</button>
            <input type="checkbox" id="view1" title="OPTION VIEW TOGGLE ALT+K" style="width:24px;height:24px;margin: 0px 0px 0px 2px;" accesskey="k">
            <input type="checkbox" id="view2" title="BUTTON VIEW TOGGLE ALT+L" style="width:24px;height:24px;margin: 0px 0px 0px 2px;" accesskey="l">
            <input type="checkbox" id="view3" title="BUTTON VIEW TOGGLE ALT+;" style="width:24px;height:24px;margin: 0px 0px 0px 2px;" accesskey=";">
            <button  style="width:28px;height:24px;margin: 0px 0px 0px 2px;" onclick="qrcode_toggle();" title="Qrcode Link View">Q</button>
            <script>
                function qrcode_toggle(){
                    const qrcode = document.getElementById('qrcodeImage');
                    if (qrcode.style.display === 'none') {
                        qrcode.style.display = 'block';
                    }else{
                        qrcode.style.display = 'none';
                    } 
                }
                function toggleSetting1(check_value) {
                    const settingElements = document.querySelectorAll('.setting');
                    if(check_value==true){
                        window.localStorage.setItem('view1', "true");
                        settingElements.forEach(element => {
                            element.style.display = 'none';
                        });
                        document.getElementById("keyer_setting").style.display = 'none';
                    }else{
                        window.localStorage.setItem('view1', "false");
                        settingElements.forEach(element => {
                            element.style.display = 'block';
                        });
                        if(!isAndroid && !isIOS) document.getElementById("keyer_setting").style.display = 'inline-block';
                    }
                    updateLayerPosition()
                }
                function toggleSetting2(check_value) {
                    const settingElements = document.querySelectorAll('#word');
                    if(check_value==true){
                        window.localStorage.setItem('view2', "true");
                        settingElements.forEach(element => {
                            element.style.display = 'none';
                        });
                    }else{
                        window.localStorage.setItem('view2', "false");
                        settingElements.forEach(element => {
                            element.style.display = 'block';
                        });
                    }
                    updateLayerPosition()
                }
                function toggleSetting3(check_value) {
                    const element1 = document.querySelector('.class_view3');
                    if(check_value==true){
                        localStorage.setItem('view3', 'true');
                        element1.style.display = 'none';
                    }else{
                        localStorage.setItem('view3', 'false');
                        element1.style.display = 'block';
                    }
                    updateLayerPosition()
                };
            </script>
        </fieldset>
        <img id="qrcodeImage" src="qrcode.png" style="display:none;position:relative;">
    </div>
</td></tr>
<tr><td align="center"><span id="mp3" style="display:none;"> </span> <a id="tze"> </a></td></tr>
<tr><td align=left>
    <div class="setting" style="text-align:center;">
        <fieldset id="option"><legend> â–¶ï¸ Play Setup â–¶ï¸</legend>
            <span class="setting_bold">Font:</span>
            <select id="font_select" style="width:150px;text-align:left;color:blue;" title="https://brunch.co.kr/@jade/203">
                <option value="Helvetica" style="font-family: 'Helvetica';" Selected>Helvetica</option>
                <option value="sanserif" style="font-family: 'sanserif';">Sanserif</option>
                <option value="MaruBuriExtraLight" style="font-family: 'MaruBuriExtraLight';">ë§ˆë£¨ë¶€ë¦¬ ExtraLight</option>
                <option value="MaruBuriLight" style="font-family: 'MaruBuriLight';">ë§ˆë£¨ë¶€ë¦¬ Light</option>
                <option value="MaruBuri" style="font-family: 'MaruBuri';">ë§ˆë£¨ë¶€ë¦¬</option>
                <option value="MaruBuriSemiBold" style="font-family: 'MaruBuriExtraLight';">ë§ˆë£¨ë¶€ë¦¬ SemiBold</option>
                <option value="MaruBuriBold" style="font-family: 'MaruBuriBold';">ë§ˆë£¨ë¶€ë¦¬ Bold</option>
                <option value="NanumSquareRound" style="font-family: 'NanumSquareRound';">ë‚˜ëˆ”ìŠ¤í€˜ì–´ ë¼ìš´ë“œ</option>
                <option value="NanumSquareRoundB" style="font-family: 'NanumSquareRoundBold';">ë‚˜ëˆ”ìŠ¤í€˜ì–´ ë¼ìš´ë“œ B</option>
                <option value="NanumSquareRoundL" style="font-family: 'NanumSquareRoundLarge';">ë‚˜ëˆ”ìŠ¤í€˜ì–´ L</option>
                <option value="NanumSquareRoundEB" style="font-family: 'NanumSquareRoundExtra Bold';">ë‚˜ëˆ”ìŠ¤í€˜ì–´ B</option>
                <option value="EBSSR" style="font-family: 'EBSSR';">EBSí›ˆë¯¼ì •ìŒ ìƒˆë¡ R</option>
                <option value="EBSSB" style="font-family: 'EBSSB';">EBSí›ˆë¯¼ì •ìŒ ìƒˆë¡ B</option>
                <option value="EBSL" style="font-family: 'EBSL';">EBSí›ˆë¯¼ì •ìŒ L</option>
                <option value="EBSR" style="font-family: 'EBSR';">EBSí›ˆë¯¼ì •ìŒ R</option>
                <option value="EBSSL" style="font-family: 'EBSSL';">EBSí›ˆë¯¼ì •ìŒ ìƒˆë¡ L</option>
                <option value="EBSSSB" style="font-family: 'EBSSSB';">EBSí›ˆë¯¼ì •ìŒ ìƒˆë¡ SB</option>
                <option value="HancomHoonminjeongeumH" style="font-family: 'HancomHoonminjeongeumH';">í•œì»´í›ˆë¯¼ì •ìŒ H</option>
                <option value="JejuHallasan" style="font-family: 'JejuHallasan';">ì œì£¼í•œë¼ì‚°</option>
                <option value="BusanFont_Provisional" style="font-family: 'BusanFont_Provisional';">ë¶€ì‚°ì‹œì²­ ë¶€ì‚°ì²´</option>
                <option value="youth" style="font-family: 'youth';">ì²­ì†Œë…„ì²´</option>
                <option value="dongB" style="font-family: 'dongB';">ë™ê·¸ë¼ë¯¸ì¬ë‹¨</option>
                <option value="HSbombaramche2" style="font-family: 'HSbombaramche2';">HSë´„ë°”ëŒì²´2.0</option>
                <option value="netmarbleB" style="font-family: 'netmarbleB';">ë„·ë§ˆë¸”</option>
                <option value="JalnanGothic" style="font-family: 'yg-jalnan';">ì˜ë‚œì²´</option>
                <option value="sdmisaeng" style="font-family: 'sdmisaeng';">ë¯¸ìƒì²´</option>
                <option value="Binggrae-Bold" style="font-family: 'Binggrae-Bold';">Binggrae-Bold</option>
                <option value="BinggraeMelona-Bold" style="font-family: 'BinggraeMelona-Bold';">BinggraeMelona-Bold</option>
                <option value="BinggraeSamanco-Bold" style="font-family: 'BinggraeSamanco-Bold';">BinggraeSamanco-Bold</option>
                <option value="BinggraeTaom-Bold" style="font-family: 'BinggraeTaom-Bold';">BinggraeTaom-Bold</option>
                <option value="LOTTEMARTHBMedium" style="font-family: 'LOTTEMARTHBMedium';">ë¡¯ë°ë§ˆíŠ¸ í–‰ë³µ Medium</option>
                <option value="LOTTEMARTDRMedium" style="font-family: 'LOTTEMARTDRMedium';">ë¡¯ë°ë§ˆíŠ¸ ë“œë¦¼ Medium</option>
                <option value="LOTTEMARTDRLight" style="font-family: 'LOTTEMARTDRLight';">ë¡¯ë°ë§ˆíŠ¸ ë“œë¦¼ Light</option>
                <option value="LOTTEMARTDRBold" style="font-family: 'LOTTEMARTDRBold';">ë¡¯ë°ë§ˆíŠ¸ ë“œë¦¼ Bold</option>
                <option value="IropkeBatangM" style="font-family: 'IropkeBatangM';">ì´ë¡­ê²Œ ë°”íƒ•ì²´</option>
                <option value="Hankyoreh_Font" style="font-family: 'Hankyoreh_Font';">í•œê²¨ë ˆ ê²°ì²´</option>
            </select>
            <script>
                document.getElementById('font_select').addEventListener('change', function() {
                    var font_select = document.getElementById('font_select');
                    document.body.style.fontFamily = font_select.value;
                    localStorage.setItem('font_name', font_select.value)
                    updateLayerPosition();
                });
            </script>
            &nbsp;
            <span class="setting_bold">Freq:</span>
            <select id="freq" name="freq" style="width:80px;text-align:center;">
                <option value="100">100</option><option value="150">150</option><option value="200">200</option><option value="250">250</option><option value="300">300</option><option value="350">350</option><option value="400">400</option><option value="450">450</option>
                <option value="500">500</option><option value="510">510</option><option value="520">520</option><option value="530">530</option><option value="540">540</option><option value="550">550</option><option value="560">560</option><option value="570">570</option><option value="580">580</option><option value="590">590</option><option value="600" selected>600</option>
                <option value="610">610</option><option value="620">620</option><option value="630">630</option><option value="640">640</option><option value="650">650</option><option value="660">660</option><option value="670">670</option><option value="680">680</option><option value="690">690</option><option value="700">700</option>
                <option value="710">710</option><option value="720">720</option><option value="730">730</option><option value="740">740</option><option value="750">750</option><option value="760">760</option><option value="770">770</option><option value="780">780</option><option value="790">790</option><option value="800">800</option>
                <option value="810">810</option><option value="820">820</option><option value="830">830</option><option value="840">840</option><option value="850">850</option><option value="860">860</option><option value="870">870</option><option value="880">880</option><option value="890">890</option><option value="900">900</option>
                <option value="910">910</option><option value="920">920</option><option value="930">930</option><option value="940">940</option><option value="950">950</option><option value="960">960</option><option value="970">970</option><option value="980">980</option><option value="990">990</option><option value="1000">1,000</option>
                <option value="1100">1,100</option><option value="1200">1,200</option><option value="1300">1,300</option><option value="1400">1,400</option><option value="1500">1,500</option><option value="1600">1,600</option><option value="1700">1,700</option><option value="1800">1,800</option><option value="1900">1,900</option><option value="2000">2,000</option>
            </select>
            Hz
            &nbsp;
            <span class="setting_bold">Speed:</span>
            <select id="speed" name="speed" style="width:50px;text-align:center;">
                <option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
                <option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20" selected>20</option>
                <option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option>
                <option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option>
                <option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option>
                <option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option><option value="60">60</option>
            </select>Wpm
            &nbsp;
            <span class="setting_bold">Volume:</span>
            <select id="volume" name="volume" style="width:60px;text-align:center;">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
                <option value="60">60</option>
                <option value="70">70</option>
                <option value="80" selected>80</option>
                <option value="90">90</option>
                <option value="100">100</option>
            </select>%
            &nbsp;
            <span class="setting_bold">Extra Gap:</span>
            <select id="selectkey" name="key" style="width:120px;text-align:center;">
                <option id="selectkey1" value="computer" selected>None(1.0)</option>
                <option value="hangul_smaller">Small(2.0)</option>
                <option value="hangul_small">Smaller(1.5)</option>
                <option value="hangul">Large(3.0)</option>
                <option value="elmer">Small</option>
                <option value="farnsworth">Large</option>
                <option value="straightmed">Random Medium</option>
                <option value="straightbad">Random Bad</option>
                <option value="straightvbad">Random Very Bad</option>
            </select>
            &nbsp;
            <span class="setting_bold">Play:</span>
            <input type="checkbox" id="selection_only" /><label for='selection_only'>Select Only</label>
            <input type="checkbox" id="repeat" /><label for='repeat'>ğŸ”Repeat</label>
            &nbsp;
            <span class="setting_bold">Highlight:</span>
            <input type="checkbox" id="highlight_slowly" /><label for='highlight_slowly'>Slowly</label>
            <input type="checkbox" id="hide_text" /><label for="hide_text">Hide</label>
            &nbsp;
            <span class="setting_bold">Effect:</span>
            <input type="checkbox" id="flute"><label for="flute">Flute</label>
            <input type="checkbox" id="noise"><label for="noise">Noise</label>
            <input type="checkbox" id="fading"><label for="fading">Fading</label>&nbsp;
            <div id="keyer_setting">âœ… CW Keyer: <button id="connect">Key Connect</button> <button id="disconnect">Un Connected</button> (IC-7300, 7610 USB Keying(CW)-DTR</div>
        </fieldset>
    </div>
</td></tr>
<tr><td align="left">
    <div id="word">
        <fieldset id="option"><legend> ğŸ’¦ Generate Setup ğŸ’¦ </legend>
            <span class="setting_bold">Repeat:</span>
                <select id="repeat_count" name="repeat_count" style="width:40px;">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>&nbsp;
                <span class="setting_bold">Space:</span>
                <select id="word_space" style="width:50px;">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
                &nbsp;
            <span class="setting_bold">Count:</span>
            <select id="gen_number" style="width: 70px;">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30" selected>30</option>
                <option value="40">40</option>
                <option value="50">50</option>
                <option value="60">60</option>
                <option value="70">70</option>
                <option value="80">80</option>
                <option value="90">90</option>
                <option value="100">100</option>
                <option value="150">150</option>
                <option value="200">200</option>
                <option value="250">250</option>
                <option value="300">300</option>
                <option value="350">350</option>
                <option value="400">400</option>
                <option value="450">450</option>
                <option value="500">500</option>
                <option value="600">600</option>
                <option value="700">700</option>
                <option value="800">800</option>
                <option value="900">900</option>
                <option value="1000">1,000</option>
            </select>
            <select id="gen_random_option" style="width:130px;color:blue;">
                <option value="" style="text-align:center;">RANDOM</option>
                <option value="random_hl_callsigns">1. HL Callsign</option>
                <option value="random_ja_callsigns">2. JA Callsign</option>
                <option value="random_babv_callsigns">3. BA/BV Callsign</option>
                <option value="random_hlja_callsigns">4. HL/JA Callsign</option>
                <option value="random_hlbabv_callsigns">5. HL/BA/BV Callsign</option>
                <option value="random_jababv_callsigns">6. JA/BA/BV Callsign</option>
                <option value="random_hljababv_callsigns">7. HL/JA/BA/BV Callsign</option>
                <option value="random_itu_callsigns" title="data source: https://en.wikipedia.org/wiki/ITU_prefix">8. World Callsign</option>
                <option value="">--------------------</option>
                <option value="random_qso_elements">9. Qso Elements</option>
                <option value="random_qso_basic_elements">10. Basic Elements</option>
                <option value="random_stamp_qso">11. Stamp Qso</option>
                <option value="random_hl_words">12. Han Words</option>
                <option value="random_hl_phrases">13. Han Phrases</option>
                <option value="random_qso2_elements">14. General Word</option>
                <option value="random_kdn">15. Kdn No</option>
                <option value="random_kdn_city">16. Kdn City Name</option>
                <option value="">--------------------</option>
                <option value="random_qcode">17. Q Code</option>
                <option value="random_number">18. Number</option>
                <option value="random_alphabat">19. Alphabat</option>
                <option value="random_specialchar">20. Special Character</option>
                <option value="random_number_alphabat">21. Number, Alphabat</option>
                <option value="random_alphabat_specialchar">22. Alphabat, Special Character</option>
                <option value="random_number_alphabat_specialchar">23. Number, Alphabat, Special Character</option>
                <option value="">--------------------</option>
                <option value="random_jaum">24. í•œê¸€ ììŒ</option>
                <option value="random_moum">25. í•œê¸€ ëª¨ìŒ</option>
                <option value="random_jaummoum">26. í•œê¸€ ììŒ,ëª¨ìŒ</option>
                <option value="">--------------------</option>
                <option value="random_hiragana">27. Wabun code(ã²ã‚‰ãŒãª)</option>
                <option value="random_katakana">28. Wabun code(ã‚«ã‚¿ã‚«ãƒŠ)</option>
            </select>
            &nbsp;
            <span class="setting_bold">Hangul Letter:</span>
            <input type="checkbox" id="random"/><label for="random">Random</label>
            <input type="checkbox" id="extend"/><label for="extend">Extend</label>
            <select id="gen_syllables_option" style="width:200px;color:blue;">
                <option value="" style="text-align:center;">HANGUL LETTER</option>
                <option value="hangul_initial_consonants">1. HANGUL INITIAL CONSONANT</option>
                <option value="hangul_simple_vowels">2. HANGUL SIMPLE VOWELS</option>
                <option value="hangul_simple_syllables">3. HANGUL SIMPLE SYLLABLES</option>
                <option value="hangul_final_consonants">4. HANGUL FINAL CONSONANTS</option>
                <option value="hangul_syllables">5. HANGUL SYLLABLES</option>
                <option value="hangul_complex_vowels">6. HANGUL COMPLEX VOWELS</option>
                <option value="hangul_complex_syllables">7. HANGUL COMPLEX SYLLABLES</option>
                <option value="hangul_random_syllables">8. HANGUL RANDOM SYLLABLES</option>
                <option value="hangul_frequent_syllables">9. HANGUL FREQUENT SYLLABLES</option>
            </select>
            <select id="gen_hangul_option" style="width:170px;color:blue">
                <option value="" style="text-align:center;">HANGUL QSO</option>
                <option value="hangul_qso_1">1. HANGUL QSO1</option>
                <option value="hangul_qso_2">2. HANGUL QSO2</option>
                <option value="hangul_qso_3">3. HANGUL QSO3</option>
                <option value="hangul_qso_4">4. HANGUL QSO4</option>
                <option value="">--------------------</option>
                <option value="english_qso_1">5. ENGLISH QSO1</option>
                <option value="english_qso_2">6. ENGLISH QSO1</option>
            </select>
        </span>
        &nbsp;
        <span class="setting_bold">Count:</span>
            <select id="loadScript_getcount" style="width: 60px;">
                <option value="5">5</option>
                <option value="10" selected>10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
                <option value="60">60</option>
                <option value="70">70</option>
                <option value="80">80</option>
                <option value="90">90</option>
                <option value="100">100</option>
                <option value="150">150</option>
                <option value="200">200</option>
                <option value="250">250</option>
                <option value="300">300</option>
                <option value="350">350</option>
                <option value="400">400</option>
                <option value="450">450</option>
                <option value="500">500</option>
                <option value="600">600</option>
                <option value="700">700</option>
                <option value="800">800</option>
                <option value="900">900</option>
                <option value="1000">1,000</option>
            </select>
            <select id="loadScript_src" style="width:130px;color:blue;">
                <option value="" style="text-align:center;">PROVERB</option>
                <option value="proverb1.dat">1. ì†ë‹´(SHORT)</option>
                <option value="proverb2.dat">2. ì†ë‹´(LONG)</option>
                <option value="shorthan.dat">3. ì†ë‹´2</option>
                <option value="proverb3.dat">4. ê²©ì–¸</option>
                <option value="proverb6.dat">5. ëª…ì‹¬ë³´ê°</option>
                <option value="hunminjeongum_prologue.dat">6. í›ˆë¯¼ì •ìŒ ì„œë¬¸</option>
                <option value="proverb4.dat">7. ë‚˜ì˜ì‚¬ë‘ í•œê¸€ë‚ </option>
                <option value="proverb5.dat">8. í•œê¸€ì´ ìˆìŒì— ë‚´ê°€ ìˆë‹¤</option>
                <option value="national_anthem.dat">9. ì• êµ­ê°€</option>
                <option value="shorteng.dat">10. SHORT ENGLISH</option>
            </select>
            &nbsp;
            <span class="setting_bold">File Open:</span>
            <input type="file" id="fileInput" accept=".txt" style="width:175px;text-align:center;height:30px;" title="Text File Open(Limit 30,000 Characters) ALT+O" accesskey="o"></span>
            <span class="setting_bold"><a onclick="add_str();">Add:</a></a></span> 
            <input type="checkbox" id="add_vvv" title="To add a character to the beginning"><label for="add_vvv">Start</label>
            <input type=text id="add_vvv_text" style="width:140px;text-align:center;" size="10" max=100 value="VVV VVV <BT>" title="Type characters to add to the beginning">
            <input type="checkbox" id="add_ar" title="To add a text at the end"><label for="add_ar">End</label>
            <input type=text id="add_ar_text" style="width:130px;text-align:center;" size="10" max=100 value="<AR>" title="Type a character to add to the end">
            <script>
                function add_str(){
                    const add_string = document.getElementById('add_vvv_text').value + ' ' + doc.getValue() + ' ' + document.getElementById('add_ar_text').value;
                    changeQsoSample(add_string);
                }
                const loadButton = document.getElementById('loadScript_src');
                loadButton.addEventListener('change', () => {
                    const script = document.createElement('script');
                    var loadScript_src = document.getElementById('loadScript_src').value;
                    if(!loadScript_src){
                        document.getElementById('loadScript_src').value = '';
                        return false;
                    }
                    var loadScript_getnumber = document.getElementById('loadScript_getcount').value;
                    script.src = 'script/' + loadScript_src;
                    document.head.appendChild(script);
                    script.onload = () => {
                        if(loadScript_getnumber <= word_data.length){
                            count = loadScript_getnumber;
                        }else{
                            count = word_data.length;
                        }
                        if(loadScript_src == 'proverb4.dat' || loadScript_src == 'proverb5.dat' )
                        {
                            count = word_data.length;
                        }else{
                            array_shuffle(word_data);
                        }
                        result_array = word_data.slice(0, count);
                        result_join = result_array.join('\n');
                        if(document.getElementById('add_vvv').checked) result_join = add_vvv_text.value + ' ' + result_join;
                        if(document.getElementById('add_ar').checked) result_join = result_join + ' ' + add_ar_text.value;
                        document.getElementById('user_txt_caption').innerHTML = word_data_caption;
                        changeQsoSample(result_join);
                    }
                    document.getElementById('loadScript_src').value='';
                });
            </script>
        </fieldset>
    </div>
</td></tr>
<tr><td width="500" align="left">
    <div class="class_view3">
        <fieldset id="user_text"><legend> ğŸµ PLAY MONITER ğŸµ </legend>
            <div id="play_moniter_top" style="width:100%;text-align:center;vertical-align:top;">
                <a id="copy_text" onclick="copy_text();" title="Copy to Clipboard ALT+C" accesskey="c" style="font-size:22px;cursor: pointer;">ğŸ“‹</a>
                <a id="copy_text" onclick="print_text();" title="Text to Print" style="font-size:22px;cursor: pointer;">ğŸ–¨ï¸</a>
                <a id="save_as_file" title="Text Save as File ALT+V" accesskey="v" style="font-size:22px;cursor: pointer;">ğŸ’¾</a>
                <a onclick="user_txt_del();" title="Text Clear ALT+N" accesskey="n" style="font-size:22px;cursor: pointer;">âŒ</a>
                <button id="font_text" onclick="resetFontSize()" title="Click to Font Size Reset">21px</button>
                <button onclick="increaseFontSize()" title="Font Size Up ALT+Q" accesskey="q">â•</button>
                <button onclick="decreaseFontSize()" title="Font Size Down ALT+W" accesskey="w">â–</button>
                <button id="textarea_count" style="color:black;text-align:right;" title="Total Count(Space Count+Character Count)">0(0+0)</button> 
                <button id="textarea_select_percent" style="width:40px;text-align:center;color:red;text-align:right;" title="Now Playing Percent">0</button>%
                <button id="textarea_select_count" style="color:red;text-align:center;" title="Now Playing Count">0</button>
                <button id="textarea_play_char" style="width:50px;color:red;text-align:center;font-size:1.2em;" title="Now Playing Character, Click to Larger View ALT+B" accesskey="b"></button>
                <input id="layer_display" type="checkbox" style="width:24px;height:24px;" title="Play on the Character displayed">
                <button id='cwport_signal' style="border-radius:14px;width:24px;height:24px;background-color:white;" title="CW Port Signal" onclick="view_toggle();"></button>
                <span class="setting_bold">Time:</span>
                <div id="timerDisplay_total" style="font-size: 1.2em;display: inline-block;" title="Total Record">00:00:00</div> / <div id="timerDisplay" style="font-size: 1.2em;display: inline-block;" title="Current Time">00:00:00</div>
                <div class="progress-bar" style="margin: 3px 0px 3px 0px;"><div class="progress"></div></div>
                <div id="char_layer" style="display:none;"><button id="textarea_select_char" style="margin: 0px 0px 0px 0px;" title="Now Playing Char"></button></div>
            </div>
            <script>
                function sos_start(){
                    if(document.getElementById('sos_check').checked){
                        window.localStorage.setItem('speed_temp', document.getElementById('speed').value);
                        window.localStorage.setItem('doc_temp', doc.getValue());
                        window.localStorage.setItem('freq_temp', document.getElementById('freq').value);
                        window.localStorage.setItem('volume_temp', document.getElementById('volume').value);
                        document.getElementById('speed').value = '10';
                        document.getElementById('volume').value = '100';
                        document.getElementById('freq').value = '700';
                        document.getElementById('repeat').checked = true;
                        document.getElementById('layer_display').checked = true;
                        changeQsoSample('SOS');
                        document.getElementById('char_layer').style.display = 'block';
                        document.getElementById('play').click();
                    }else{
                        document.getElementById('speed').value = window.localStorage.getItem('speed_temp')
                        document.getElementById('freq').value = window.localStorage.getItem('freq_temp')
                        document.getElementById('volume').value = window.localStorage.getItem('volume_temp')
                        changeQsoSample(window.localStorage.getItem('doc_temp'))
                        document.getElementById('repeat').checked = false;
                        document.getElementById('main_table').style.backgroundColor = 'white';
                        document.getElementById('stop').click();
                        document.getElementById('char_layer').style.display = 'none';
                    }
                }
                function download_document() {
                    const filename = document.getElementById('morsecode_download').value;
                    const str = '\nDownload the ' + filename + '?';
                    if (confirm(str)) {
                        const newWindow = window.open();
                        newWindow.location.href = filename;
                    }
                    document.getElementById('morsecode_download').value = '';
                }
                function copy_text(){
                    c_text = doc.getValue();
                    if(c_text.length==0){
                        alert("There's no contents!");
                        return false;
                    }else{
                        navigator.clipboard.writeText(c_text);
                        alert('\nCopied to Clipboard\n');
                    }
                    }
                    function print_text() {
                        var printContents = doc.getValue();
                        if(!printContents){
                            alert("There's no contents!");
                            return  false;
                        }
                        if(!confirm("Contents to Print?") === true) return false;
                        SaveContents = SaveContents.replace(/[^a-zA-Z0-9ê°€-í£ã-ã‚”ã‚¡-ãƒ´!@$&*()-+=,.;:'"?Ã˜\n\r]/g, ' ');
                        printContents = printContents.toUpperCase();
                        var printWindow = window.open('', '', 'width=600,height=800');
                        printWindow.document.write('<html><head><title>Print</title>');
                        printWindow.document.write('</head><body>');
                        printWindow.document.write(printContents);
                        printWindow.document.write('</body></html>');
                        printWindow.document.close();
                        printWindow.focus();
                        printWindow.print();
                    }
                    function user_txt_del(){
                        if(!confirm('Erase Contents all?')==true) return false;
                        changeQsoSample('');
                        clearDitdah();
                        setProgressBar(0);
                    }
                    function textarea_fontsize(){
                        const textarea = document.getElementById('user_txt');
                        const font_text =  document.getElementById('font_text');
                        const computedStyle = window.getComputedStyle(textarea);
                        const fontSize = computedStyle.fontSize;
                        localStorage.setItem('textarea_fontsize', fontSize);
                        document.getElementById('font_text').innerHTML = fontSize;
                    }
                    function increaseFontSize() {
                        const textarea = document.getElementById('user_txt');
                        textarea.style.fontSize = parseFloat(getComputedStyle(textarea).fontSize) + 3 + 'px';
                        textarea_fontsize()
                    }
                    function resetFontSize(){
                        const textarea = document.getElementById('user_txt');
                        const currentFontSize = parseFloat(getComputedStyle(textarea).fontSize);
                        textarea.style.fontSize = '21px';
                        textarea_fontsize()
                    }
                    function decreaseFontSize() {
                        const textarea = document.getElementById('user_txt');
                        const currentFontSize = parseFloat(getComputedStyle(textarea).fontSize);
                        const newFontSize = Math.max(currentFontSize - 3, 14);
                        textarea.style.fontSize = newFontSize + 'px';
                        textarea_fontsize()
                    }
            </script>
            <script>
                document.getElementById('save_as_file').addEventListener('click', function() {
                        var SaveContents =  doc.getValue();
                        if(!SaveContents){
                            alert("There's no Contents");
                            return  false;
                        }
                        if(!confirm("Save the Contents?") === true) return false;
                        console.log(SaveContents);
                        SaveContents = SaveContents.replace(/[^a-zA-Z0-9ê°€-í£ã-ã‚”ã‚¡-ãƒ´!@$&*()-+=,.;:'"?Ã˜\n\r]/g, ' ');
                        SaveContents = SaveContents.toUpperCase();
                        const now = new Date();
                        const year = now.getFullYear();
                        const month = String(now.getMonth() + 1).padStart(2, '0');
                        const day = String(now.getDate()).padStart(2, '0');
                        const hour = String(now.getHours()).padStart(2, '0');
                        const minute = String(now.getMinutes()).padStart(2, '0');
                        const filename = 'Morse_' + year + month + day + hour + minute + '_' + freq.value + 'Hz_' + speed.value + 'wpm.txt';

                        // const blob = new Blob([SaveContents], { type: "text/plain" });

                        // // Blob ë°ì´í„°ë¥¼ íŒŒì¼ë¡œ ë°”ë¡œ ì €ì¥
                        // const link = document.createElement("a");
                        // link.href = URL.createObjectURL(blob);
                        // link.download = filename; // ì €ì¥ë  íŒŒì¼ ì´ë¦„ ì§€ì •
                        // link.style.display = "none"; // í™”ë©´ì— í‘œì‹œí•˜ì§€ ì•ŠìŒ
                        // document.body.appendChild(link);
                        // link.click(); // í´ë¦­í•˜ì—¬ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤í–‰
                        // document.body.removeChild(link); // ì‚¬ìš© í›„ ì œê±°

                        const element = document.createElement('a');
                        element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(SaveContents));
                        element.setAttribute('download', filename);
                        element.style.display = 'none';
                        document.body.appendChild(element);
                        element.click();
                        document.body.removeChild(element);
                    }
                );
                function truncate(str, maxLength) {
                    let result = '';
                    let count = 0;
                    for (let i = 0; i < str.length && count < maxLength; i++) {
                    result += str[i];
                    count += str.codePointAt(i) > 0xFFFF ? 2 : 1;
                    }
                    return result;
                }
                document.getElementById('fileInput').addEventListener('change', function() {
                    if (!stopped) stop.click();
                        var file = this.files[0];
                        if (file) {
                            var reader = new FileReader();
                            const fileName = file.name;
                            const ext = fileName.substring(fileName.lastIndexOf('.') + 1).toLowerCase();
                            if (ext === 'txt') {
                                reader.onload = function(e) {
                                    let str = e.target.result;
                                    const parser = new DOMParser();
                                    const doc = parser.parseFromString(str, 'text/html');
                                    const textOnly = doc.body.textContent;
                                    let result = str.replace(/[^a-zA-Z0-9ê°€-í£ã-ã‚”ã‚¡-ãƒ´!@$&*()-+=,.;:'"?Ã˜\n\r]/g, ' ');
                                    result = result.split(/ +/).join('\n');
                                    const data = truncate(result, 30000);
                                    var datas = data.replace(/0/g, 'Ã˜');
                                    if(document.getElementById('add_vvv').checked) datas = "VVV VVV <BT> " + datas;
                                    if(document.getElementById('add_ar').checked) datas = datas + " <AR>";
                                    window.localStorage.setItem('user_txt', datas);
                                    changeQsoSample(datas);
                                };
                                reader.readAsText(file);
                        } else {
                            alert('txt íŒŒì¼ë§Œ ì„ íƒí•´ì£¼ì„¸ìš”.');
                        }
                    }
                });
            </script>
        <div align="left"><textarea id="user_txt"></textarea></div>
        <div class="log_container_ditdah"><span id="ditdah" align="center" title="Click to see the text you are playing in a Larger View ğŸµ"> </span></div>
        <div style="text-align:center;vertical-align:top;">
            <div id="user_txt_caption" style="display:block;"></div>
            <label for="sos_check"><font size="5" title="SOS SEND" style="vertical-align:middle;">ğŸš¨</font></label>
            <input type="checkbox" id="sos_check" style="width:22px;height:22px;" onchange="sos_start();" title="SOS START">
            <select id="morsecode_download" style="width:200px;color:black;border-color:white;background-color: white;margin: 0px 5px 0px 5px;" onchange="download_document();">
                <option value="" title="Morse Code Chart Download" style="text-align:center;">ğŸ’¾ Morse Code Chart</option>
                <option value="MORSE_CODE.png" title="Morse Code Chart Download">Morse Code Chart PNG ê·¸ë¦¼íŒŒì¼</option>
                <option value="MORSE_CODE.pdf" title="Morse Code Chart Download pdf">Morse Code Chart PDF ë¬¸ì„œ</option>
                <option value="MORSE_CODE_TREE_HAN.png" title="Morse Code Hangul Tree Chart Download PNG ê·¸ë¦¼íŒŒì¼">Morse Tree Hangul PNG ê·¸ë¦¼íŒŒì¼</option>
                <option value="MORSE_CODE_TREE_HAN.pdf" title="Morse Code Hangul Tree Chart Download PDF ë¬¸ì„œ">Morse Tree Hangul PDF ë¬¸ì„œ</option>
                <option value="MORSE_CODE_TREE_ENG.png" title="Morse Code Englich Tree Chart Download PNG ê·¸ë¦¼íŒŒì¼">Morse Tree English PNG ê·¸ë¦¼íŒŒì¼</option>
                <option value="MORSE_CODE_TREE_ENG.pdf" title="Morse Code Englich Tree Chart Download PDF ë¬¸ì„œ">Morse Tree English PDF ë¬¸ì„œ</option>
                <option value="morse_trainer_user_manual.html" title="Morse trainer User Manual Download HTML ì›¹ë¬¸ì„œ">Morse Trainer User Manual HTML ì›¹ë¬¸ì„œ</option>
                <option value="morse_trainer_simple_manual.pdf" title="Morse trainer User Manual Download PDF ë¬¸ì„œ">Morse Trainer User Manual PDF ë¬¸ì„œ</option>
            </select>
            <a onclick="play.click();"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fds1qqa.github.io%2Fmorse_trainer.html&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false" style="height:23px;vertical-align:middle;cursor: pointer;" title="Counter: https://hits.seeyoufarm.com"></a>
        </div>
    </fieldset>
</div>
</td></tr>
<tr><td align="center">
    <div id="original_author">Original Author: DS1TZE(<a href="https://shingiru.github.io/hangul_cw_trainer.html" target="_blank" title="Hangul CW Trainer by DS1TZE">https://shingiru.github.io</a>)</div>
</td></tr>
</table>
<script>Mp3LameEncoderConfig = { memoryInitializerPrefixURL: "" };</script>
<script src="script/Mp3LameEncoder.min.js"></script>
<script type="text/javascript">
(function(AudioContext) {
    AudioContext.prototype.createEffect = function() {
        var bufferSize = 4096;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            const inputBuffer = e.inputBuffer;
            const outputBuffer = e.outputBuffer;

            // Loop through the output channels (in this case there is only one)
            for (let channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
                const inputData = inputBuffer.getChannelData(channel);
                const outputData = outputBuffer.getChannelData(channel);

                // Loop through the 4096 samples
                for (let sample = 0; sample < inputBuffer.length; sample++) {
                    // make output equal to the same as the input
                    outputData[sample] = inputData[sample];

                    // add noise to each output sample
                    if (useNoise) outputData[sample] += ((Math.random() * 2) - 1) * 0.9; //  white noise. 0.2 noise strength 
                }
            }
        }
        return node;
    };
    
    AudioContext.prototype.createWhiteNoise = function(bufferSize) {
        bufferSize = bufferSize || 4096;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            var output = e.outputBuffer.getChannelData(0);
            for (var i = 0; i < bufferSize; i++) {
                output[i] = Math.random() * 2 - 1;
            }
        }
        return node;
    };

    AudioContext.prototype.createPinkNoise = function(bufferSize) {
        bufferSize = bufferSize || 4096;
        var b0, b1, b2, b3, b4, b5, b6;
        b0 = b1 = b2 = b3 = b4 = b5 = b6 = 0.0;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            var output = e.outputBuffer.getChannelData(0);
            for (var i = 0; i < bufferSize; i++) {
                var white = Math.random() * 2 - 1;
                b0 = 0.99886 * b0 + white * 0.0555179;
                b1 = 0.99332 * b1 + white * 0.0750759;
                b2 = 0.96900 * b2 + white * 0.1538520;
                b3 = 0.86650 * b3 + white * 0.3104856;
                b4 = 0.55000 * b4 + white * 0.5329522;
                b5 = -0.7616 * b5 - white * 0.0168980;
                output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;
                output[i] *= 0.11; // (roughly) compensate for gain
                b6 = white * 0.115926;
            }
        }
        return node;
    };

    AudioContext.prototype.createBrownNoise = function(bufferSize) {
        bufferSize = bufferSize || 4096;
        var lastOut = 0.0;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            var output = e.outputBuffer.getChannelData(0);
            for (var i = 0; i < bufferSize; i++) {
                var white = Math.random() * 2 - 1;
                output[i] = (lastOut + (0.02 * white)) / 1.02;
                lastOut = output[i];
                output[i] *= 3.5; // (roughly) compensate for gain
            }
        }
        return node;
    };
})(window.AudioContext);
</script>
<script type="text/javascript">
    MorseNode.prototype.MORSE = {
    "A": ".-",
    "B": "-...",
    "C": "-.-.",
    "D": "-..",
    "E": ".",
    "F": "..-.",
    "G": "--.",
    "H": "....",
    "I": "..",
    "J": ".---",
    "K": "-.-",
    "L": ".-..",
    "M": "--",
    "N": "-.",
    "O": "---",
    "P": ".--.",
    "Q": "--.-",
    "R": ".-.",
    "S": "...",
    "T": "-",
    "U": "..-",
    "V": "...-",
    "W": ".--",
    "X": "-..-",
    "Y": "-.--",
    "Z": "--..",

    "1": ".----",
    "2": "..---",
    "3": "...--",
    "4": "....-",
    "5": ".....",
    "6": "-....",
    "7": "--...",
    "8": "---..",
    "9": "----.",
    "0": "-----",
    
    ".": ".-.-.-",
    ",": "--..--",
    "?": "..--..",
    "/": "-..-.",
    "+": ".-.-.",
    "-": "-....-",
    "=": "-...-",
    ":": "---...",
    ";": "-.-.-.",
    "(": "-.--.",
    ")": "-.--.-",
    "'": ".----.",
    "\"": ".-..-.",
    "@": ".--.-.",
    "$" : "...-..-",
    
    "ã„±": ".-..",
    "ã„´": "..-.",
    "ã„·": "-...",
    "ã„¹": "...-",
    "ã…": "--",
    "ã…‚": ".--",
    "ã……": "--.",
    "ã…‡": "-.-",
    "ã…ˆ": ".--.",
    "ã…Š": "-.-.",
    "ã…‹": "-..-",
    "ã…Œ": "--..",
    "ã…": "---",
    "ã…": ".---",
    "ã…": ".",
    "ã…‘": "..",
    "ã…“": "-",
    "ã…•": "...",
    "ã…—": ".-",
    "ã…›": "-.",
    "ã…œ": "....",
    "ã… ": ".-.",
    "ã…¡": "-..",
    "ã…£": "..-",
    "ã…”": "-.--",
    "ã…": "--.-",

    //https://en.wikipedia.org/wiki/Wabun_code
    "ã‚": "--.--",
    "ã„": ".-",
    "ã†": "..-",
    "ãˆ": "-.---",
    "ãŠ": ".-...",
    "ã‹": ".-..",
    "ã": "-.-..",
    "ã": "...-",
    "ã‘": "-.--",
    "ã“": "----",
    "ã•": "-.-.-",
    "ã—": "--.-.",
    "ã™": "---.-",
    "ã›": ".---.",
    "ã": "---.",
    "ãŸ": "-.",
    "ã¡": "..-.",
    "ã¤": ".--.",
    "ã¦": ".-.--",
    "ã¨": "..-..",
    "ãª": ".-.",
    "ã«": "-.-.",
    "ã¬": "....",
    "ã­": "--.-",
    "ã®": "..--",
    "ã¯": "-...",
    "ã²": "--..-",
    "ãµ": "--..",
    "ã¸": ".",
    "ã»": "-..",
    "ã¾": "-..-",
    "ã¿": "..-.-",
    "ã‚€": "-",
    "ã‚": "-...-",
    "ã‚‚": "-..-.",
    "ã‚„": ".--",
    "ã‚†": "-..--",
    "ã‚ˆ": "--",
    "ã‚‰": "...",
    "ã‚Š": "--.",
    "ã‚‹": "-.--.",
    "ã‚Œ": "---",
    "ã‚": ".-.-",
    "ã‚": "-.-",
    "ã‚": ".-..-",
    "ã‚‘": ".--..",
    "ã‚’": ".---",
    "ã‚“": ".-.-.",

    "ã‚¢": "--.--",
    "ã‚¤": ".-",
    "ã‚¦": "..-",
    "ã‚¨": "-.---",
    "ã‚ª": ".-...",
    "ã‚«": ".-..",
    "ã‚­": "-.-..",
    "ã‚¯": "...-",
    "ã‚±": "-.--",
    "ã‚³": "----",
    "ã‚µ": "-.-.-",
    "ã‚·": "--.-.",
    "ã‚¹": "---.-",
    "ã‚»": ".---.",
    "ã‚½": "---.",
    "ã‚¿": "-.",
    "ã¡": "..-.",
    "ãƒ": "..-.",
    "ãƒ„": ".--.",
    "ãƒˆ": "..-..",
    "ãƒŠ": ".-.",
    "ãƒ‹": "-.-.",
    "ãƒŒ": "....",
    "ãƒ": "--.-",
    "ãƒ": "..--",
    "ãƒ": "-...",
    "ãƒ’": "--..-",
    "ãƒ•": "--..",
    "ãƒ˜": ".",
    "ãƒ›": "-..",
    "ãƒ": "-..-",
    "ãƒŸ": "..-.-",
    "ãƒ ": "-",
    "ãƒ¡": "-...-",
    "ãƒ¢": "-..-.",
    "ãƒ¤": ".--",
    "ãƒ¦": "-..--",
    "ãƒ¨": "--",
    "ãƒ©": "...",
    "ãƒª": "--.",
    "ãƒ«": "-.--.",
    "ãƒ¬": "---",
    "ãƒ­": ".-.-",
    "ãƒ¯": "-.-",
    "ãƒ°": ".-..-",
    "ãƒ±": ".--..",
    "ãƒ²": ".---",
    "ãƒ³": ".-.-.",
    "ã€": ".-.-.-",
    "ã€‚": ".-.-..",

    // for prosign
    "&" : ".-...",
    "Åœ" : "...-.",
    // non-standard
    "[" : "-...-.-",
    "]" : "...-.-",
    "^" : "-.-.-",
    "â€»" : "........"
};

MorseNode.prototype.PROSIGN = {
    "<AR>" : "+",
    "<KN>" : "(",
    "<AS>" : "&",
    "<BT>" : "=",
    "<SN>" : "Åœ",
    // non-standard
    "<BK>" : "[",
    "<SK>" : "]",
    "<VA>" : "]",
    "<KA>" : "^",
    "<HH>" : "â€»"
};

    function MorseNode(ac, rate) {
    // ac is an audio context.
    this._oscillator = ac.createOscillator();
    this._gain = ac.createGain();

    this._gain.gain.value = 0;
    this._oscillator.type = 'sine';
    this._oscillator.frequency.value = 600;
    
    this._oscillator.connect(this._gain);
    this.key = 'computer';

    if ("undefined" == typeof rate)
        rate = 20;
    this._dot = 1.2 / rate; // formula from Wikipedia.

    this._oscillator.start(0);
	this._moved = 0;
}

MorseNode.prototype.connect = function(target) {
    return this._gain.connect(target);
}

MorseNode.prototype.timeMove = function(sec) {
	if (ac.currentTime + this._moved + sec < queue[0][0]) sec = queue[0][0] - ac.currentTime - this._moved;
	else if (ac.currentTime + this._moved + sec > queue[queue.length - 1][0]) sec = queue[queue.length - 1][0] - ac.currentTime - this._moved;
	this._moved += sec;
	
	console.log(sec);
	
	var i = 0;
	for (; i < queue.length; i++)
		if (queue[i][0] > ac.currentTime + this._moved) break;
	
	this._gain.disconnect(filter);
	this._oscillator.disconnect(this._gain);
	this._gain = ac.createGain();
	this._gain.gain.value = 0;
	this._oscillator.connect(this._gain);
	this._gain.connect(filter);
	
	for (; i < queue.length; i++)
		this._gain.gain.setValueAtTime(queue[i][1], queue[i][0] - this._moved);
	
	var min = timestamp[0];
	timestamp.forEach((el, idx, ary) => { ary[idx] = el - sec; });
}

MorseNode.prototype.dotfac = function(t) {
    switch (this.key) {
            // t is type of dotvalue. l=letter int. i=inter el. s=spaces .=dit -=dah 
        case 'computer':
            return 1;
		case 'straightmed': //i and . are rather too long than too short, s the inverse rest is random
            if (t=='.' || t=='i') return Math.random()*0.33+0.95;
            if (t=='s') return Math.random()*0.2+0.85;
            return Math.random()*0.3+0.85;
        case 'straightbad':
            if (t=='.' || t=='i') return Math.random()*0.6+0.8;
            if (t=='s') return Math.random()*0.4+0.7;
            return Math.random()*0.5+0.75;
        case 'straightvbad':
            if (t=='.' || t=='i') return Math.random()*1.6+0.8;
            if (t=='s') return Math.random()*0.85+0.4;
            return Math.random()*0.8+0.6;
        case 'hangul_smaller':
			if (t=='s') return 1.5;
            if (t=='l') return 1.5;
        case 'hangul_small':
			if (t=='s') return 2;
            if (t=='l') return 2;
        case 'hangul':
			if (t=='s') return 3;
            if (t=='l') return 3;
        case 'farnsworth': //uses farnsworth
            if (t=='s') return 6;
            if (t=='l') return 4;
        case 'elmer': //uses farnsworth
            if (t=='s') return 4;
            if (t=='l') return 1.5;
            return 1;
        }
}

var smoothingDuration = 0.004;  // 10ms is very soft, icom default 4ms;
MorseNode.prototype.playChar = function(queueOnly, t, c, v) {
    for (var i = 0; i < c.length; i++) {
        switch(c[i]) {
        case '.':
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(0, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(1.0 * v, t);
			}
			enQueue(1.0 * v, t);
            t += this._dot * this.dotfac('.');
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(1.0 * v, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(0.0, t);
			}
			enQueue(0.0, t)
            break;
        case '-':
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(0, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(1.0 * v, t);
			}
			enQueue(1.0 * v, t);
            t += 3 * this._dot * this.dotfac('-');
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(1.0 * v, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(0.0, t);
			}
			enQueue(0.0, t)
            break;
        }
        t += this._dot * this.dotfac('i');
    }
    return t;
}

var timestamp = [];
var queue = [];
function enQueue(v, t) {
	queue.push([t, v]);
}
var hasHangul = false;

MorseNode.prototype.playString = function(queueOnly, t, w, v, k, fade) {
    this.key = k;
    
    w = this.convertHangulAndProsign(w.toUpperCase());
    timestamp = [];
	queue = [];
	enQueue(0, 0);
	hasHangul = false;
    
    var start = t, fv = v;
    for (var n = 0; n < w.length; n++) {
        if (fade && (t - start) > 0) { // skip face effect during first 10s
            var pointOneSec = parseInt((t - start) * 10) % 150;
            if (pointOneSec < 75) fv = v * (100 - pointOneSec) * 0.01; // gradually goes down to the quarter volume for 7.5 sec
            else fv = v * (pointOneSec - 50) * 0.01; // gradually goes up to the normal volume for 7.5 sec
        }
        if (!highlightSlowly.checked) timestamp.push(t);
        var c = w[n];
        var hangul = (c.length > 1);
        for (var i = 0; i < c.length; i++) {
            if (c[i] == ' ' || c[i] == '\u00A0') {
                t += 4 * this._dot * this.dotfac('s'); // 3 dots gap already added after ending letter before
            }
            else if ("undefined" != typeof this.MORSE[c[i]]) {
                t = this.playChar(queueOnly, t, this.MORSE[c[i]], fv); // 1 gap after dit/dah
                t += 2 * this._dot * this.dotfac('l'); // with this 2 more gap, whole gap between letter is 3
            }
        }
        if (hangul) {
            t += (2+2) * this._dot * this.dotfac('l');
			hasHangul = true;
        }
        if (highlightSlowly.checked) timestamp.push(t);
    }
    timestamp.push(t);
    
    return t;
}

MorseNode.prototype.convertHangulAndProsign = function(w) {
    // convert prosign
    for (var key in this.PROSIGN) {
        w = w.replace(new RegExp(key.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), this.PROSIGN[key]);
    }
    return Hangul.disassemble(w, true);
}

MorseNode.prototype.getSpaceDelayInMills = function() {
    return 1000 * this._dot * (this.dotfac('i') + 2 * this.dotfac('l') + 4 * this.dotfac('s'));
}

function array_shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
}

var ac, filter, morse = null, vol = 1.0, cwPort = null, cwPortInitialized = false, cwPortOpen = false;

var ua = navigator.userAgent.toLowerCase();
var isIOS = (ua.indexOf("iphone") > -1 || ua.indexOf("ipad") > -1 || ua.indexOf("ipod") > -1);
var isAndroid = ua.indexOf("android") > -1;
var isMobile = (isIOS || isAndroid);

var user_textarea = document.getElementById('user_txt');

var view1 = document.querySelector("#view1");
var view2 = document.querySelector("#view2");
var view3 = document.querySelector("#view3");
var word_space = document.querySelector("#word_space");
var repeat_count = document.querySelector("#repeat_count");
var gen_number = document.querySelector("#gen_number");
var loadScript_getcount = document.querySelector("#loadScript_getcount");
var freq = document.querySelector("#freq");
var wpm = document.querySelector("#speed");
var volume = document.querySelector("#volume");
var play = document.querySelector("#play");
var stop = document.querySelector("#stop");
var make_mp3 = document.querySelector("#make_mp3");
var makeTze = document.querySelector("#make_tze");
var keyComputer = document.getElementById('selectkey');
var keyHangulSmaller = document.getElementById('selectkey');
var keyHangulSmall = document.getElementById('selectkey');
var keyHangul = document.getElementById('selectkey');
var flute = document.querySelector("#flute");
var noise = document.querySelector("#noise");
var fading = document.querySelector("#fading");
var selectionOnly = document.querySelector("#selection_only");
var highlightSlowly = document.querySelector("#highlight_slowly");
var hideText = document.querySelector("#hide_text");
var repeat = document.querySelector("#repeat");
var connect = document.querySelector("#connect");
var disconnect = document.querySelector("#disconnect");
var layer_display = document.querySelector("#layer_display");
var add_vvv = document.querySelector("#add_vvv");
var add_ar = document.querySelector("#add_ar");
var add_vvv_text = document.querySelector("#add_vvv_text");
var add_ar_text = document.querySelector("#add_ar_text");

var gen_hangul_option = document.querySelector("#gen_hangul_option");
var gen_random_option = document.querySelector("#gen_random_option");
var gen_syllables_option = document.querySelector("#gen_syllables_option");

connect.addEventListener("click", async () => {
	if (isAndroid || isIOS) {
        alert("Mobile devices don't support serial communication.");
        return;
    }
	
	var options = { baudRate: 115200, flowControl: 'hardware' };
	if (!cwPortInitialized) {
		navigator.serial.requestPort().then(async (port) => {
			cwPort = port;
			await cwPort.open(options); // DTR should be set on the radio
			await cwPort.setSignals({dataTerminalReady:false});
			toggleConnectButtons(true);
			cwPortInitialized = true;
			cwPortOpen = true;
		}).catch((e) => {
		});
	} else if (!cwPortOpen) {
		await cwPort.open(options);
		await cwPort.setSignals({dataTerminalReady:false});
		toggleConnectButtons(true);
		cwPortOpen = true;
	}
}, false);
disconnect.addEventListener("click", async () => {
	if (cwPort != null && cwPortOpen) {
		await cwPort.setSignals({dataTerminalReady:false});
		await cwPort.close();
		toggleConnectButtons(false);
		cwPortOpen = false;
	}
}, false);

reset.addEventListener("click", async () => {
    if(confirm('Initialize all environments?')){
        window.localStorage.clear();
        window.location.reload();
    }else{
        return false;
    }
});

function toggleConnectButtons(connected) {
	connect.replaceChild(document.createTextNode(connected ? "CONNECTED!" : "CONNECT"), connect.firstChild);
	disconnect.replaceChild(document.createTextNode(connected ? "DISCONNECT" : "DISCONNECTED!"), disconnect.firstChild);
}

function renewMorse() {
    ac = (ac || new AudioContext());
    if (ac.state != "running") ac.resume();

    if (morse != null) morse._oscillator.stop(0);
    morse = new MorseNode(ac, parseInt(wpm.value));
    
    filter = ac.createBiquadFilter(); 
    filter.frequency.value = freq.value;
    filter.Q.value = 0;
    
    morse.connect(filter);
    filter.connect(ac.destination);
    
    morse._dot = 1.2 / parseFloat(wpm.value);
    morse._oscillator.frequency.value = parseInt(freq.value);
}
var stopped = true, paused = false;
var cm, doc, txtValue, cursorFrom = null, cursorTo, cursorTempFrom, cursorTempTo, cursorTempEnd, highlightStart, hightlightEnd, repeatId = -1, marker = null;
var DELAY_AMOUNT = 1; // seconds
stop.onclick = function() {
    try { clearTimeout(repeatId); repeatId = -1;}
    catch (e) {}
    document.getElementById('char_layer').style.display = 'none';
    renewMorse();
    if (noiseNode) noiseGain.disconnect();
    morse.playString(false, ac.currentTime, " ", vol, document.getElementById('selectkey').value, fading.checked);
    doc.readOnly = false;
    
    addDitdah(false, 1); // this also manage cw port
	
	clearMarker();
	cm.setOption("extraKeys", {});

    if (cursorFrom != null) {
        doc.setSelection(cursorFrom, cursorTo);
        cm.refresh();
    }
    stopped = true;

    play.replaceChild(document.createTextNode("PLAY"), play.firstChild);
    paused = false;
    timer_reset();
}

var bufferSource = noiseNode = noiseGain = null;
play.onclick = function() {
    var str =  doc.getValue();
    if(!str){
        alert("There are no characters to play.");
        return  false;
    }
    if(document.getElementById('layer_display').checked){
        document.getElementById('char_layer').style.display = 'block';
    }
    updateLayerPosition();

    if (paused) {
        timer_start();
        play.replaceChild(document.createTextNode("PAUSE"), play.firstChild);
        paused = false;
        ac.resume();
        return;
    } else if (stopped == false && repeatId == -1) {
        timer_stop();
        play.replaceChild(document.createTextNode("RESUME"), play.firstChild);
        paused = true;
        ac.suspend();
        return;
    } else {
        timer_start();
        play.replaceChild(document.createTextNode("PAUSE"), play.firstChild);
        paused = false;
    }

    try { clearTimeout(repeatId); repeatId = -1;}
    catch (e) {}

    renewMorse();
    
    if (noise.checked) {
        if (bufferSource == null) {
            bufferSource = ac.createBufferSource();
            noiseNode = ac.createWhiteNoise();
            bufferSource.connect(noiseNode);
            noiseGain = ac.createGain();
            noiseNode.connect(noiseGain);
            bufferSource.start(0);
        }
        noiseGain.gain.value = vol * 0.5;
        noiseGain.connect(ac.destination);
    }
    
    clearMarker();
    // cm.focus();
    if (cursorFrom != null && !stopped) {
        doc.setSelection(cursorFrom, cursorTo);
        cm.refresh();
        previousTime = 0;
    } else clearDitdah();
    
    cursorFrom = doc.getCursor("from");
    cursorTo = doc.getCursor("to");
    txtValue = doc.getSelection();
    
    var lastLine = doc.lastLine();
    var lastLineLength = doc.getLine(lastLine).length;
    
    if (selectionOnly.checked) {
        if (txtValue == '') { // when no selection  
            if (cursorTo.line == lastLine && cursorTo.ch == lastLineLength) { // when caret is at the end, start from first letter
                txtValue = doc.getValue();
                cursorTempFrom = {line: 0, ch: 0};
                cursorTempTo = {line: 0, ch: 0};
                cursorTempEnd = {line: lastLine, ch: lastLineLength};
            } else { // when caret is in the middle, start from caret position
                doc.setSelection(cursorFrom, {line: lastLine, ch: lastLineLength});
                txtValue = doc.getSelection();
                doc.setSelection(cursorFrom, cursorTo);
                cursorTempFrom = {line: cursorFrom.line, ch: cursorFrom.ch};
                cursorTempTo = {line: cursorFrom.line, ch: cursorFrom.ch};
                cursorTempEnd = {line: lastLine, ch: lastLineLength}
            }
        } else { // play selection
            cursorTempFrom = {line: cursorFrom.line, ch: cursorFrom.ch};
            cursorTempTo = {line: cursorFrom.line, ch: cursorFrom.ch};
            cursorTempEnd = {line: cursorTo.line, ch: cursorTo.ch};
        }
    } else {
        txtValue = doc.getValue();
        cursorTempFrom = {line: 0, ch: 0};
        cursorTempTo = {line: 0, ch: 0};
        cursorTempEnd = {line: lastLine, ch: lastLineLength};
    }
    highlightStart = highlightEnd = 0;

    morse.playString(false, ac.currentTime + DELAY_AMOUNT, txtValue, vol * (noise.checked ? 0.5 : 1), document.getElementById('selectkey').value, fading.checked);

    doc.readOnly = true;

    window.localStorage.setItem('user_txt', user_txt.CodeMirror.doc.getValue());
    
    stopped = false;
    
    // cm.focus();
    if (highlightSlowly.checked) doc.setSelection(cursorTempFrom, cursorTempFrom);
    if (hideText.checked) setMarker(cursorTempFrom, cursorTempEnd);
	cm.setOption("extraKeys", { Left: function() {rollback(true);}, Right: function() {rollback(false);} });
    // cm.focus();
    
	/*if (selectionOnly.checked == false) repeatId = setTimeout(highlight, DELAY_AMOUNT * 1000);
    else */highlight();

}

function delayedRepeat() {
    if (!stopped) play.click();
}
var previousTime = 0;
function highlight() {
    if (timestamp.length == 0) {
        if (!stopped) stop.click();
        if (repeat.checked) {
            stopped = false;
            repeatId = setTimeout(delayedRepeat, 2 * morse.getSpaceDelayInMills());
        }
        return;
    }
    
    if (previousTime != 0) addDitdah(morse._gain.gain.value > 0, parseInt((ac.currentTime - previousTime)*1000));
    previousTime = ac.currentTime;
    
    if (ac.currentTime > timestamp[0]) {
        timestamp.shift();
        
        highlightStart = highlightEnd;
        cursorTempFrom.line = cursorTempTo.line, cursorTempFrom.ch = cursorTempTo.ch;
        
        if (txtValue[highlightStart] == '<' && txtValue.length > highlightStart + 3 && !!morse.PROSIGN[txtValue.substring(highlightStart, highlightStart + 4).toUpperCase()]) {
            highlightEnd = highlightStart + 4;
            cursorTempTo.ch = cursorTempFrom.ch + 4;
        } else if (txtValue.length > highlightStart) {
            highlightEnd = highlightStart + 1;
            if (txtValue[highlightStart] == '\n') {
                cursorTempTo.line++;
                cursorTempTo.ch = 0;
            } else {
                cursorTempTo.ch = cursorTempFrom.ch + 1;
            }
        }

        if (!stopped && cursorTempTo.ch != 0) {
            cm.focus();
            doc.setSelection(cursorTempFrom, cursorTempTo);
            document.getElementById('textarea_select_char').innerHTML = doc.getSelection();
            if(!(document.getElementById('hide_text').checked==true)) document.getElementById('textarea_play_char').innerHTML = doc.getSelection();
            document.getElementById('textarea_select_count').innerHTML = highlightEnd.toLocaleString('en-US');
            var now_percent = parseInt(highlightEnd/txtValue.length*100);
            document.getElementById('textarea_select_percent').innerHTML = now_percent;
            setProgressBar(now_percent);
            if (hideText.checked) {
                setMarker(cursorTempTo, cursorTempEnd);
            }
            cm.refresh();
        }
    }
    if (!stopped) setTimeout(highlight, 7); // 7ms is based on the sampling rate
}
function setMarker(start, end) {
    clearMarker();
    marker = cm.markText(start, end, {className: "hide_markText"});
}
function clearMarker() {
    if (marker == null) return;
    
    marker.clear();
    marker = null;
}

function rollback(back) {
	if (stopped || morse == null) return;
	morse.timeMove(back ? -5 : 5);
}

var MP3_SAMPLE_RATE = 16000; //(isMobile ? 16000 : 44100);
var MP3_BIT_RATE = 32; //(isMobile ? 32 : 128);
var MP3_SAMPLE_BLOCK_SIZE = 1152;
make_mp3.onclick = function() {
    var str =  doc.getValue();
    if(!str){
        alert("There is nothing to convert.");
        return  false;
    }
    if(!confirm('Save as mp3 file?')==true) return false;
	stop.click();
	var mp3 = document.querySelector("#mp3");
	mp3.replaceChild(document.createTextNode("Generating.. Please wait a few minutes."), mp3.firstChild);
    mp3.style="display: inline-block;";
    setTimeout(makeMp3, 1);
};
async function makeMp3() {
	morse.playString(true, DELAY_AMOUNT, doc.getValue(), vol, document.getElementById('selectkey').value, fading.checked);
	var encoder = new Mp3LameEncoder(MP3_SAMPLE_RATE, MP3_BIT_RATE);
	var duration = makeBufferAndEncode(encoder, noise.checked, vol);
	saveRecording(encoder.finish(), duration);
}
function makeBufferAndEncode(encoder, withNoise, noiseVolume) {
	if (queue.length == 0) return;
	
	var queueLen = queue.length;
	var duration = Math.ceil(queue[queueLen - 1][0]);
	var sampleLen = parseInt((duration + DELAY_AMOUNT) * MP3_SAMPLE_RATE);
	//sampleLen = Math.ceil(sampleLen / MP3_SAMPLE_BLOCK_SIZE) * MP3_SAMPLE_BLOCK_SIZE;
	var buffer = new Float32Array(MP3_SAMPLE_BLOCK_SIZE);
	var angular_frequency = freq.value * 2 * Math.PI;
	var angular_frequency_factor = angular_frequency / MP3_SAMPLE_RATE;
	var rising_step = rising_start_volume = rising_end_volume = 0;
	var rising_steps = MP3_SAMPLE_RATE * smoothingDuration;
	
	var queueIndex = 0, sampleIndex = 0, volume = 0.0, nextVolume = 0.0;
	for ( ; queueIndex < queueLen; queueIndex++) {
		var item = queue[queueIndex];
		if (item[1] > 0) {
			sampleIndex = parseInt(item[0] * MP3_SAMPLE_RATE);
			nextVolume = item[1];
			break;
		}
	}
	for (var i = 0, j = 0; i < sampleLen; i++, j++) {
		if (j == MP3_SAMPLE_BLOCK_SIZE) {
			encoder.encode([buffer, buffer]);
			buffer.fill(0);
			j = 0;
		}
		
		if (i > sampleIndex) {
			if (queueIndex < queueLen - 1) queueIndex++;
			sampleIndex = parseInt(queue[queueIndex][0] * MP3_SAMPLE_RATE);
			if (volume != nextVolume) {
				rising_step = rising_steps;
				rising_start_volume = volume;
				rising_end_volume = nextVolume;
			}
			volume = nextVolume;
			nextVolume = queue[queueIndex][1];
		}
		
		if (rising_step-- > 0) {
			if (rising_start_volume > rising_end_volume) volume = rising_end_volume + (rising_start_volume - rising_end_volume) * rising_step / rising_steps;
			else volume = rising_start_volume + (rising_end_volume - rising_start_volume) * (rising_steps - rising_step) / rising_steps;
		}
		buffer[j] = Math.sin(i * angular_frequency_factor) * volume; // https://teropa.info/blog/2016/08/04/sine-waves.html
		if (withNoise) buffer[j] = buffer[j] * Math.cos(0.5*0.5*Math.PI) + ((Math.random() * 2) - 1) * noiseVolume * Math.cos(0.5*0.5*Math.PI); // half + half
	}
	encoder.encode([buffer, buffer]);
	
	return duration;
}
function saveRecording(blob, duration) {
	var url = URL.createObjectURL(blob);
	
	var sound = document.createElement("AUDIO");
	sound.controls = 'controls';
	sound.src = url;
	sound.type = 'audio/mpeg';
	
	var link = document.createElement("A");
	link.href = url;
	link.appendChild(document.createTextNode(" ğŸ’¾ MP3 "));

    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const hour = String(now.getHours()).padStart(2, '0');
    const minute = String(now.getMinutes()).padStart(2, '0');
    const time_str = year + month + day + hour + minute;
	filename = "Morse_" + time_str + "_" + freq.value + 'Hz_' + wpm.value + "wpm_" + parseInt(duration + 2) + "sec_" + MP3_SAMPLE_RATE.toLocaleString('en-US') + "rate_" + MP3_BIT_RATE + "kbps";
	link.download = filename + ".mp3";
	
	var div = document.createElement("DIV");
	div.appendChild(sound);
	div.appendChild(link);
	
	var mp3 = document.querySelector("#mp3");
	mp3.replaceChild(div, mp3.firstChild);
}

makeTze.onclick = function() {
    if(!confirm('Save as 1TZE file?')==true) return false;
	stop.click();
	morse.playString(true, DELAY_AMOUNT, doc.getValue(), 1.0, document.getElementById('selectkey').value, false);
	queue.push([queue[queue.length - 1][0] + 1, 0]);
	saveTzeFile();
}
function saveTzeFile() {
    var str =  doc.getValue();
    if(!str){
        alert("There is nothing to convert.");
        return  false;
    }
	var data = packTzeFile();
	var blob = new Blob([JSON.stringify(data)], {type:"application/json"});
	var url = URL.createObjectURL(blob);
	
	var link = document.createElement("A");
	link.href = url;
	link.appendChild(document.createTextNode(" ğŸ’¾ 1TZE "));
	var filename = (new Date()).toISOString().replace(/[\-\:T]/ig, '').substring(0, 14);
	link.download = filename + ".tze";
	
	var anchor = document.querySelector("#tze");
    link.id = anchor.id;
    anchor.parentNode.replaceChild(link, anchor);
}
function packTzeFile() {
	return {
		version: 1,
		creatdAt: (new Date()).toISOString(),
		wpm: parseInt(wpm.value),
		hangul: hasHangul,
		queue: queue.map(x => [x[0].toFixed(3),parseInt(x[1])])
	};
}

var ditdah = document.querySelector("#ditdah");
var last = false, lastWidth = 0;
function addDitdah(bar, len) {
    if (bar == last && ditdah.childNodes.length > 0 && lastWidth < 8192) {
        var span = ditdah.lastChild;
        lastWidth += len;
        span.style.width = (parseInt(lastWidth) >> 3) + "px";
        return;
    }
    var span = document.createElement("SPAN");
    span.className = bar ? "ditdah_bar" : "ditdah_gap";  
    span.style.width = parseInt(len >> 5) + "px";
    ditdah.appendChild(span);
    if (ditdah.childNodes.length > 256) ditdah.removeChild(ditdah.firstChild);
    last = bar;
    lastWidth = len;
	
	if (cwPortOpen) cwPort.setSignals({dataTerminalReady:bar});
    document.getElementById('cwport_signal').style.backgroundColor = bar ? 'red' : 'white';
    if(document.getElementById('sos_check').checked) document.getElementById('main_table').style.backgroundColor = bar ? 'red' : 'white';
}

function clearDitdah() {
    var len = ditdah.childNodes.length;
    for (var i = 0; i < len; i++) ditdah.removeChild(ditdah.firstChild);
    previousTime = 0;
}

var RANDOM_GEN_NUMBER = gen_number.value;

function add_spacer(){
    RANDOM_GEN_NUMBER = gen_number.value;
    let numSpaces = parseInt(document.getElementById('word_space').value);
    let spacer = " ".repeat(numSpaces);
    return spacer;
}

gen_hangul_option.addEventListener('change', function() {
    if (!stopped) stop.click();
    var RANDOM_GEN_NUMBER = gen_number.value;
    const selectedValue = this.value;
    gen_hangul_option.value = '';
    if(selectedValue=="hangul_qso_1"){
        textarea_change("hangul_qso_1");
    }else if(selectedValue=="hangul_qso_2"){
        textarea_change("hangul_qso_2");
    }else if(selectedValue=="hangul_qso_3"){
        textarea_change("hangul_qso_3");
    }else if(selectedValue=="hangul_qso_4"){
        textarea_change("hangul_qso_4");
    }else if(selectedValue=="english_qso_1"){
        textarea_change("english_qso_1");
    }else if(selectedValue=="english_qso_2"){
        textarea_change("english_qso_2");
    }
});


gen_random_option.addEventListener('change', function() {
    if (!stopped) stop.click();
    RANDOM_GEN_NUMBER = gen_number.value;
    const selectedValue = this.value;
    gen_random_option.value = '';
    count = gen_number.value;
    document.getElementById('user_txt_caption').innerHTML = '';

    function remove_add_vvv_ar(callsign_data) {
        return callsign_data.filter(item => {
        return !item.includes(add_vvv_text.value) && !item.includes(add_ar_text.value);
    });}

    if(selectedValue=="random_itu_callsigns"){
        var data = generateITUCallsigns(RANDOM_GEN_NUMBER, getRepeatCount()).join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_hl_callsigns"){
        var callsigns = generateHLCallsigns(RANDOM_GEN_NUMBER, 1);
        callsigns.sort(() => Math.random() - 0.5);
        var repeated = [], repeatCount = getRepeatCount();
        for (var callsign of callsigns)
            repeated.push(Array(repeatCount).fill(callsign).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_ja_callsigns"){
        var data = generateJACallsigns(RANDOM_GEN_NUMBER, getRepeatCount()).join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_babv_callsigns"){
        var data = generateBABVCallsigns(RANDOM_GEN_NUMBER, getRepeatCount()).join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_qcode"){
        var data = generateQCODE(RANDOM_GEN_NUMBER, getRepeatCount()).join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_hlja_callsigns"){
        var callsigns = generateHLCallsigns(RANDOM_GEN_NUMBER/2, 1);
        callsigns = callsigns.concat(generateJACallsigns(RANDOM_GEN_NUMBER/2, 1));
        callsigns = remove_add_vvv_ar(callsigns);
        callsigns.sort(() => Math.random() - 0.5);
        var repeated = [], repeatCount = getRepeatCount();
        for (var callsign of callsigns)
            repeated.push(Array(repeatCount).fill(callsign).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_hlbabv_callsigns"){
        var callsigns = generateHLCallsigns(RANDOM_GEN_NUMBER/2, 1);
        callsigns = callsigns.concat(generateBABVCallsigns(RANDOM_GEN_NUMBER/2, 1));
        callsigns = remove_add_vvv_ar(callsigns);
        callsigns.sort(() => Math.random() - 0.5);
        var repeated = [], repeatCount = getRepeatCount();
        for (var callsign of callsigns)
            repeated.push(Array(repeatCount).fill(callsign).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_jababv_callsigns"){
        var callsigns = generateBABVCallsigns(RANDOM_GEN_NUMBER/2, 1);
        callsigns = callsigns.concat(generateJACallsigns(RANDOM_GEN_NUMBER/2, 1));
        callsigns = remove_add_vvv_ar(callsigns);
        callsigns.sort(() => Math.random() - 0.5);
        var repeated = [], repeatCount = getRepeatCount();
        for (var callsign of callsigns)
            repeated.push(Array(repeatCount).fill(callsign).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_hljababv_callsigns"){
        var callsigns = generateHLCallsigns(RANDOM_GEN_NUMBER/3, 1);
        callsigns = callsigns.concat(generateJACallsigns(RANDOM_GEN_NUMBER/3, 1));
        callsigns = callsigns.concat(generateBABVCallsigns(RANDOM_GEN_NUMBER/3, 1));
        callsigns = remove_add_vvv_ar(callsigns);
        callsigns.sort(() => Math.random() - 0.5);
        var repeated = [], repeatCount = getRepeatCount();
        for (var callsign of callsigns)
            repeated.push(Array(repeatCount).fill(callsign).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_qso_elements"){
        var QSO_ELEMENTS = ["DE", "GM", "GA", "GE", "DR", "OM", "TNX", "TKS", "FER", "CALL", "<BT>","ES", "UR", "RST", "RPRT", "RPT", "IS", "599", "5NN", "579", "57N", "559", "55N","HR", "OP", "NAME", "QTH", "KDN", "HW", "HW?", "CPI", "CPY","QSO", "CU", "AGN", "CUAGN", "HOPE", "HPE", "QSL", "VIA", "BURO","DX", "GL", "GB", "GUD", "73", "88", "PSE", "CQ", "QRL", "QRZ","CFM", "SRI", "TU", "VY", "QRS", "QRP", "QRM", "QSB", "TEST","OK", "FB", "BK", "<BK>", "RR", "ALL", "RIG", "PWR", "ANT", "WX", "TEMP","K", "<KN>", "<AR>", "<VA>", "<AS>", "?"];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(QSO_ELEMENTS)
        QSO_ELEMENTS = array_lenth_up(QSO_ELEMENTS,count);
        for (var qso_element of QSO_ELEMENTS)
            repeated.push(Array(repeatCount).fill(qso_element).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_qso_basic_elements"){
        QSO_BASIC_ELEMENTS = ["CQ", "DE", "PSE", "K", "<AR>","GM", "GA", "GE", "DR", "OM","TNX", "FER", "CALL", "<BT>","ES", "UR", "RST", "IS", "599", "5NN","HR", "OP", "NAME","HW?","HPE", "CUAGN", "GL", "GB", "73", "TU","RR", "OK", "FB", "<BK>","<KN>", "<VA>"];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(QSO_BASIC_ELEMENTS)
        QSO_BASIC_ELEMENTS = array_lenth_up(QSO_BASIC_ELEMENTS,count);
        for (var qso_basic_element of QSO_BASIC_ELEMENTS)
            repeated.push(Array(repeatCount).fill(qso_basic_element).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_stamp_qso"){
        GREETINGS = ["GM DR OM","GA DR OM","GE DR OM"];
        THANKS = ["TNX FER CALL","TKS FER CALL","TNX FER RPRT","TNX FER FB RPRT","TKS FER RPRT",];
        RSTS = ["UR RST 599 5NN","UR 599 5NN","UR RST IS 599 5NN",];
        NAMES = ["HR OP IS KIM KIM","HR OP CHOI CHOI","OP HR IS KIM KIM","OP OP CHOI CHOI","OP IS KIM KIM","MY NAME IS PARK PARK", "NAME IS KIM KIM","NAME NAME PARK PARK"];
        FINALS = ["CUAGN 73 TU EE","HPE CUAGN 73 <VA>","73 TU <VA> EE","HW? <BK>","HW CPI? <BK>","OK? <BK>","<BK>","73 TU TU <VA> EE"];
        var qsos = [];
        for (var n = 0; n < 10; n++) {
            var greeting = GREETINGS[Math.floor(Math.random() * GREETINGS.length)];
            var thank = THANKS[Math.floor(Math.random() * THANKS.length)];
            var rst = RSTS[Math.floor(Math.random() * RSTS.length)];
            var name = NAMES[Math.floor(Math.random() * NAMES.length)];
            var final = FINALS[Math.floor(Math.random() * FINALS.length)];

            var qso = (Math.random() > 0.5 ? "  " : "  ") + greeting;
            qso += (Math.random() > 0.5 ? (Math.random() > 0.5 ? " " : " <BT> ") + thank : "");
            qso += (Math.random() > 0.5 ? " ES " : " <BT> ") + rst;
            qso += (name.startsWith("NAME") ? " <BT> " : (Math.random() > 0.5 ? " ES " : " <BT> ")) + name;
            qso += (final.startsWith("<BK>") ? " " : " <BT> ") + final;
            qsos.push(qso);
        }
        var data = qsos.join("   \n");
        changeQsoSample(data);
    }else if(selectedValue=="random_hl_words"){
        QSO_WORDS = [
            "ì•ˆë…•","ì‹ í˜¸","ì˜¤ì— ","ë§ì”€","ìˆ˜ì‹ ","ì˜¤ëŠ˜","êµì‹ ","í•œê¸€","ì „ì‹ ","ì—¬ê¸°","ì´ê³³","ìš´ì˜","ë‹¤ìŒ","ì£¼ë§","ì €ë…","ì¢…ë£Œ","ì´ë§Œ","ê°€ê²Œ","ê°€ê²©","ê°€êµ¬","ê°€ë°©","ê°€ìˆ˜","ê°€ìŠ´","ê°€ìš”","ê°€ìœ„","ê°€ì„","ê°€ì¡±","ê°„ì‹","ê°„ì¥","ê°ˆë¹„","ê°ˆìƒ‰","ê°ê¸°","ê°ë™","ê°ì","ê°œì¸","ê±°ê¸°","ê±°ë¦¬","ê±°ì‹¤","ê±°ìš¸","ê±´ë¬¼","ê²Œì„","ê²¨ìš¸","ê²°ê³¼","ê²½ê¸°","ê²½ì£¼","ê²½ì°°","ê²½ì¹˜","ê²½í—˜","ê³„ë‹¨","ê³„ë€","ê³„ì ˆ","ê³„íš","ê³ ê¸°","ê³ ëª¨","ê³ ì¥","ê³ ì¶”","ê³ í–¥","ê³¨ëª©","ê³¨í”„","ê³µê°„","ê³µê¸°","ê³µì—°","ê³µì›","ê³µì§œ","ê³µì±…","ê³µí•­","ê³¼ê±°","ê³¼ì¼","ê³¼ì","ê³¼í•™","ê´€ê³„","ê´€ì‹¬","ê´‘ê³ ","êµìˆ˜","êµì‹¤","êµí†µ","êµíšŒ","êµ¬ë‘","êµ¬ë¦„","êµ¬ì›”","êµ­ë‚´","êµ­ë¦½","êµ­ìˆ˜","êµ­ì–´","êµ­ì ","êµ­ì œ","êµ°ì¸","ê·œì¹™","ê·¸ê±°","ê·¸ê²ƒ","ê·¸ê³³","ê·¸ë‚ ","ê·¸ë•Œ","ê·¸ë¨","ê·¸ë¦‡","ê·¸ë¦¼","ê·¸ë¶„","ê·¸ìª½","ê·¹ì¥","ê·¼ì²˜","ê¸ˆì—°","ê¸°ê°„","ê¸°ë¦„","ê¸°ë¶„","ê¸°ì‚¬","ê¸°ì‚¬","ê¸°ì˜¨","ê¸°ì","ê¸°ì°¨","ê¸°ì¹¨","ê¸°íƒ€","ê¹€ë°¥","ê¹€ì¹˜","ê½ƒì§‘","ë‚˜ë¼","ë‚˜ë¬´","ë‚˜ì´","ë‚˜ì¤‘","ë‚˜í˜","ë‚šì‹œ","ë‚ ì”¨","ë‚ ì§œ","ë‚¨ë…€","ë‚¨ë¯¸","ë‚¨ì‚°","ë‚¨ì","ë‚¨ìª½","ë‚¨í¸","ë‚´ê³¼","ë‚´ë…„","ë‚´ìš©","ë‚´ì¼","ëƒ„ë¹„","ëƒ„ìƒˆ","ëƒ‰ë©´","ë…¸ë˜","ë…¸íŠ¸","ë…¹ìƒ‰","ë…¹ì°¨","ë†êµ¬","ëˆ„êµ¬","ëˆ„ë‚˜","ëˆˆë¬¼","ë‰´ìŠ¤","ë‰´ìš•","ëŠë‚Œ","ëŠ¥ë ¥","ë‹¤ë¦¬","ë‹¤ë¦¬","ë‹¤ìŒ","ë‹¨ì–´","ë‹¨ì ","ë‹¬ëŸ¬","ë‹¬ë ¥","ë‹´ë°°","ë‹µì¥","ë‹¹ê·¼","ë‹¹ì‹ ","ëŒ€í•™","ëŒ€í™”","ëŒ€íšŒ","ë•ë¶„","ë„ë¡œ","ë„ì‹œ","ë„ì›€","ë„ì¿„","ë…ì„œ","ë…ì¼","ë™ë„¤","ë™ë¬¼","ë™ìƒ","ë™ì•ˆ","ë™ì–‘","ë™ì „","ë™ìª½","ë¼ì§€","ëœì¥","ë‘ë¶€","ë“£ê¸°","ë“±ì‚°","ë”¸ê¸°","ë–¡êµ­","ë¼ë©´","ë¡œì…˜","ë§ˆëŠ˜","ë§ˆìŒ","ë§Œë‘","ë§Œí™”","ë§¤ì¼","ë§¤ì£¼","ë§¥ì£¼","ë¨¸ë¦¬","ë¨¸ë¦¬","ë©”ë‰´","ë©”ëª¨","ë©°ì¹ ","ë©´ë„","ëª…ì ˆ","ëª¨ì–‘","ëª¨ì„","ëª¨ì","ëª©ì ","ëª¸ì‚´","ëª½ê³¨","ë¬´ë£Œ","ë¬´ë¦","ë¬´ì—‡","ë¬´ì—­","ë¬´ìš©","ë¬¸ì¥","ë¬¸ì œ","ë¬¸í™”","ë¬¼ê±´","ë¯¸êµ­","ë¯¸ë˜","ë¯¸ìˆ ","ë°”ë‹¤","ë°”ëŒ","ë°”ì§€","ë°•ìˆ˜","ë°˜ì§€","ë°˜ì°¬","ë°œìŒ","ë°œí‘œ","ë°©ë²•","ë°©ì†¡","ë°©í•™","ë°°êµ¬","ë°°ë‹¬","ë°°ìš°","ë°°íƒˆ","ë²„ìŠ¤","ë²ˆí˜¸","ë²šê½ƒ","ë³‘ì›","ë³¼íœ","ë´‰ì§€","ë´‰íˆ¬","ë¶€ëª¨","ë¶€ë¶€","ë¶€ì‚°","ë¶€ì—Œ","ë¶€ì¸","ë¶€íƒ","ë¶ìª½","ë¹„ëˆ„","ë¹„ë°€","ë¹Œë”©","ë¹¨ë˜","ë¹µì§‘","ì‚¬ê³ ","ì‚¬ê³¼","ì‚¬ëŒ","ì‚¬ë¬¼","ì‚¬ì›","ì‚¬ì›”","ì‚¬ì´","ì‚¬ì¥","ì‚¬ì „","ì‚¬ì§„","ì‚¬ì´Œ","ì‚¬íƒ•","ì‚¬í˜","ì‚°ì±…","ì‚¼ì›”","ì‚¼ì´Œ","ìƒì","ìƒì²˜","ìƒí’ˆ","ìƒˆë²½","ìƒˆìš°","ìƒ‰ê¹”","ìƒì„ ","ìƒì‹ ","ìƒì¼","ìƒí™œ","ìƒ´í‘¸","ì„œë¥˜","ì„œì–‘","ì„œìš¸","ì„œì ","ì„œìª½","ì„ ë°°","ì„ ìˆ˜","ì„¤ë‚ ","ì„¤íƒ•","ì„±ê²©","ì„±í•¨","ì„¸ê³„","ì„¼í„°","ì†Œë¦¬","ì†Œì„¤","ì†Œì‹","ì†ŒíŒŒ","ì†Œí¬","ì†Œí’","ì†ë‹˜","ì†¡ì´","ìˆ˜ê±´","ìˆ˜ë„","ìˆ˜ë°•","ìˆ˜ì—…","ìˆ˜ì˜","ìˆ˜ì €","ìˆ˜ì²©","ìˆ˜í•™","ìˆ™ì œ","ìˆœì„œ","ìŠ¤í‚¤","ìŠµê´€","ì‹œê°„","ì‹œê³„","ì‹œê³¨","ì‹œë‚´","ì‹œë””","ì‹œë¯¼","ì‹œì„¤","ì‹œì™¸","ì‹œì›”","ì‹œì‘","ì‹œì¥","ì‹œì²­","ì‹œí—˜","ì‹ë‹¹","ì‹ì‚¬","ì‹íƒ","ì‹ ë¬¸","ì‹ ë°œ","ì‹¤ìˆ˜","ì“°ê¸°","ì•„ê¸°","ì•„ë‚´","ì•„ë“¤","ì•„ë˜","ì•„ë¹ ","ì•„ì´","ì•„ì¹¨","ì•„ì¹¨","ì•…ê¸°","ì•ˆê²½","ì•¼êµ¬","ì•¼ì±„","ì•½êµ­","ì•½ì‚¬","ì•½ì†","ì–‘ë§","ì–‘ë³µ","ì–‘ì‹","ì–‘íŒŒ","ì–´ê¹¨","ì–´ë””","ì–´ë¥¸","ì–¸ë‹ˆ","ì–¼êµ´","ì–¼ë§ˆ","ì–¼ìŒ","ì—„ë§ˆ","ì—¬ê¶Œ","ì—¬ê¸°","ì—¬ë¦„","ì—¬ì","ì—¬í–‰","ì—­ì‚¬","ì—°ì„¸","ì—°í•„","ì—°íœ´","ì—´ì‡ ","ì—´ì°¨","ì—½ì„œ","ì˜êµ­","ì˜ìƒ","ì˜ì–´","ì˜í•˜","ì˜í™”","ì˜ˆì•½","ì˜›ë‚ ","ì˜¤ë¦¬","ì˜¤ë¹ ","ì˜¤ì›”","ì˜¤ì´","ì˜¤ì „","ì˜¤í›„","ì˜¬í•´","ì˜·ì¥","ì™¸êµ­","ì™¼ìª½","ìš”ê¸ˆ","ìš”ë¦¬","ìš”ì¼","ìš”ì¦˜","ìš°ë¦¬","ìš°ì‚°","ìš°ìœ ","ìš°í‘œ","ì›”ê¸‰","ì›”ì„¸","ì›¬ì¼","ìœ„ì¹˜","ìœ ëŸ½","ìœ ë¦¬","ìœ ì›”","ìœ í•™","ìœ í–‰","ì€í–‰","ìŒì‹","ìŒì•…","ì˜ë¯¸","ì˜ì‚¬","ì˜ì","ì´ê±°","ì´ê²ƒ","ì´ê³³","ì´ë¦„","ì´ëª¨","ì´ë²ˆ","ì´ë¶„","ì´ì‚¬","ì´ì›”","ì´ìœ ","ì´ìª½","ì´í‹€","ì¸êµ¬","ì¸ê¸°","ì¸ë„","ì¸ì‚¼","ì¸ìƒ","ì¸ì²œ","ì¸í˜•","ì¼ê¸°","ì¼ë³¸","ì¼ì‹","ì¼ì›”","ì½ê¸°","ì…êµ¬","ì…í•™","ìê¸°","ìë£Œ","ìë¦¬","ìì‹ ","ìì—°","ììœ ","ì‘ë…„","ì”ì¹˜","ì¡ì§€","ì¥ê°‘","ì¥ë§ˆ","ì¥ë¯¸","ì¥ì†Œ","ì¥ì ","ì¬ë£Œ","ì¬í‚·","ì €ê±°","ì €ê²ƒ","ì €ê³³","ì €ê¸°","ì €ë…","ì €ë…","ì €ë¶„","ì €ìª½","ì €í¬","ì „ê³µ","ì „í™”","ì ìˆ˜","ì ì‹¬","ì ì‹¬","ì ì›","ì í¼","ì •ë„","ì •ë¬¸","ì •ë³´","ì œëª©","ì œì¼","ì¡°ì¹´","ì¢…ë¡œ","ì¢…ë¥˜","ì¢…ì´","ì¢…ì¼","ì£¼ë§","ì£¼ë³€","ì£¼ë¶€","ì£¼ì‚¬","ì£¼ì†Œ","ì£¼ìŠ¤","ì£¼ìœ„","ì£¼ì¸","ì¤‘êµ­","ì¤‘ì‹","ì¤‘ì‹¬","ì¦ì„¸","ì§€ê°‘","ì§€ë„","ì§€ë°©","ì§€í•˜","ì§ì—…","ì§ì›","ì§ì¥","ì°Œê°œ","ì°½ë¬¸","ì±„ì†Œ","ì±…ìƒ","ì±…ì¥","ì²˜ìŒ","ìµœê³ ","ì¶”ì„","ì¶”ì–µ","ì¶•êµ¬","ì¶•ì œ","ì¶œêµ¬","ì¶œì¥","ì·¨ë¯¸","ì¹˜ê³¼","ì¹˜ë§ˆ","ì¹˜ì•½","ì¹œêµ¬","ì¹œì²™","ì¹ ì›”","ì¹ íŒ","ì¹¨ëŒ€","ì¹«ì†”","ì¹´ë“œ","ì¹´ë ˆ","ì¹´í˜","ì»¤í”¼","ì½”íŠ¸","ì½”í”¼","ì½œë¼","ì½§ë¬¼","í¬ê¸°","íƒêµ¬","íƒœêµ­","íƒœí’","íƒì‹œ","í†µì¥","íŠ¹ì§•","íŒŒí‹°","íŒ”ì›”","íŒ¨ì…˜","í¸ì§€","í‰ì¼","í¬ë„","í¬ì¥","í‘œí˜„","í”¼ì","í•„ë¦„","í•„í†µ","í•˜ëŠ˜","í•˜ë£¨","í•˜ìˆ™","í•™êµ","í•™ê¸°","í•™ë…„","í•™ìƒ","í•™ì›","í•œê°•","í•œêµ­","í•œê¸€","í•œë²ˆ","í•œë³µ","í•œì‹","í•œì","í• ì¸","í•©ê²©","í•´ì™¸","í–‡ë¹›","í–‰ë³µ","í–‰ì‚¬","í—ˆë¦¬","í˜„ê¸ˆ","í˜„ì¬","í˜•ì œ","í˜¸ì£¼","í˜¸í…”","í˜¼ì","í™ì°¨","í™”ê°€","í™˜ì","íšŒì‚¬","íšŒìƒ‰","íšŒì˜","í›„ë°°","íœ´ê°€","íœ´ì¼","íœ´ì§€","í°ìƒ‰"
            ];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(QSO_WORDS)
        QSO_WORDS = array_lenth_up(QSO_WORDS,count);
        for (var qso_word of QSO_WORDS)
            repeated.push(Array(repeatCount).fill(qso_word).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_hl_phrases"){
        var QSO_PHRASES = [
            "ì•ˆë…•í•˜ì„¸ìš”?",
            "ë°˜ê°‘ìŠµë‹ˆë‹¤.",
            "ì˜ˆ,",
            "ì˜¤ì— ë‹˜",
            "ë§ì”€ ì˜ ìˆ˜ì‹ í–ˆìŠµë‹ˆë‹¤.",
            "ì‹ í˜¸ëŠ” 599 5NN ì…ë‹ˆë‹¤.",
            "ì˜¤ëŠ˜ êµì‹  ê³ ë§™ìŠµë‹ˆë‹¤.",
            "ì˜ ì§€ë‚´ì…¨ë‚˜ìš”?",
            "ê·¸ë™ì•ˆ ì˜ ì§€ë‚´ì…¨ëŠ”ì§€ìš”?",
            "ì €ëŠ” ìš©ì¸, ìš©ì¸ ì— ì‚¬ëŠ” ê¹€ëŒ€ì„±, ê¹€ëŒ€ì„± ì…ë‹ˆë‹¤.",
            "ì—¬ê¸°ëŠ” ê³ ì–‘, ê³ ì–‘ ì´ê³  ìš´ì˜ìëŠ” ìµœì˜ì¼, ìµœì˜ì¼ ì…ë‹ˆë‹¤.",
            "ì´ê³³ì€ ì„±ë‚¨, ì„±ë‚¨ ì´ê³  ì €ëŠ” ìµœë³‘íƒœ, ìµœë³‘íƒœ ì…ë‹ˆë‹¤.",
            "ì´ë¦„ì€ ë°°íƒœì›, ë°°íƒœì› ì´ê³  ê²½ê¸°ê´‘ì£¼, ê²½ê¸°ê´‘ì£¼ ì—ì„œ ì‹ í˜¸ ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤.",
            "ì•ˆë…•íˆê³„ì„¸ìš”.",
            "ë‹¤ìŒì— ë˜ ëµ™ê² ìŠµë‹ˆë‹¤.",
            "í•œê¸€ ì „ì‹  êµì‹  ëŒ€ë‹¨íˆ ê°ì‚¬í•©ë‹ˆë‹¤.",
            "í‰ì•ˆí•œ ì €ë… ë˜ì„¸ìš”.",
            "ì˜¤ëœë§Œì— ëµ™ìŠµë‹ˆë‹¤.",
            "ì‹ í˜¸ ë°›ì•„ì£¼ì…”ì„œ ê³ ë§™ìŠµë‹ˆë‹¤."
        ];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(QSO_PHRASES)
        QSO_PHRASES = array_lenth_up(QSO_PHRASES,count);
        for (var qso_phrase of QSO_PHRASES)
            repeated.push(Array(repeatCount).fill(qso_phrase).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_qso2_elements"){
        var QSO_ELEMENTS = ["ì•ˆë…•","ê°ì‚¬","ì‚¬ëŒ","ì¢‹ì•„ìš”","ë­í•´ìš”","ì˜¤ëŠ˜","ë‚´ì¼","ì–´ì œ","ì–´ë””","ì–´ë–»ê²Œ","ì¢€","ë°”ì˜ì„¸ìš”","ê´œì°®ì•„ìš”","ë¯¸ì•ˆí•´ìš”","ê¸°ë¶„","ì™¸êµ­","ë¬¸ì œ","ê³¼ì œ","ì‹œí—˜","ì²­ì†Œ","ìš”ë¦¬","ë§›ìˆì–´ìš”","ì¬ë¯¸ìˆì–´ìš”","ì¢‹ì•„í•˜ë‹¤","ì‹«ì–´í•˜ë‹¤","ë¨¹ì–´ìš”","ë§ˆì…”ìš”","ììš”","ê°€ìš”","ì™€ìš”","ë“¤ì–´ìš”","ë§ì•„ìš”","ì ì–´ìš”","ì£„ì†¡í•´ìš”","ê³ ë§™ë‹¤","ì˜¤ëŠ˜ì€","ë‚´ì¼ì€","ì–´ì œëŠ”","ì•„ì¹¨ì—","ì ì‹¬ì—","ì €ë…ì—","ì˜¤ëŠ˜ë„","ë‚´ì¼ë„","ì–´ì œë„","ì£¼ë§ì—","ë°©í•™ì—","ê²¨ìš¸ì—","ë´„ì—","ì—¬ë¦„ì—","ê°€ì„ì—","ë¹„ê°€","ëˆˆì´","ì¶”ì›Œì„œ","ë”ì›Œì„œ","ì¶¥ì€","ë”ìš´","ë§‘ì€","íë¦°","ë°”ëŒì´","ë¹„ë°”ëŒì´","êµ¬ë¦„ì´","ê½ƒì´","ë‚˜ë¬´ê°€","ë¬¼ì´","ë°”ë‹¤ê°€","ì‚°ì´","ê³„ê³¡ì´","ì—°ëª»ì´","ë†’ì€","ë‚®ì€","ë©€ì€","ê°€ê¹Œìš´","ë¹ ë¥¸","ëŠë¦°","ë°”ìœ","ì—¬ìœ ë¡œìš´","ì¡°ìš©í•œ","ì‹œë„ëŸ¬ìš´","ì‹«ì€","ì˜ˆìœ","ë©‹ìˆëŠ”","ì§€ë£¨í•œ","ì‰¬ëŠ”","ì°¨ê°€ìš´","ë”ìš´","ë¹¨ë¦¬","ëŠë¦¬ê²Œ","ë°”ì˜ê²Œ","ì˜ˆë»ìš”","ì˜ˆìœ","ì–´ë–¤","ë§ì€","ë‹¤ë¥¸","ìƒˆë¡œìš´","ì˜ˆì „","ë‹¤ìŒ","ì´ì „","ì•ìœ¼ë¡œ","ë’¤ë¡œ","ì¢‹ì€","ì¢‹ì•„","ë¶ˆê³ ê¸°","ëœì¥","ê³„ë€","ì¹´ë ˆ","ë§Œë‘","íŒŒìŠ¤íƒ€","ìƒëŸ¬ë“œ","ê¹€ì¹˜","ëœì¥ì°Œê°œ","ìˆœë‘ë¶€","ê°ˆë¹„ì°œ","ë¶ˆë‹­ë³¶ìŒë©´","ë¼ë©´","ë°”ê²ŒíŠ¸","ë¹µ","ì¹˜í‚¨","í”¼ì","ê¹€ë°¥","ë–¡ë³¶ì´","ê¹€ì¹˜ì°Œê°œ","í–„ë²„ê±°","ìŠ¤í…Œì´í¬","íšŒ","ì´ˆë°¥","ëƒ‰ë©´","ê³±ì°½","ê°ˆë§¤ê¸°ì‚´","ìˆœëŒ€","ë¶€ëŒ€ì°Œê°œ","ì‚¼ê²¹ì‚´","ëˆê¹ŒìŠ¤","íƒ•ìˆ˜ìœ¡","ì§œì¥ë©´","íƒ„íƒ•ë©˜","ê³°íƒ•","ë¶„ì‹","ì£½","ë–¡êµ­","í•´ë¬¼ì°œ","í•´ë¬¼íƒ•","ëœì¥êµ­","ê¹€ì¹˜ì „","ê°ìì „","íŒŒì „","ë¯¸ì—­êµ­","ë§¤ìš´íƒ•","ë¼ì§€ê³ ê¸°","ì†Œê³ ê¸°","ì˜¤ì§•ì–´","ì­ˆê¾¸ë¯¸","ê²Œ","ì—°ì–´","ì°¸ì¹˜","ê³ ë“±ì–´","ì‡ ê³ ê¸°","ê³„ë€ë§ì´","ìŒ€êµ­ìˆ˜","ì†ŒìŠ¤","ì–‘íŒŒ","ìƒì¶”","ì˜¤ì´","í”¼ë§","í† ë§ˆí† ","ë²„ì„¯","ì–‘ë°°ì¶”","ë¸Œë¡œì½œë¦¬","ë‹¹ê·¼","íŒŒ","ë§ˆëŠ˜","ìƒê°•","ì–‘ë…","í›„ì¶”","ì†Œê¸ˆ","ì„¤íƒ•","ì¹´ë ˆ","ì»¤í”¼","ì£¼ìŠ¤","ì°¨","ë¬¼","ìš°ìœ ","ì‹œê¸ˆì¹˜","ì• í˜¸ë°•","í˜¸ë°•","ë‘ë¶€","ì½©","ì½©ë‚˜ë¬¼","ì½©ë¬¼","ì—°ë‘ë¶€","ì†Œê³ ê¸°","ìƒì„ ","ê²Œì‚´","ì°¸ì¹˜ìº”","í™ê³ ì¶”","ì²­ê³ ì¶”","ê°€ì§€","ë¬´","ë°±í•©","ë²„í„°","ê³„ë€","ë¹µ","ë¼ë©´","ê°ì","ë‹¹ê·¼","í¬ë„","ê±´í¬ë„","ë”¸ê¸°","ì˜¤ë Œì§€","ê°","í† ë§ˆí† ","í˜¸ë°•","ì°¸ì™¸","ë°°","ìŒ€","ë³´ë¦¬","ë°°ì¶”","ì²­ê²½ì±„","ë¶€ì¶”","ì½©ë‚˜ë¬¼","ë¯¸ë‚˜ë¦¬","ìª½íŒŒ","ë•…ì½©","ì¡°ê°œ","ê°€ë¦¬ë¹„","ìƒˆìš°","ì†Œë¼","ì¡°ê°œ","ì „ë³µ","í™í•©","ì˜¤ì§•ì–´","ë¬¸ì–´","ê±°ë¶ì´","ê°€ì¬","ê²Œ","ê½ƒê²Œ","ëª…ë€","ì¹´ìš°í”„","ëª¨ì‹œì¡°ê°œ","ìƒì„ ","ê±´ì–´ë¬¼","ê±´ì–´ë¬¼ì°œ","ì°¸ì¹˜ìº”","ì‹±ì‹±í•œ","ì‹ ì„ í•œ","ë°”ë‹¤","ë“¤ê½ƒ","ë…¸ì„","ë¬¼ì†Œë¦¬","íŒŒë„","ê°•ì•„ì§€","ê³ ì–‘ì´","ìƒˆë¼","ë¶€ëª¨ë‹˜","í• ë¨¸ë‹ˆ","í• ì•„ë²„ì§€","ì¹œêµ¬","ì¹œì²™","í˜•ì œ","ìë§¤","ê°€ì¡±","ì†Œì¤‘í•œ","í–‰ë³µí•œ","ì›ƒìŒ","ëˆˆë¬¼","ê¸°ì¨","ìŠ¬í””","ì„¤ë ˜","ë‘ê·¼ê±°ë¦¼","ë§ˆìŒ","ê°ë™","ì‚¬ë‘","ì‚¬ë‘í•´ìš”","ì‚¬ë‘í•œë‹¤","í—¤ì–´ì§","ì´ë³„","ë³´ê³ ì‹¶ì–´ìš”","ê·¸ë¦¬ì›Œìš”","ë¯¸ì›Œìš”","ë¯¸ì›Œí•œë‹¤","ëˆ„ë‚˜","ì˜¤ë¹ ","ì•„ë¹ ","ì—„ë§ˆ","ì•„ë“¤","ë”¸","ë¶€ëª¨ë‹˜","í• ë¨¸ë‹ˆ","í• ì•„ë²„ì§€","ì •ì„±","ì§„ì‹¬","ì§„ì‹¬ìœ¼ë¡œ","ë¯¿ìŒ","ì‹ ë¢°","ë¯¿ë‹¤","ì‹ ë¢°í•˜ë‹¤","ì†Œì¤‘í•œ","ê°ì‚¬í•¨","ê°ì‚¬í•˜ë‹¤","ê¸°ë„","ê¸°ë„í•˜ë‹¤","ì˜ì§€","ì˜ì§€í•˜ë‹¤","ìš©ê¸°","ìš©ê¸°ë¥¼ë‚´ë‹¤","ì¸ë‚´","ì¸ë‚´ì‹¬","ì°¸ìŒ","ì°¸ì•„ë‚´ë‹¤","í¬ë§","í¬ë§í•˜ë‹¤","ë¯¸ë˜","ê¿ˆ","ê¿ˆê¾¸ë‹¤","ëª©í‘œ","ëª©í‘œë¥¼ê°€ì§€ë‹¤","ì„±ì·¨","ì„±ì·¨í•˜ë‹¤","ì„±ê³µ","ì„±ê³µí•˜ë‹¤","ì‹¤íŒ¨","ì‹¤íŒ¨í•˜ë‹¤","ìì‹ ê°","ìì‹ ê°ì„ê°–ë‹¤","ìë‘","ìë‘ìŠ¤ëŸ½ë‹¤","ê²¸ì†","ê²¸ì†í•˜ë‹¤","ì¡´ê²½","ì¡´ê²½í•˜ë‹¤","ì¡´ì¤‘","ì¡´ì¤‘í•˜ë‹¤","ì´í•´","ì´í•´í•˜ë‹¤","ì´ì•¼ê¸°","ì´ì•¼ê¸°í•˜ë‹¤","ëŒ€í™”","ëŒ€í™”í•˜ë‹¤","ê³ ë¯¼","ê³ ë¯¼í•˜ë‹¤","ë…¸ë ¥","ë…¸ë ¥í•˜ë‹¤","ì‘ì›","ì‘ì›í•˜ë‹¤","ê²©ë ¤","ê²©ë ¤í•˜ë‹¤","ì¡°ì–¸","ì¡°ì–¸í•˜ë‹¤","ì½”ì¹­","ì½”ì¹­í•˜ë‹¤","ì¸ì •","ì¸ì •í•˜ë‹¤","í—ˆë½","í—ˆë½í•˜ë‹¤","ê¶Œìœ ","ê¶Œìœ í•˜ë‹¤","ì œì•ˆ","ì œì•ˆí•˜ë‹¤","í˜‘ì˜","í˜‘ì˜í•˜ë‹¤","í•©ì˜","í•©ì˜í•˜ë‹¤","ê²°ì •","ê²°ì •í•˜ë‹¤","ì•½ì†","ì•½ì†í•˜ë‹¤","ë¯¸ë¦¬","ë¯¸ë¦¬ì•½ì†í•˜ë‹¤","í™•ì •","í™•ì •í•˜ë‹¤","ì˜ˆì •","ì˜ˆì •ë˜ë‹¤","ë°©ë²•","ë°©ë²•ì„ëª¨ìƒ‰í•˜ë‹¤","ì‹œë„","ì‹œë„í•˜ë‹¤","í–‰ë™","í–‰ë™í•˜ë‹¤","ì‹¤í—˜","ì‹¤í—˜í•˜ë‹¤","ê²½í—˜","ê²½í—˜í•˜ë‹¤","ë°°ì›€","ë°°ìš°ë‹¤","êµí›ˆ","êµí›ˆì„ì–»ë‹¤","ì„±ìˆ™","ì„±ìˆ™í•˜ë‹¤","ì„±ì¥","ì„±ì¥í•˜ë‹¤","ë³€í™”","ë³€í™”í•˜ë‹¤","ì‚¶","ì‚¶ì„ì‚¬ëŠ”ë°©ë²•","ë…¸ë˜","ë…¸ë˜í•˜ë‹¤","ì¶¤","ì¶¤ì¶”ë‹¤","ìŒì•…","ìŒì•…ì„ë“£ë‹¤","ì˜ˆìˆ ","ì˜ˆìˆ ì„ê°ìƒí•˜ë‹¤","ë°°ìš°","ì—°ê·¹","ì—°ê¸°","ì—°ê¸°í•˜ë‹¤","ì˜í™”","ì˜í™”ë¥¼ë³´ë‹¤","ì±…","ì±…ì„ì½ë‹¤","ê·¸ë¦¼","ê·¸ë¦¼ì„ê·¸ë¦¬ë‹¤","ì—¬í–‰","ì—¬í–‰í•˜ë‹¤","íœ´ê°€","íœ´ê°€ë¥¼ë³´ë‚´ë‹¤","ì‰¬ë‹¤","ì‰¬ëŠ”ì‹œê°„","íœ´ì‹","íœ´ì‹ì„ì·¨í•˜ë‹¤","ì ","ì ì„ìë‹¤","ê¿ˆì„ê¾¸ë‹¤","ì¼","ì¼ì„í•˜ë‹¤","ë…¸ë™","ë…¸ë™í•˜ë‹¤","ì·¨ì—…","ì·¨ì—…í•˜ë‹¤","ì§ì—…","ì§ì—…ì„ê°€ì§€ë‹¤","ì§ì¥","ì§ì¥ìƒí™œ","ì¼ìƒ","ì¼ìƒìƒí™œ","íœ´ì¼","íœ´ì¼ì„ë³´ë‚´ë‹¤","ìš”ì¼","ë‚ ì§œ","ì‹œê°„","ì‹œê³„","ê¸°ë‹¤ë¦¼","ê¸°ë‹¤ë¦¬ë‹¤","ë„ì°©","ë„ì°©í•˜ë‹¤","ì¶œë°œ","ì¶œë°œí•˜ë‹¤","ì—¬í–‰","ì—¬í–‰í•˜ë‹¤","ì‹ì‚¬","ì‹ì‚¬í•˜ë‹¤","ì•„ì¹¨ì‹ì‚¬","ì ì‹¬ì‹ì‚¬","ì €ë…ì‹ì‚¬","ê°„ì‹","ê°„ì‹ë¨¹ë‹¤","ì˜ì–‘","ì˜ì–‘ê°€","ìŒì‹","ìŒì‹ì„ë§›ë³´ë‹¤","ìš”ë¦¬","ìš”ë¦¬í•˜ë‹¤","ì²­ì†Œ","ì²­ì†Œí•˜ë‹¤","ì„¸íƒ","ì„¸íƒí•˜ë‹¤","ëª©ìš•","ëª©ìš•í•˜ë‹¤","ìƒ¤ì›Œ","ìƒ¤ì›Œí•˜ë‹¤","ê¾¸ë¯¸ë‹¤","ê¾¸ë¯¸ë‹¤","ë†€ì´","ë†€ì´í•˜ë‹¤","ë†€ì´í„°","ë†€ì´ê³µì›","ì•½ì†","ì•½ì†í•˜ë‹¤","ëª¨ì„","ëª¨ì„ì°¸ì„í•˜ë‹¤","ì‡¼í•‘","ì‡¼í•‘í•˜ë‹¤","ë¬¼ê±´","ë¬¼ê±´ì‚¬ê¸°","ì—¬í–‰","ì—¬í–‰í•˜ë‹¤","ê°€ë°©","ê°€ë°©ì„ë“¤ë‹¤","ì‚¬ì§„","ì‚¬ì§„ì°ë‹¤","ì¹´ë©”ë¼","ì¹´ë©”ë¼ë¥¼ë“¤ë‹¤","ì „í™”","ì „í™”í•˜ë‹¤","ë¬¸ì","ë¬¸ìë¥¼ë³´ë‚´ë‹¤","ì¸í„°ë„·","ì¸í„°ë„·ì„ì´ìš©í•˜ë‹¤","íœ´ëŒ€í°","íœ´ëŒ€í°ì„ê°€ì§€ë‹¤","ì»´í“¨í„°","ì»´í“¨í„°ë¥¼ì‚¬ìš©í•˜ë‹¤","ë„ì„œê´€","ë„ì„œê´€ì„ê°€ë‹¤","ê³µì›","ê³µì›ì—ê°€ë‹¤","ê½ƒ"];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(QSO_ELEMENTS)
        QSO_ELEMENTS = array_lenth_up(QSO_ELEMENTS,count);
        for (var qso_element of QSO_ELEMENTS)
            repeated.push(Array(repeatCount).fill(qso_element).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_kdn"){
        var KDNs = ["A11","A12","A13","A14","A15","A16","A17","A18","A19","A2Ã˜","A21","A22","A23","A24","A25","A26","A27","A28","A29","A3Ã˜","A31","A32","A33","A34","A35","B11","B12","B13","B14","B15","B16","B17","B18","B19","B2Ã˜","B21","B22","B23","B24","B25","B26","CÃ˜1","CÃ˜3","CÃ˜4","CÃ˜5","CÃ˜6","CÃ˜7","CÃ˜8","CÃ˜1Ã˜","CÃ˜11","CÃ˜12","CÃ˜13","CÃ˜14","CÃ˜15","CÃ˜16","CÃ˜17","CÃ˜18","CÃ˜2Ã˜","CÃ˜21","CÃ˜22","CÃ˜23","CÃ˜24","CÃ˜25","CÃ˜26","CÃ˜27","CÃ˜28","CÃ˜29","CÃ˜3Ã˜","CÃ˜31","C2Ã˜","C21","C23","DÃ˜1","DÃ˜2","DÃ˜3","DÃ˜4","DÃ˜5","DÃ˜6","DÃ˜7","D12","D13","D15","D16","D17","D2Ã˜","D21","D22","D23","D24","D25","EÃ˜1","EÃ˜2","EÃ˜3","E11","E12","E13","E14","E15","E16","E17","E2Ã˜","E21","FÃ˜2","FÃ˜3","FÃ˜6","FÃ˜7","FÃ˜8","FÃ˜9","FÃ˜1Ã˜","FÃ˜11","F19","F2Ã˜","F21","F23","F24","F25","F26","GÃ˜1","GÃ˜2","GÃ˜6","GÃ˜7","GÃ˜8","GÃ˜9","G11","G15","G16","G18","G19","G21","G22","G23","HÃ˜2","HÃ˜3","HÃ˜4","HÃ˜5","HÃ˜9","H12","H13","H14","H15","H19","H2Ã˜","H21","H23","H24","H25","H26","H27","H28","H29","H3Ã˜","H31","H32","KÃ˜2","KÃ˜3","KÃ˜4","KÃ˜5","KÃ˜6","KÃ˜7","KÃ˜8","KÃ˜9","KÃ˜11","KÃ˜12","K12","K13","K15","K16","K2Ã˜","K22","K23","K25","K28","K31","K32","K33","K34","LÃ˜2","LÃ˜7","LÃ˜8","LÃ˜9","LÃ˜11","LÃ˜12","LÃ˜13","LÃ˜14","L14","L18","L19","L21","L23","L24","L25","L26","L27","L28","MÃ˜1","MÃ˜2","NÃ˜1","NÃ˜2","NÃ˜3","NÃ˜5","NÃ˜6","NÃ˜7","NÃ˜8","NÃ˜9","NÃ˜1Ã˜","NÃ˜11","PÃ˜1","PÃ˜2","PÃ˜3","PÃ˜4","PÃ˜5","PÃ˜6","PÃ˜7","PÃ˜8","QÃ˜1","QÃ˜2","QÃ˜3","QÃ˜4","QÃ˜5","RÃ˜1","RÃ˜2","RÃ˜3","RÃ˜4","RÃ˜5","SÃ˜1","SÃ˜2","SÃ˜3","SÃ˜4","SÃ˜5","TÃ˜1","ISÃ˜1","ISÃ˜2","ISÃ˜3","ISÃ˜4","ISÃ˜5"];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(KDNs)
        KDNs = array_lenth_up(KDNs,count);
        for (var kdn of KDNs)
            repeated.push(Array(repeatCount).fill(kdn).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_kdn_city"){
        var KDNCities = ["ì„œìš¸ ì¢…ë¡œ","ì„œìš¸ ì¤‘êµ¬","ì„œìš¸ ì„±ë™","ì„œìš¸ ë™ëŒ€ë¬¸","ì„œìš¸ ì„±ë¶","ì„œìš¸ ì„œëŒ€ë¬¸","ì„œìš¸ ë§ˆí¬","ì„œìš¸ ìš©ì‚°","ì„œìš¸ ì˜ë“±í¬","ì„œìš¸ ê´€ì•…","ì„œìš¸ ë„ë´‰","ì„œìš¸ ê°•ë‚¨","ì„œìš¸ ê°•ì„œ","ì„œìš¸ ì€í‰","ì„œìš¸ ë™ì‘","ì„œìš¸ êµ¬ë¡œ","ì„œìš¸ ê°•ë™","ì„œìš¸ ì¤‘ë‘","ì„œìš¸ ë…¸ì›","ì„œìš¸ ì„œì´ˆ","ì„œìš¸ ì–‘ì²œ","ì„œìš¸ ì†¡íŒŒ","ì„œìš¸ ê¸ˆì²œ","ì„œìš¸ ê´‘ì§„","ì„œìš¸ ê°•ë¶","ë¶€ì‚° ë™êµ¬","ë¶€ì‚° ì¤‘êµ¬","ë¶€ì‚° ì„œêµ¬","ë¶€ì‚° ì˜ë„","ë¶€ì‚° ë¶€ì‚°ì§„","ë¶€ì‚° ë™ë˜","ë¶€ì‚° ë‚¨êµ¬","ë¶€ì‚° ë¶êµ¬","ë¶€ì‚° í•´ìš´ëŒ€","ë¶€ì‚° ì‚¬í•˜","ë¶€ì‚° ê¸ˆì •","ë¶€ì‚° ê°•ì„œ","ë¶€ì‚° ì—°ì œ","ë¶€ì‚° ìˆ˜ì˜","ë¶€ì‚° ì‚¬ìƒ","ë¶€ì‚° ê¸°ì¥","ìˆ˜ì›","ì˜ì •ë¶€","ì„±ë‚¨","ë¶€ì²œ","ì•ˆì–‘","ê´‘ëª…","ë™ë‘ì²œ","êµ¬ë¦¬","í‰íƒ","ì•ˆì‚°","ê³¼ì²œ","ì˜¤ì‚°","í•˜ë‚¨","êµ°í¬","ì˜ì™•","ì‹œí¥","ê³ ì–‘","ë‚¨ì–‘ì£¼","ìš©ì¸","ì´ì²œ","íŒŒì£¼","ê¹€í¬","ì•ˆì„±","í™”ì„±","ê´‘ì£¼","í¬ì²œ","ì–‘ì£¼","ì—¬ì£¼","ì–‘í‰","ê°€í‰","ì—°ì²œ","ì¶˜ì²œ","ì›ì£¼","ê°•ë¦‰","ì†ì´ˆ","ë™í•´","íƒœë°±","ì‚¼ì²™","í™ì²œ","íš¡ì„±","í‰ì°½","ì •ì„ ","ì˜ì›”","ì–‘ì–‘","ì¸ì œ","ê³ ì„±","ì–‘êµ¬","í™”ì²œ","ì² ì›","ì²­ì£¼","ì¶©ì£¼","ì œì²œ","ì²­ì›","ë³´ì€","ì˜¥ì²œ","ì˜ë™","ê´´ì‚°","ì§„ì²œ","ìŒì„±","ë‹¨ì–‘","ì¦í‰","ì²œì•ˆ","ê³µì£¼","ì„œì‚°","ì•„ì‚°","ë³´ë ¹","ë…¼ì‚°","ê³„ë£¡","ë‹¹ì§„","ì˜ˆì‚°","í™ì„±","ì²­ì–‘","ì„œì²œ","ë¶€ì—¬","ê¸ˆì‚°","íƒœì•ˆ","ì „ì£¼","êµ°ì‚°","ë‚¨ì›","ê¹€ì œ","ì •ì","ìµì‚°","ì™„ì£¼","ë¶€ì•ˆ","ê³ ì°½","ìˆœì°½","ì„ì‹¤","ì¥ìˆ˜","ì§„ì•ˆ","ë¬´ì£¼","ëª©í¬","ì—¬ìˆ˜","ìˆœì²œ","ë‚˜ì£¼","ê´‘ì–‘","ì¥ì„±","ë‹´ì–‘","ê³¡ì„±","êµ¬ë¡€","ê³ í¥","ë³´ì„±","í™”ìˆœ","í•¨í‰","ì˜ê´‘","ë¬´ì•ˆ","ì˜ì•”","ê°•ì§„","ì¥í¥","í•´ë‚¨","ì™„ë„","ì§„ë„","ì‹ ì•ˆ","ê¹€ì²œ","ê²½ì£¼","ì•ˆë™","í¬í•­","êµ¬ë¯¸","ì˜ì£¼","ì˜ì²œ","ìƒì£¼","ê²½ì‚°","ë¬¸ê²½","ê³ ë ¹","ì„±ì£¼","ì¹ ê³¡","êµ°ìœ„","ì˜ˆì²œ","ë´‰í™”","ì˜ì–‘","ì˜ì„±","ì²­ë„","ì²­ì†¡","ì˜ë•","ìš¸ì§„","ìš¸ë¦‰","ì§„ì£¼","ì°½ì›","ê¹€í•´","ë°€ì–‘","í†µì˜","ê±°ì œ","ì‚¬ì²œ","ì–‘ì‚°","í•¨ì•ˆ","ë‚¨í•´","ê³ ì„±","í•˜ë™","ì‚°ì²­","í•¨ì–‘","ê±°ì°½","í•©ì²œ","ì˜ë ¹","ì°½ë…•","ì œì£¼","ì„œê·€í¬","ì¸ì²œ ì¤‘êµ¬","ì¸ì²œ ë™êµ¬","ì¸ì²œ ë¯¸ì¶”í™€","ì¸ì²œ ë‚¨ë™","ì¸ì²œ ì„œêµ¬","ì¸ì²œ ë¶€í‰","ì¸ì²œ ê³„ì–‘","ì¸ì²œ ì—°ìˆ˜","ì¸ì²œ ê°•í™”","ì¸ì²œ ì˜¹ì§„","ëŒ€êµ¬ ì¤‘êµ¬","ëŒ€êµ¬ ë™êµ¬","ëŒ€êµ¬ ì„œêµ¬","ëŒ€êµ¬ ë‚¨êµ¬","ëŒ€êµ¬ ë¶êµ¬","ëŒ€êµ¬ ìˆ˜ì„±","ëŒ€êµ¬ ë‹¬ì„œ","ëŒ€êµ¬ ë‹¬ì„±","ê´‘ì£¼ ë™êµ¬","ê´‘ì£¼ ì„œêµ¬","ê´‘ì£¼ ë¶êµ¬","ê´‘ì£¼ ê´‘ì‚°","ê´‘ì£¼ ë‚¨êµ¬","ëŒ€ì „ ëŒ€ë•","ëŒ€ì „ ë™êµ¬","ëŒ€ì „ ì„œêµ¬","ëŒ€ì „ ì¤‘êµ¬","ëŒ€ì „ ìœ ì„±","ìš¸ì‚° ì¤‘êµ¬","ìš¸ì‚° ë‚¨êµ¬","ìš¸ì‚° ë™êµ¬","ìš¸ì‚° ë¶êµ¬","ìš¸ì‚° ìš¸ì£¼","ì„¸ì¢…","ë…ë„","ë§ˆë¼ë„","í‘ì‚°ë„","ê²©ë ¬ë¹„ì—´ë„","ë°±ë ¹ë„"];
        var repeated = [], repeatCount = getRepeatCount();
        array_shuffle(KDNCities)
        KDNCities = array_lenth_up(KDNCities,count);
        for (var kdncitie of KDNCities)
            repeated.push(Array(repeatCount).fill(kdncitie).join(add_spacer()));
        add_string(repeated);
        var data = repeated.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_number"){
        const resultArray = random_number();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        let newStr = data.replace(/0/g, "Ã˜");
        changeQsoSample(newStr);
    }else if(selectedValue=="random_alphabat"){
        const resultArray = random_alphabat();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_specialchar"){
        const resultArray = random_specialchar();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_number_alphabat"){
        var callsigns = random_number();
        callsigns = callsigns.concat(random_alphabat());
        array_shuffle(callsigns);
        result = array_shuffle_slice(callsigns,count);
        resultArray_repeat = result.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat)
        data = resultArray_repeat.join(add_spacer());
        let newStr = data.replace(/0/g, "Ã˜");
        changeQsoSample(newStr);
    }else if(selectedValue=="random_alphabat_specialchar"){
        var callsigns = random_alphabat();
        callsigns = callsigns.concat(random_specialchar());
        array_shuffle(callsigns);
        result = array_shuffle_slice(callsigns,count);
        resultArray_repeat = result.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat)
        data = resultArray_repeat.join(add_spacer());
        let newStr = data.replace(/0/g, "Ã˜");
        changeQsoSample(newStr);
    }else if(selectedValue=="random_number_alphabat_specialchar"){
        var callsigns = random_number();
        callsigns = callsigns.concat(random_alphabat());
        callsigns = callsigns.concat(random_specialchar());
        array_shuffle(callsigns);
        result = array_shuffle_slice(callsigns, count);
        resultArray_repeat = result.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat)
        data = resultArray_repeat.join(add_spacer());
        let newStr = data.replace(/0/g, "Ã˜");
        changeQsoSample(newStr);
    }else if(selectedValue=="random_moum"){
        const resultArray = random_moum();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_jaum"){
        const resultArray = random_jaum();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_jaummoum"){
        var resultArray = random_jaummoum();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_hiragana"){
        const resultArray = random_hiragana();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }else if(selectedValue=="random_katakana"){
        const resultArray = random_katakana();
        resultArray_repeat = resultArray.flatMap(element => Array(getRepeatCount()).fill(element));
        add_string(resultArray_repeat);
        var data = resultArray_repeat.join(add_spacer());
        changeQsoSample(data);
    }
});

function array_shuffle_slice(array_data, count){
        let charArray = array_data.join('').split('');
        for (let i = charArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [charArray[i], charArray[j]] = [charArray[j], charArray[i]];
        }
        let resultArray = [];
        for (let i = 0; i < charArray.length; i += 5) {
            resultArray.push(charArray.slice(i, i + 5).join(''));
        }
        result = resultArray.slice(0, count);
        return result;
}

function random_number(){
    count = gen_number.value;
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomNumbers = [];
        for (let j = 0; j < 5; j++) {
            randomNumbers.push(Math.floor(Math.random() * 10));
        }
        resultArray.push(randomNumbers.join(''));
    }
    return resultArray;
}

function random_alphabat(){
    count = gen_number.value;
    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomLetters = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            randomLetters.push(alphabet[randomIndex]);
        }
        resultArray.push(randomLetters.join(''));
    }
    return resultArray;
}

function random_hiragana(){
    count = gen_number.value;
    const alphabet = "ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ãŸã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®ã¯ã²ãµã¸ã»ã¾ã¿ã‚€ã‚ã‚‚ã‚„ã‚†ã‚ˆã‚‰ã‚Šã‚‹ã‚Œã‚ã‚ã‚ã‚‘ã‚’ã‚“";
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomLetters = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            randomLetters.push(alphabet[randomIndex]);
        }
        resultArray.push(randomLetters.join(''));
    }
    return resultArray;
}

function random_katakana(){
    count = gen_number.value;
    const alphabet = "ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ã¡ãƒãƒ„ãƒˆãƒŠãƒ‹ãƒŒãƒãƒãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ°ãƒ±ãƒ²ãƒ³ã‚’ã‚“ã€ã€‚";
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomLetters = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            randomLetters.push(alphabet[randomIndex]);
        }
        resultArray.push(randomLetters.join(''));
    }
    return resultArray;
}

function random_moum(){
    count = gen_number.value;
    const alphabet = 'ã…ã…‘ã…“ã…•ã…—ã…›ã…œã… ã…¢ã…”ã…';
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomLetters = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            randomLetters.push(alphabet[randomIndex]);
        }
        resultArray.push(randomLetters.join(''));
    }
    return resultArray;
}

function random_jaum(){
    count = gen_number.value;
    const alphabet = 'ã„±ã„²ã„´ã„·ã„¸ã„¹ã…ã…‚ã…ƒã……ã…†ã…‡ã…ˆã…‰ã…Šã…‹ã…Œã…ã…';
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomLetters = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            randomLetters.push(alphabet[randomIndex]);
        }
        resultArray.push(randomLetters.join(''));
    }
    return resultArray;
}

function random_jaummoum(){
    count = gen_number.value;
    const alphabet = 'ã„±ã„²ã„´ã„·ã„¸ã„¹ã…ã…‚ã…ƒã……ã…†ã…‡ã…ˆã…‰ã…Šã…‹ã…Œã…ã…ã…ã…‘ã…“ã…•ã…—ã…›ã…œã… ã…¡ã…£ã…”ã…';
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomLetters = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            randomLetters.push(alphabet[randomIndex]);
        }
        resultArray.push(randomLetters.join(''));
    }
    return resultArray;
}

function random_specialchar(){
    count = gen_number.value;
    const specialChars = `$&.,?/+-=:;()'"@`;
    const resultArray = [];
    for (let i = 0; i < count; i++) {
        const randomChars = [];
        for (let j = 0; j < 5; j++) {
            const randomIndex = Math.floor(Math.random() * specialChars.length);
            randomChars.push(specialChars[randomIndex]);
        }
        resultArray.push(randomChars.join(''));
    }
    return resultArray;
}

gen_syllables_option.addEventListener('change', function() {
    const selectedValue = this.value;
    gen_syllables_option.value = '';
    document.getElementById('user_txt_caption').innerHTML = 'â€» Sample from : DS1TZE';
    if(selectedValue=="hangul_initial_consonants"){
        hangulInitialConsonants();
    }else if(selectedValue=="hangul_simple_vowels"){
        hangulSimpleVowels();
    }else if(selectedValue=="hangul_simple_syllables"){
        hangulSimpleSyllables();
    }else if(selectedValue=="hangul_final_consonants"){
        hangulFinalConsonants();
    }else if(selectedValue=="hangul_syllables"){
        hangulSyllables();
    }else if(selectedValue=="hangul_complex_vowels"){
        hangulComplexVowels();
    }else if(selectedValue=="hangul_complex_syllables"){
        hangulComplexSyllables();
    }else if(selectedValue=="hangul_random_syllables"){
        hangulRandomSyllables();
    }else if(selectedValue=="hangul_frequent_syllables"){
        hangulFrequentSyllables();
    }
});

view1.onchange = function() {
    window.localStorage.setItem('view1', view1.checked);
    toggleSetting1(view1.checked);
}
view2.onchange = function() {
    window.localStorage.setItem('view2', view2.checked);
    toggleSetting2(view2.checked);
}
view3.onchange = function() {
    window.localStorage.setItem('view3', view3.checked);
    toggleSetting3(view3.checked);
}
word_space.onchange = function() {
    window.localStorage.setItem('word_space', word_space.value);
}
repeat_count.onchange = function() {
    window.localStorage.setItem('repeat_count', repeat_count.value);
}
gen_number.onchange = function() {
    window.localStorage.setItem('gen_number', gen_number.value);
}
loadScript_getcount.onchange = function() {
    window.localStorage.setItem('loadScript_getcount', loadScript_getcount.value);
}
loadScript_getcount.onchange = function() {
    window.localStorage.setItem('loadScript_getcount', loadScript_getcount.value);
}
freq.onchange = function() {
    window.localStorage.setItem('freq', freq.value);
}
wpm.onchange = function() {
    window.localStorage.setItem('wpm', wpm.value);
}
volume.onchange = function() {
    vol = volume.value / 100.0;
    window.localStorage.setItem('volume', volume.value);
}
keyComputer.onchange = function() {
    window.localStorage.setItem('key', document.getElementById('selectkey').value);
}

keyHangulSmaller.onclick = function() {
    window.localStorage.setItem('key', document.getElementById('selectkey').value);
}
keyHangulSmall.onclick = function() {
    window.localStorage.setItem('key', document.getElementById('selectkey').value);
}
keyHangul.onclick = function() {
    window.localStorage.setItem('key', document.getElementById('selectkey').value);
}
flute.onchange = function() {
	smoothingDuration = flute.checked ? 0.02 : 0.004;
    window.localStorage.setItem('flute', flute.checked);
}
noise.onchange = function() {
    window.localStorage.setItem('noise', noise.checked);
}
fading.onchange = function() {
    window.localStorage.setItem('fading', fading.checked);
}
selectionOnly.onchange = function() {
    window.localStorage.setItem('selection_only', selectionOnly.checked);
}
highlightSlowly.onchange = function() {
    window.localStorage.setItem('highlight_slowly', highlightSlowly.checked);
}
hideText.onchange = function() {
    window.localStorage.setItem('hide_text', hideText.checked);
}
repeat.onchange = function() {
    window.localStorage.setItem('repeat', repeat.checked);
}
add_vvv.onchange = function() {
    window.localStorage.setItem('add_vvv', add_vvv.checked);
}
layer_display.onchange = function() {
    window.localStorage.setItem('layer_display', layer_display.checked);
}
add_ar.onchange = function() {
    window.localStorage.setItem('add_ar', add_ar.checked);
}
add_vvv_text.onchange = function() {
    window.localStorage.setItem('add_vvv_text', add_vvv_text.value);
}
add_ar_text.onchange = function() {
    window.localStorage.setItem('add_ar_text', add_ar_text.value);
}
window.addEventListener('DOMContentLoaded', function() {
    try {
        if(window.localStorage.getItem('view1') == 'true'){
            document.getElementById('view1').checked = true;
            toggleSetting1(true);
        }
        if(window.localStorage.getItem('view2') == 'true'){
            document.getElementById('view2').checked = true;
            toggleSetting2(true);
        }
        if(window.localStorage.getItem('view3') == 'true'){
            document.getElementById('view3').checked = true;
            toggleSetting3(true);
        }
        if(window.localStorage.getItem('layer_display') == 'true') document.getElementById('layer_display').checked = true;
        if(window.localStorage.getItem('add_vvv') == 'true') document.getElementById('add_vvv').checked = true;
        if(window.localStorage.getItem('add_ar') == 'true') document.getElementById('add_ar').checked = true;
        if(window.localStorage.getItem('add_vvv_text')) document.getElementById('add_vvv_text').value = window.localStorage.getItem('add_vvv_text');
        if(window.localStorage.getItem('add_ar_text')) document.getElementById('add_ar_text').value = window.localStorage.getItem('add_ar_text');
        if (window.localStorage.getItem('word_space')) word_space.value = parseInt(window.localStorage.getItem('word_space'));
        if (window.localStorage.getItem('repeat_count')) repeat_count.value = parseInt(window.localStorage.getItem('repeat_count'));
        if (window.localStorage.getItem('gen_number')) gen_number.value = parseInt(window.localStorage.getItem('gen_number'));
        if (window.localStorage.getItem('loadScript_getcount')) loadScript_getcount.value = parseInt(window.localStorage.getItem('loadScript_getcount'));
        if (window.localStorage.getItem('freq')) freq.value = parseInt(window.localStorage.getItem('freq'));
        if (window.localStorage.getItem('wpm')) wpm.value = parseInt(window.localStorage.getItem('wpm'));
        if (window.localStorage.getItem('volume')) volume.value = parseInt(window.localStorage.getItem('volume'));
        vol = volume.value / 100.0;
        if (window.localStorage.getItem('flute')) flute.checked = window.localStorage.getItem('flute') == 'true';
		smoothingDuration = flute.checked ? 0.02 : 0.004;
        if (window.localStorage.getItem('noise')) noise.checked = window.localStorage.getItem('noise') == 'true';
        if (window.localStorage.getItem('fading')) fading.checked = window.localStorage.getItem('fading') == 'true';
        if (window.localStorage.getItem('selection_only')) selectionOnly.checked = window.localStorage.getItem('selection_only') == 'true';
        if (window.localStorage.getItem('highlight_slowly')) highlightSlowly.checked = window.localStorage.getItem('highlight_slowly') == 'true';       
        if (window.localStorage.getItem('hide_text')) hideText.checked = window.localStorage.getItem('hide_text') == 'true';
        if (window.localStorage.getItem('repeat')) repeat.checked = window.localStorage.getItem('repeat') == 'true';
        if (window.localStorage.getItem('key')) document.getElementById('selectkey').selected = true;
        if (window.localStorage.getItem('font_name')){
            document.getElementById('font_select').value = window.localStorage.getItem('font_name');
            document.body.style.fontFamily = window.localStorage.getItem('font_name');
        } 
        changeQsoSample(localStorage.getItem('user_txt'));
    } catch (e) {
    }
}, true);

makeEditor(document.querySelector("#user_txt"));

function makeEditor(textArea, display) {
    var editor = CodeMirror(function(el) {
        el.id = textArea.id;
        el.className = el.className + " " + textArea.className;
        textArea.parentNode.replaceChild(el, textArea);
    }, {
        value: textArea.value,
        mode: "xml",
        lineWrapping: true,
        styleSelectedText: true
    });

editor.on("change", function(instance, changeObj) {
        var str = instance.getValue().toString();
        strcnt_total = str.length;
        strcnt_character = str.replace(/\s+/g, "").length;
        strcnt_space = strcnt_total - strcnt_character;
        strcnt_total_enUS = strcnt_total.toLocaleString('en-US');
        strcnt_character_enUS = strcnt_character.toLocaleString('en-US');
        strcnt_space_enUS = strcnt_space.toLocaleString('en-US');
        document.getElementById('textarea_count').innerHTML = strcnt_total_enUS + '(' + strcnt_space_enUS + '+' + strcnt_character_enUS + ')';
        window.localStorage.setItem('user_txt', doc.getValue());
    });
}

document.getElementById('textarea_count').addEventListener('click', (event) => {
    alert(document.getElementById('textarea_count').title);
});

function changeQsoSample(data) {
    if (!stopped) stop.click();
    cursorFrom = null;
    user_txt.style.display = "block";
    user_txt.classList.toggle('active');
    cm = user_txt.CodeMirror;
    doc = cm.doc;
    cm.refresh();
    doc.setValue(data);
    window.localStorage.setItem('user_txt', doc.getValue());
    clearDitdah();
    setProgressBar(0)
    document.getElementById('textarea_play_char').innerHTML = '';
    document.getElementById('textarea_select_count').innerHTML = '0';
    document.getElementById('textarea_select_percent').innerHTML = '0';
}

var RANDOM_GEN_NUMBER = gen_number.value;

function generateSuffix(length) {
    var ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    var result = ALPHABET[Math.floor(Math.random() * ALPHABET.length)];
    for (var i = 1; i < length; i++)
        result += ALPHABET[Math.floor(Math.random() * ALPHABET.length)];
    return result;
}
function getRepeatCount() {
    return parseInt(document.getElementById('repeat_count').value);
}
function generateHLCallsigns(count, repeatCount) {
    var callsigns = [];
    var PREFIX = ["HLÃ˜","HL1","HL2","HL3","HL4","HL5","DSÃ˜","DS1","DS2","DS3","DS4","DS5","DTÃ˜","D7Ã˜","D8Ã˜","D9Ã˜","6KÃ˜","6K2","6K5","6LÃ˜","6L5","6MÃ˜","6M5","6NÃ˜"];
    for (var i = 0; i < count; i++) {
        var prefix = PREFIX[Math.floor(Math.random() * PREFIX.length)];
        var suffixLength = (prefix.startsWith("HL") ? (Math.random() > 0.2 ? 3 : 2) : 3);
        var callsign = prefix + generateSuffix(suffixLength);
        callsign = callsign.replace('0','Ã˜');
        callsigns.push(Array(repeatCount).fill(callsign));
    }
    return callsigns;
}

function generateITUCallsigns(count, repeatCount) {
    var callsigns = [];
    var PREFIX=["AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ","A2","A3","A4","A5","A6","A7","A8","A9","B","BM","BN","BO","BQ","BU","BV","BW","BX","CA","CD","CE","CF","CG","CH","CI","CJ","CK","CL","CM","CN","CO","CP","CQ","CR","CS","CT","CU","CV","CW","CX","CY","CZ","C2","C3","C4","C5","C6","C7","C8","C9","DA","DB","DC","DD","DE","DF","DG","DH","DI","DJ","DK","DL","DM","DN","DO","DP","DQ","DR","DS","DT","DU","DV","DW","DX","DY","DZ","D2","D3","D4","D5","D6","D7","D8","D9","EA","EB","EC","ED","EE","EF","EG","EH","EI","EJ","EK","EL","EM","EN","EO","EP","EQ","ER","ES","ET","EU","EV","EW","EX","EY","EZ","E2","E3","E4","E5","E6","E7","F","G","HA","HB","HB0","HB3Y","HBL","HC","HD","HE","HF","HG","HH","HI","HJ","HK","HL","HM","HN","HO","HP","HQ","HR","HS","HT","HU","HV","HW","HX","HY","HZ","H2","H3","H4","H6","H7","H8","H9","I","JA","JB","JC","JD","JE","JF","JG","JH","JI","JJ","JK","JL","JM","JN","JO","JP","JQ","JR","JS","JT","JU","JV","JW","JX","JY","JZ","J2","J3","J4","J5","J6","J7","J8","K","LA","LB","LC","LD","LE","LF","LG","LH","LI","LJ","LK","LL","LM","LN","LO","LP","LQ","LR","LS","LT","LU","LV","LW","LX","LY","LZ","L2","L3","L4","L5","L6","L7","L8","L9","M","N","OA","OB","OC","OD","OE","OF","OG","OH","OI","OJ","OK","OL","OM","ON","OP","OQ","OR","OS","OT","OU","OV","OW","OX","OY","OZ","PA","PB","PC","PD","PE","PF","PG","PH","PI","PI","PJ","PK","PL","PM","PN","PPO","PP","PQ","PR","PS","PT","PU","PV","PW","PX","PY","PZ","P2","P3","P4","P5","P6","P7","P8","P9","R","SA","SB","SC","SD","SE","SF","SG","SH","SI","SJ","K","SL","SM","SN","SO","SP","SQ","SR","SSA","SSB","SSC","SSD","SSE","SSF","SSG","SSH","SSI","SSJ","SSK","SSL","SSM","SSN","STO","STP","STQ","STR","STS","STT","STU","STV","STW","STX","STY","STZ","SU","SV","SW","SX","SY","SZ","S2","S3","S5","S6","S7","S8","S9","TA","TB","TC","TD","TE","TF","TG","TH","TI","TJ","TK","TL","TM","TN","TO","TP","TQ","TR","TS","TT","TU","TV","TW","TX","TY","TZ","T2","T3","T4","T5","T6","T7","T8","UA","UB","UC","UD","UE","UF","UG","UH","UI","UJ","UK","UL","UM","UN","UO","UP","UQ","UR","US","UT","UU","UV","UW","UX","UY","UZ","VA","VB","VC","VD","VE","VF","VG","VG","VH","VI","VJ","VK","VL","VM","VN","VO","VP","VQ","VR","VS","VT","VU","VV","VW","VX","VY","VZ","V2","V3","V4","V5","V6","V7","V8","W","XA","XB","XC","XD","XE","XF","XG","XH","XI","XJ","XK","XL","XM","XN","XO","XP","XQ","XR","XS","XT","XU","XV","XW","XX","XY","XZ","YA","YB","YC","YD","YE","YF","YG","YH","YH","YI","YJ","YK","YL","YM","YN","YO","YP","YQ","YR","YS","YT","YU","YV","YW","YX","YY","Y2","Y3","Y4","Y5","Y6","Y7","Y8","Y9","ZA","ZB","ZC","ZD","ZE","ZF","ZG","ZH","ZI","ZJ","ZK","XL","ZM","ZN","ZO","ZP","ZQ","ZR","ZS","ZT","ZU","ZV","ZW","ZX","ZZ","Z2","Z3","Z8","2","3A","3B","3C","3DA","3DB","3DC","3DD","3DE","3DF","3DG","3DH","3DI","3DJ","3DK","3DL","3DM","3DN","3DO","3DP","3DQ","3DR","3DS","3DT","3DU","3DV","3DX","3DY","3DZ","3E","3F","3G","3H","3I","3J","3K","3L","3M","3N","3O","3P","3Q","3R","3S","3T","3U","3V","3W","3X","3Y","3Z","4A","4B","4C","4D","4E","4F","4G","4H","4I","4J","4K","4L","4M","4O","4P","4Q","4R","4S","4T","4U","4V","4W","4X","4Y","4Z","5A","5B","5C","5D","5E","5F","5G","5H","5I","5J","5K","5L","5M","5N","5O","5P","5Q","5R","5S","5T","5U","5V","5W","5X","5Y","5Z","6A","6B","6C","6D","6E","6F","6J","6K","6L","6M","6N","6O","6P","6Q","6S","6T","6U","6V","6W","6X","6Y","6Z","7A","7B","7C","7D","7E","7F","7G","7H","7I","7J","7K","7L","7M","7N","7O","7P","7Q","7R","7S","7T","7U","7V","7W","7X","7Y","7Z","8A","8B","8C","8D","8E","8F","8G","8H","8I","8J","8K","8L","8M","8N","8O","8P","8Q","8R","8S","8T","8U","8V","8E","8X","8Y","8Z","9A","9B","9C","9D","9E","9F","9G","9H","9I","9J","9K","9L","9M","9N","9O","9P","9Q","9R","9S","9T","9U","9V","9W","9X","9Y","9Z"];
    for (var i = 0; i < count; i++) {
        var prefix1 = PREFIX[Math.floor(Math.random() * PREFIX.length)];
        var randoNnum = Math.floor(Math.random() * 10);
        let randomChars = [];
        for (let i = 0; i < 3; i++) {
            randomChars += String.fromCharCode(Math.floor(Math.random() * 26) + 65);
        }
        callsign = prefix1 + randoNnum + randomChars;
        callsign = callsign.replace('0','Ã˜');
        callsigns.push(Array(repeatCount).fill(callsign).join(" "));
    }
    add_string(callsigns);
    return callsigns;
}

function generateJACallsigns(count, repeatCount) {
    var callsigns = [];
    var PREFIX = [];
    var PRE_PREFIX = ["A", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S"].map(x => "J" + x);
    PRE_PREFIX.push("7J", "8J", "8N");
    for (var i = 0; i < 10; i++)
        for (var pre of PRE_PREFIX)
            PREFIX.push(pre + i);
    for (var i = 0; i < count; i++) {
        var prefix = PREFIX[Math.floor(Math.random() * PREFIX.length)];
        var callsign = prefix + generateSuffix(3);
        callsign = callsign.replace('0','Ã˜');
        callsigns.push(Array(repeatCount).fill(callsign).join(" "));
    }
    add_string(callsigns);
    return callsigns;
}

function generateBABVCallsigns(count, repeatCount) {
    var callsigns = [];
    var PREFIX = [];
    var PRE_PREFIX = ["A", "D", "G", "T", "Y", "Z", "V"].map(x => "B" + x);
    for (var i = 0; i < 10; i++)
        for (var pre of PRE_PREFIX)
            PREFIX.push(pre + i);
    for (var i = 0; i < count; i++) {
        var prefix = PREFIX[Math.floor(Math.random() * PREFIX.length)];
        var callsign = prefix + generateSuffix(3);
        callsign = callsign.replace('0','Ã˜');
        callsigns.push(Array(repeatCount).fill(callsign).join(" "));
    }
    add_string(callsigns);
    return callsigns;
}

function generateQCODE(count, repeatCount) {
  var qcodes = ["QRA","QRG","QRH","QRI","QRJ","QRK","QRL","QRM","QRN","QRO","QRP","QRQ","QRS","QRT","QRU","QRV","QRW","QRX","QRZ","QSA","QSB","QSD","QSG","QSK","QSL","QSM","QSN","QSO","QSP","QSR","QSS","QST","QSU","QSW","QSX","QSY","QSZ","QTA","QTC","QTH","QTR","QTU","QTX","QUA","QUC","QUD","QUE","QUF"];
  const result_qcodes = array_lenth_up(qcodes, count);
  const repeatedQcodes = result_qcodes.flatMap(code => Array(repeatCount).fill(code));
  add_string(repeatedQcodes);
  return repeatedQcodes;
}

function array_lenth_up(array, count){
    if(count > array.length){
        const newArray = [];
        for (let i = 0; i < count; i++) {
            newArray.push(array[i % array.length]);
        }
        array = newArray;
    }
    array_shuffle(array);
    const slice_array = array.slice(0, count);
    return slice_array;
}

function space_add(){
    let numSpaces = parseInt(document.getElementById('word_space').value);
    let spacer = " ".repeat(numSpaces);
    return spacer;
}

function isKSX1001(letter) {
    var ksx1001 = "ê°€ê°ê°„ê°‡ê°ˆê°‰ê°Šê°ê°‘ê°’ê°“ê°”ê°•ê°–ê°—ê°™ê°šê°›ê°œê°ê° ê°¤ê°¬ê°­ê°¯ê°°ê°±ê°¸ê°¹ê°¼ê±€ê±‹ê±ê±”ê±˜ê±œê±°ê±±ê±´ê±·ê±¸ê±ºê²€ê²ê²ƒê²„ê²…ê²†ê²‰ê²Šê²‹ê²Œê²ê²”ê²œê²ê²Ÿê² ê²¡ê²¨ê²©ê²ªê²¬ê²¯ê²°ê²¸ê²¹ê²»ê²¼ê²½ê³ê³„ê³ˆê³Œê³•ê³—ê³ ê³¡ê³¤ê³§ê³¨ê³ªê³¬ê³¯ê³°ê³±ê³³ê³µê³¶ê³¼ê³½ê´€ê´„ê´†ê´Œê´ê´ê´‘ê´˜ê´œê´ ê´©ê´¬ê´­ê´´ê´µê´¸ê´¼êµ„êµ…êµ‡êµ‰êµêµ”êµ˜êµ¡êµ£êµ¬êµ­êµ°êµ³êµ´êµµêµ¶êµ»êµ¼êµ½êµ¿ê¶ê¶‚ê¶ˆê¶‰ê¶Œê¶ê¶œê¶ê¶¤ê¶·ê·€ê·ê·„ê·ˆê·ê·‘ê·“ê·œê· ê·¤ê·¸ê·¹ê·¼ê·¿ê¸€ê¸ê¸ˆê¸‰ê¸‹ê¸ê¸”ê¸°ê¸±ê¸´ê¸·ê¸¸ê¸ºê¹€ê¹ê¹ƒê¹…ê¹†ê¹Šê¹Œê¹ê¹ê¹ê¹”ê¹–ê¹œê¹ê¹Ÿê¹ ê¹¡ê¹¥ê¹¨ê¹©ê¹¬ê¹°ê¹¸ê¹¹ê¹»ê¹¼ê¹½êº„êº…êºŒêº¼êº½êº¾ê»€ê»„ê»Œê»ê»ê»ê»‘ê»˜ê»™ê»œê»¨ê»«ê»­ê»´ê»¸ê»¼ê¼‡ê¼ˆê¼ê¼ê¼¬ê¼­ê¼°ê¼²ê¼´ê¼¼ê¼½ê¼¿ê½ê½‚ê½ƒê½ˆê½‰ê½ê½œê½ê½¤ê½¥ê½¹ê¾€ê¾„ê¾ˆê¾ê¾‘ê¾•ê¾œê¾¸ê¾¹ê¾¼ê¿€ê¿‡ê¿ˆê¿‰ê¿‹ê¿ê¿ê¿”ê¿œê¿¨ê¿©ê¿°ê¿±ê¿´ê¿¸ë€€ë€ë€„ë€Œë€ë€”ë€œë€ë€¨ë„ë…ëˆëŠëŒëë“ë”ë•ë—ë™ëë¼ë½ë‚€ë‚„ë‚Œë‚ë‚ë‚‘ë‚˜ë‚™ë‚šë‚œë‚Ÿë‚ ë‚¡ë‚¢ë‚¨ë‚©ë‚«ë‚¬ë‚­ë‚®ë‚¯ë‚±ë‚³ë‚´ë‚µë‚¸ë‚¼ëƒ„ëƒ…ëƒ‡ëƒˆëƒ‰ëƒëƒ‘ëƒ”ëƒ˜ëƒ ëƒ¥ë„ˆë„‰ë„‹ë„Œë„ë„’ë„“ë„˜ë„™ë„›ë„œë„ë„£ë„¤ë„¥ë„¨ë„¬ë„´ë„µë„·ë„¸ë„¹ë…€ë…ë…„ë…ˆë…ë…‘ë…”ë…•ë…˜ë…œë… ë…¸ë…¹ë…¼ë†€ë†‚ë†ˆë†‰ë†‹ë†ë†’ë†“ë†”ë†˜ë†œë†¨ë‡Œë‡ë‡”ë‡œë‡ë‡Ÿë‡¨ë‡©ë‡¬ë‡°ë‡¹ë‡»ë‡½ëˆ„ëˆ…ëˆˆëˆ‹ëˆŒëˆ”ëˆ•ëˆ—ëˆ™ëˆ ëˆ´ëˆ¼ë‰˜ë‰œë‰ ë‰¨ë‰©ë‰´ë‰µë‰¼ëŠ„ëŠ…ëŠ‰ëŠëŠ‘ëŠ”ëŠ˜ëŠ™ëŠšëŠ ëŠ¡ëŠ£ëŠ¥ëŠ¦ëŠªëŠ¬ëŠ°ëŠ´ë‹ˆë‹‰ë‹Œë‹ë‹’ë‹˜ë‹™ë‹›ë‹ë‹¢ë‹¤ë‹¥ë‹¦ë‹¨ë‹«ë‹¬ë‹­ë‹®ë‹¯ë‹³ë‹´ë‹µë‹·ë‹¸ë‹¹ë‹ºë‹»ë‹¿ëŒ€ëŒëŒ„ëŒˆëŒëŒ‘ëŒ“ëŒ”ëŒ•ëŒœë”ë•ë–ë˜ë›ëœëëŸë¤ë¥ë§ë©ë«ë®ë°ë±ë´ë¸ë€ëëƒë„ë…ëŒëë”ë ë¡ë¨ë¬ë„ë…ëˆë‹ëŒëëë”ë•ë—ë™ë›ëë ë¤ë¨ë¼ëë˜ëœë ë¨ë©ë«ë´ë‘ë‘‘ë‘”ë‘˜ë‘ ë‘¡ë‘£ë‘¥ë‘¬ë’€ë’ˆë’ë’¤ë’¨ë’¬ë’µë’·ë’¹ë“€ë“„ë“ˆë“ë“•ë“œë“ë“ ë“£ë“¤ë“¦ë“¬ë“­ë“¯ë“±ë“¸ë””ë”•ë”˜ë”›ë”œë”¤ë”¥ë”§ë”¨ë”©ë”ªë”°ë”±ë”´ë”¸ë•€ë•ë•ƒë•„ë•…ë•‹ë•Œë•ë•ë•”ë•œë•ë•Ÿë• ë•¡ë– ë–¡ë–¤ë–¨ë–ªë–«ë–°ë–±ë–³ë–´ë–µë–»ë–¼ë–½ë—€ë—„ë—Œë—ë—ë—ë—‘ë—˜ë—¬ë˜ë˜‘ë˜”ë˜˜ë˜¥ë˜¬ë˜´ë™ˆë™¤ë™¨ëšœëšëš ëš¤ëš«ëš¬ëš±ë›”ë›°ë›´ë›¸ëœ€ëœëœ…ëœ¨ëœ©ëœ¬ëœ¯ëœ°ëœ¸ëœ¹ëœ»ë„ëˆëŒë”ë•ë ë¤ë¨ë°ë±ë³ëµë¼ë½ë€ë„ëŒëëëë‘ë’ë–ë—ë˜ë™ëœë ë¨ë©ë«ë¬ë­ë´ëµë¸ëŸ‡ëŸ‰ëŸ¬ëŸ­ëŸ°ëŸ´ëŸ¼ëŸ½ëŸ¿ë €ë ë ‡ë ˆë ‰ë Œë ë ˜ë ™ë ›ë ë ¤ë ¥ë ¨ë ¬ë ´ë µë ·ë ¸ë ¹ë¡€ë¡„ë¡‘ë¡“ë¡œë¡ë¡ ë¡¤ë¡¬ë¡­ë¡¯ë¡±ë¡¸ë¡¼ë¢ë¢¨ë¢°ë¢´ë¢¸ë£€ë£ë£ƒë£…ë£Œë£ë£”ë£ë£Ÿë£¡ë£¨ë£©ë£¬ë£°ë£¸ë£¹ë£»ë£½ë¤„ë¤˜ë¤ ë¤¼ë¤½ë¥€ë¥„ë¥Œë¥ë¥‘ë¥˜ë¥™ë¥œë¥ ë¥¨ë¥©ë¥«ë¥­ë¥´ë¥µë¥¸ë¥¼ë¦„ë¦…ë¦‡ë¦‰ë¦Šë¦ë¦ë¦¬ë¦­ë¦°ë¦´ë¦¼ë¦½ë¦¿ë§ë§ˆë§‰ë§Œë§ë§ë§ë§‘ë§’ë§˜ë§™ë§›ë§ë§ë§¡ë§£ë§¤ë§¥ë§¨ë§¬ë§´ë§µë§·ë§¸ë§¹ë§ºë¨€ë¨ë¨ˆë¨•ë¨¸ë¨¹ë¨¼ë©€ë©‚ë©ˆë©‰ë©‹ë©ë©ë©“ë©”ë©•ë©˜ë©œë©¤ë©¥ë©§ë©¨ë©©ë©°ë©±ë©´ë©¸ëªƒëª„ëª…ëª‡ëªŒëª¨ëª©ëª«ëª¬ëª°ëª²ëª¸ëª¹ëª»ëª½ë«„ë«ˆë«˜ë«™ë«¼ë¬€ë¬„ë¬ë¬ë¬‘ë¬˜ë¬œë¬ ë¬©ë¬«ë¬´ë¬µë¬¶ë¬¸ë¬»ë¬¼ë¬½ë¬¾ë­„ë­…ë­‡ë­‰ë­ë­ë­ë­”ë­˜ë­¡ë­£ë­¬ë®ˆë®Œë®ë®¤ë®¨ë®¬ë®´ë®·ë¯€ë¯„ë¯ˆë¯ë¯“ë¯¸ë¯¹ë¯¼ë¯¿ë°€ë°‚ë°ˆë°‰ë°‹ë°Œë°ë°ë°‘ë°”ë°•ë°–ë°—ë°˜ë°›ë°œë°ë°ë°Ÿë°¤ë°¥ë°§ë°©ë°­ë°°ë°±ë°´ë°¸ë±€ë±ë±ƒë±„ë±…ë±‰ë±Œë±ë±ë±ë²„ë²…ë²ˆë²‹ë²Œë²ë²”ë²•ë²—ë²™ë²šë² ë²¡ë²¤ë²§ë²¨ë²°ë²±ë²³ë²´ë²µë²¼ë²½ë³€ë³„ë³ë³ë³ë³‘ë³•ë³˜ë³œë³´ë³µë³¶ë³¸ë³¼ë´„ë´…ë´‡ë´‰ë´ë´”ë´¤ë´¬ëµ€ëµˆëµ‰ëµŒëµëµ˜ëµ™ëµ¤ëµ¨ë¶€ë¶ë¶„ë¶‡ë¶ˆë¶‰ë¶Šë¶ë¶‘ë¶“ë¶•ë¶™ë¶šë¶œë¶¤ë¶°ë¶¸ë·”ë·•ë·˜ë·œë·©ë·°ë·´ë·¸ë¸€ë¸ƒë¸…ë¸Œë¸ë¸ë¸”ë¸œë¸ë¸Ÿë¹„ë¹…ë¹ˆë¹Œë¹ë¹”ë¹•ë¹—ë¹™ë¹šë¹›ë¹ ë¹¡ë¹¤ë¹¨ë¹ªë¹°ë¹±ë¹³ë¹´ë¹µë¹»ë¹¼ë¹½ëº€ëº„ëºŒëºëºëºëº‘ëº˜ëº™ëº¨ë»ë»‘ë»”ë»—ë»˜ë» ë»£ë»¤ë»¥ë»¬ë¼ë¼ˆë¼‰ë¼˜ë¼™ë¼›ë¼œë¼ë½€ë½ë½„ë½ˆë½ë½‘ë½•ë¾”ë¾°ë¿…ë¿Œë¿ë¿ë¿”ë¿œë¿Ÿë¿¡ì€¼ì‘ì˜ìœì ì¨ì©ì‚ì‚‘ì‚”ì‚˜ì‚ ì‚¡ì‚£ì‚¥ì‚¬ì‚­ì‚¯ì‚°ì‚³ì‚´ì‚µì‚¶ì‚¼ì‚½ì‚¿ìƒ€ìƒìƒ…ìƒˆìƒ‰ìƒŒìƒìƒ˜ìƒ™ìƒ›ìƒœìƒìƒ¤ìƒ¥ìƒ¨ìƒ¬ìƒ´ìƒµìƒ·ìƒ¹ì„€ì„„ì„ˆì„ì„•ì„œì„ì„ì„Ÿì„ ì„£ì„¤ì„¦ì„§ì„¬ì„­ì„¯ì„°ì„±ì„¶ì„¸ì„¹ì„¼ì…€ì…ˆì…‰ì…‹ì…Œì…ì…”ì…•ì…˜ì…œì…¤ì…¥ì…§ì…¨ì…©ì…°ì…´ì…¸ì†…ì†Œì†ì†ì†ì†”ì†–ì†œì†ì†Ÿì†¡ì†¥ì†¨ì†©ì†¬ì†°ì†½ì‡„ì‡ˆì‡Œì‡”ì‡—ì‡˜ì‡ ì‡¤ì‡¨ì‡°ì‡±ì‡³ì‡¼ì‡½ìˆ€ìˆ„ìˆŒìˆìˆìˆ‘ìˆ˜ìˆ™ìˆœìˆŸìˆ ìˆ¨ìˆ©ìˆ«ìˆ­ìˆ¯ìˆ±ìˆ²ìˆ´ì‰ˆì‰ì‰‘ì‰”ì‰˜ì‰ ì‰¥ì‰¬ì‰­ì‰°ì‰´ì‰¼ì‰½ì‰¿ìŠìŠˆìŠ‰ìŠìŠ˜ìŠ›ìŠìŠ¤ìŠ¥ìŠ¨ìŠ¬ìŠ­ìŠ´ìŠµìŠ·ìŠ¹ì‹œì‹ì‹ ì‹£ì‹¤ì‹«ì‹¬ì‹­ì‹¯ì‹±ì‹¶ì‹¸ì‹¹ì‹»ì‹¼ìŒ€ìŒˆìŒ‰ìŒŒìŒìŒ“ìŒ”ìŒ•ìŒ˜ìŒœìŒ¤ìŒ¥ìŒ¨ìŒ©ì…ì¨ì©ì¬ì°ì²ì¸ì¹ì¼ì½ì„ìˆìŒì€ì˜ì™ìœìŸì ì¢ì¨ì©ì­ì´ìµì¸ìˆìì¤ì¬ì°ì´ì¼ì½ì‘ˆì‘¤ì‘¥ì‘¨ì‘¬ì‘´ì‘µì‘¹ì’€ì’”ì’œì’¸ì’¼ì“©ì“°ì“±ì“´ì“¸ì“ºì“¿ì”€ì”ì”Œì”ì””ì”œì”¨ì”©ì”¬ì”°ì”¸ì”¹ì”»ì”½ì•„ì•…ì•ˆì•‰ì•Šì•Œì•ì•ì•“ì•”ì••ì•—ì•˜ì•™ì•ì•ì• ì•¡ì•¤ì•¨ì•°ì•±ì•³ì•´ì•µì•¼ì•½ì–€ì–„ì–‡ì–Œì–ì–ì–‘ì–•ì–—ì–˜ì–œì– ì–©ì–´ì–µì–¸ì–¹ì–»ì–¼ì–½ì–¾ì—„ì—…ì—†ì—‡ì—ˆì—‰ì—Šì—Œì—ì—ì—‘ì—”ì—˜ì— ì—¡ì—£ì—¥ì—¬ì—­ì—®ì—°ì—´ì—¶ì—·ì—¼ì—½ì—¾ì—¿ì˜€ì˜ì˜…ì˜†ì˜‡ì˜ˆì˜Œì˜ì˜˜ì˜™ì˜›ì˜œì˜¤ì˜¥ì˜¨ì˜¬ì˜­ì˜®ì˜°ì˜³ì˜´ì˜µì˜·ì˜¹ì˜»ì™€ì™ì™„ì™ˆì™ì™‘ì™“ì™”ì™•ì™œì™ì™ ì™¬ì™¯ì™±ì™¸ì™¹ì™¼ìš€ìšˆìš‰ìš‹ìšìš”ìš•ìš˜ìšœìš¤ìš¥ìš§ìš©ìš°ìš±ìš´ìš¸ìš¹ìšºì›€ì›ì›ƒì›…ì›Œì›ì›ì›”ì›œì›ì› ì›¡ì›¨ì›©ì›¬ì›°ì›¸ì›¹ì›½ìœ„ìœ…ìœˆìœŒìœ”ìœ•ìœ—ìœ™ìœ ìœ¡ìœ¤ìœ¨ìœ°ìœ±ìœ³ìœµìœ·ìœ¼ìœ½ì€ì„ìŠìŒììì‘ì’ì“ì”ì•ì–ì—ì˜ìœì ì¨ì«ì´ìµì¸ì¼ì½ì¾ìƒì„ì…ì‡ìˆì‰ìŠììì‘ì”ì–ì—ì˜ìšì ì¡ì£ì¤ì¥ì¦ì¬ì­ì°ì´ì¼ì½ì¿ìŸ€ìŸìŸˆìŸ‰ìŸŒìŸìŸìŸ˜ìŸìŸ¤ìŸ¨ìŸ¬ì €ì ì „ì ˆì Šì ì ‘ì “ì •ì –ì œì ì  ì ¤ì ¬ì ­ì ¯ì ±ì ¸ì ¼ì¡€ì¡ˆì¡‰ì¡Œì¡ì¡”ì¡°ì¡±ì¡´ì¡¸ì¡ºì¢€ì¢ì¢ƒì¢…ì¢†ì¢‡ì¢‹ì¢Œì¢ì¢”ì¢ì¢Ÿì¢¡ì¢¨ì¢¼ì¢½ì£„ì£ˆì£Œì£”ì£•ì£—ì£™ì£ ì£¡ì£¤ì£µì£¼ì£½ì¤€ì¤„ì¤…ì¤†ì¤Œì¤ì¤ì¤‘ì¤˜ì¤¬ì¤´ì¥ì¥‘ì¥”ì¥˜ì¥ ì¥¡ì¥£ì¥¬ì¥°ì¥´ì¥¼ì¦ˆì¦‰ì¦Œì¦ì¦˜ì¦™ì¦›ì¦ì§€ì§ì§„ì§‡ì§ˆì§Šì§ì§‘ì§“ì§•ì§–ì§™ì§šì§œì§ì§ ì§¢ì§¤ì§§ì§¬ì§­ì§¯ì§°ì§±ì§¸ì§¹ì§¼ì¨€ì¨ˆì¨‰ì¨‹ì¨Œì¨ì¨”ì¨˜ì¨©ì©Œì©ì©ì©”ì©œì©ì©Ÿì© ì©¡ì©¨ì©½ìª„ìª˜ìª¼ìª½ì«€ì«„ì«Œì«ì«ì«‘ì«“ì«˜ì«™ì« ì«¬ì«´ì¬ˆì¬ì¬”ì¬˜ì¬ ì¬¡ì­ì­ˆì­‰ì­Œì­ì­˜ì­™ì­ì­¤ì­¸ì­¹ì®œì®¸ì¯”ì¯¤ì¯§ì¯©ì°Œì°ì°ì°”ì°œì°ì°¡ì°¢ì°§ì°¨ì°©ì°¬ì°®ì°°ì°¸ì°¹ì°»ì°¼ì°½ì°¾ì±„ì±…ì±ˆì±Œì±”ì±•ì±—ì±˜ì±™ì± ì±¤ì±¦ì±¨ì±°ì±µì²˜ì²™ì²œì² ì²¨ì²©ì²«ì²¬ì²­ì²´ì²µì²¸ì²¼ì³„ì³…ì³‡ì³‰ì³ì³”ì³¤ì³¬ì³°ì´ì´ˆì´‰ì´Œì´ì´˜ì´™ì´›ì´ì´¤ì´¨ì´¬ì´¹ìµœìµ ìµ¤ìµ¬ìµ­ìµ¯ìµ±ìµ¸ì¶ˆì¶”ì¶•ì¶˜ì¶œì¶¤ì¶¥ì¶§ì¶©ì¶°ì·„ì·Œì·ì·¨ì·¬ì·°ì·¸ì·¹ì·»ì·½ì¸„ì¸ˆì¸Œì¸”ì¸™ì¸ ì¸¡ì¸¤ì¸¨ì¸°ì¸±ì¸³ì¸µì¹˜ì¹™ì¹œì¹Ÿì¹ ì¹¡ì¹¨ì¹©ì¹«ì¹­ì¹´ì¹µì¹¸ì¹¼ìº„ìº…ìº‡ìº‰ìºìº‘ìº”ìº˜ìº ìº¡ìº£ìº¤ìº¥ìº¬ìº­ì»ì»¤ì»¥ì»¨ì»«ì»¬ì»´ì»µì»·ì»¸ì»¹ì¼€ì¼ì¼„ì¼ˆì¼ì¼‘ì¼“ì¼•ì¼œì¼ ì¼¤ì¼¬ì¼­ì¼¯ì¼°ì¼±ì¼¸ì½”ì½•ì½˜ì½œì½¤ì½¥ì½§ì½©ì½°ì½±ì½´ì½¸ì¾€ì¾…ì¾Œì¾¡ì¾¨ì¾°ì¿„ì¿ ì¿¡ì¿¤ì¿¨ì¿°ì¿±ì¿³ì¿µì¿¼í€€í€„í€‘í€˜í€­í€´í€µí€¸í€¼í„í…í‡í‰íí”í˜í í¬í­í°í´í¼í½í‚í‚¤í‚¥í‚¨í‚¬í‚´í‚µí‚·í‚¹íƒ€íƒíƒ„íƒˆíƒ‰íƒíƒ‘íƒ“íƒ”íƒ•íƒœíƒíƒ íƒ¤íƒ¬íƒ­íƒ¯íƒ°íƒ±íƒ¸í„í„°í„±í„´í„¸í„ºí…€í…í…ƒí…„í……í…Œí…í…í…”í…œí…í…Ÿí…¡í…¨í…¬í…¼í†„í†ˆí† í†¡í†¤í†¨í†°í†±í†³í†µí†ºí†¼í‡€í‡˜í‡´í‡¸íˆ‡íˆ‰íˆíˆ¬íˆ­íˆ°íˆ´íˆ¼íˆ½íˆ¿í‰í‰ˆí‰œí‰¤íŠ€íŠíŠ„íŠˆíŠíŠ‘íŠ•íŠœíŠ íŠ¤íŠ¬íŠ±íŠ¸íŠ¹íŠ¼íŠ¿í‹€í‹‚í‹ˆí‹‰í‹‹í‹”í‹˜í‹œí‹¤í‹¥í‹°í‹±í‹´í‹¸íŒ€íŒíŒƒíŒ…íŒŒíŒíŒíŒíŒ”íŒ–íŒœíŒíŒŸíŒ íŒ¡íŒ¥íŒ¨íŒ©íŒ¬íŒ°íŒ¸íŒ¹íŒ»íŒ¼íŒ½í„í…í¼í½í€í„íŒíííí‘í˜í™íœí í¨í©í«í­í´í¸í¼í„í…íˆí‰íí˜í¡í£í¬í­í°í´í¼í½í¿ííˆíí‘€í‘„í‘œí‘ í‘¤í‘­í‘¯í‘¸í‘¹í‘¼í‘¿í’€í’‚í’ˆí’‰í’‹í’í’”í’©í“Œí“í“”í“œí“Ÿí“¨í“¬í“°í“¸í“»í“½í”„í”ˆí”Œí””í”•í”—í”¼í”½í•€í•„í•Œí•í•í•‘í•˜í•™í•œí• í•¥í•¨í•©í•«í•­í•´í•µí•¸í•¼í–„í–…í–‡í–ˆí–‰í–í–¥í—ˆí—‰í—Œí—í—’í—˜í—™í—›í—í—¤í—¥í—¨í—¬í—´í—µí—·í—¹í˜€í˜í˜„í˜ˆí˜í˜‘í˜“í˜”í˜•í˜œí˜ í˜¤í˜­í˜¸í˜¹í˜¼í™€í™…í™ˆí™‰í™‹í™í™‘í™”í™•í™˜í™œí™§í™©í™°í™±í™´íšƒíš…íšŒíšíšíš”íšíšŸíš¡íš¨íš¬íš°íš¹íš»í›„í›…í›ˆí›Œí›‘í›”í›—í›™í› í›¤í›¨í›°í›µí›¼í›½íœ€íœ„íœ‘íœ˜íœ™íœœíœ íœ¨íœ©íœ«íœ­íœ´íœµíœ¸íœ¼í„í‡í‰íí‘í”í–í—í˜í™í í¡í£í¥í©í¬í°í´í¼í½ííˆí‰íŒíí˜í™í›í";
    return ksx1001.indexOf(letter) >= 0;
}
function isRandom() {
    return document.querySelector("#random").checked;
}
function isExtend() {
    return document.querySelector("#extend").checked;
}

function add_string(string){
    if(document.getElementById('add_vvv').checked) string.unshift(add_vvv_text.value);
    if(document.getElementById('add_ar').checked) string.push(add_ar_text.value);
        return string;
}

function hangulInitialConsonants() {
    if (!stopped) stop.click();
    var consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…","ã„²","ã„¸","ã…ƒ","ã…†","ã…‰"];
    var vowels = ["ã…","ã…‘","ã…“","ã…•"];
    if (isExtend()) vowels = vowels.concat(["ã…—","ã…›","ã…œ","ã… ","ã…¡","ã…£","ã…”","ã…"]);
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 2 : 5); i++) {
        for (var v of vowels) {
            var syllables = [];
            for (var c of consonants) {
                var letter = Hangul.a([c, v]);
                if (isKSX1001(letter)) syllables.push(letter);
            }
            if (isRandom()) syllables.sort(() => Math.random() - 0.5);
            repeated = repeated.concat(syllables);
        }
    }
    repeated = repeated.flatMap(code => Array(getRepeatCount()).fill(code));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulSimpleVowels() {
    if (!stopped) stop.click();

    var consonants = ["ã…‡"];
    if (isExtend()) consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    var vowels = ["ã…","ã…‘","ã…“","ã…•","ã…—","ã…›","ã…œ","ã… ","ã…¡","ã…£","ã…”","ã…"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 3 : 30); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                var letter = Hangul.a([c, v]);
                if (isKSX1001(letter)) syllables.push(letter);
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
    }
    repeated = repeated.flatMap(code => Array(getRepeatCount()).fill(code));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulSimpleSyllables() {
    if (!stopped) stop.click();

    var consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) consonants = consonants.concat(["ã„²","ã„¸","ã…ƒ","ã…†","ã…‰"]);
    var vowels = ["ã…","ã…‘","ã…“","ã…•","ã…—","ã…›","ã…œ","ã… ","ã…¡","ã…£","ã…”","ã…"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 2 : 3); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                var letter = Hangul.a([c, v]);
                if (isKSX1001(letter)) syllables.push(letter);
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
    }
    repeated = repeated.flatMap(code => Array(getRepeatCount()).fill(code));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulFinalConsonants() {
    if (!stopped) stop.click();

    var consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡"];
    var vowels = ["ã…","ã…‘","ã…“","ã…•","ã…¡","ã…£","ã…”","ã…"];
    var finals = ["ã„±","ã„²","ã„³","ã„´","ã„µ","ã„¶","ã„·","ã„¹","ã„º","ã„»","ã„¼","ã„½","ã„¾","ã„¿","ã…€","ã…","ã…‚","ã…„","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 1 : 1); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                for (var f of finals) {
                    var letter = Hangul.a([c, v, f]);
                    if (isKSX1001(letter)) syllables.push(letter);
                }
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
    }
    repeated = repeated.flatMap(code => Array(getRepeatCount()).fill(code));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulSyllables() {
    if (!stopped) stop.click();

    var consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) consonants = consonants.concat(["ã„²","ã„¸","ã…ƒ","ã…†","ã…‰"]);
    var vowels = ["ã…","ã…‘","ã…“","ã…•","ã…—","ã…›","ã…œ","ã… ","ã…¡","ã…£","ã…”","ã…"];
    var finals = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) finals = ["ã„±","ã„²","ã„³","ã„´","ã„µ","ã„¶","ã„·","ã„¹","ã„º","ã„»","ã„¼","ã„½","ã„¾","ã„¿","ã…€","ã…","ã…‚","ã…„","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 1 : 1); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                for (var f of finals) {
                    var letter = Hangul.a([c, v, f]);
                    if (isKSX1001(letter)) syllables.push(letter);
                }
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
    }
    repeated = repeated.flatMap(code => Array(getRepeatCount()).fill(code));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulComplexVowels() {
    if (!stopped) stop.click();

    var consonants = ["ã…‡"];
    if (isExtend()) consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    var vowels = ["ã…’","ã…–","ã…˜","ã…™","ã…š","ã…","ã…","ã…Ÿ","ã…¢"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 3 : 30); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                var letter = Hangul.a([c, v]);
                if (isKSX1001(letter)) syllables.push(letter);
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
    }
    repeated = repeated.flatMap(item => Array(getRepeatCount()).fill(item));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulComplexSyllables() {
    if (!stopped) stop.click();

    var consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) consonants = consonants.concat(["ã„²","ã„¸","ã…ƒ","ã…†","ã…‰"]);
    var vowels = ["ã…’","ã…–","ã…˜","ã…™","ã…š","ã…","ã…","ã…Ÿ","ã…¢"];
    var finals = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) finals = ["ã„±","ã„²","ã„³","ã„´","ã„µ","ã„¶","ã„·","ã„¹","ã„º","ã„»","ã„¼","ã„½","ã„¾","ã„¿","ã…€","ã…","ã…‚","ã…„","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 1 : 1); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                for (var f of finals) {
                    var letter = Hangul.a([c, v, f]);
                    if (isKSX1001(letter)) syllables.push(letter);
                }
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
    }
    repeated = repeated.flatMap(item => Array(getRepeatCount()).fill(item));
    add_string(repeated);
    changeQsoSample(repeated.join(space_add()));
}
function hangulRandomSyllables() {
    if (!stopped) stop.click();

    var consonants = ["ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) consonants = consonants.concat(["ã„²","ã„¸","ã…ƒ","ã…†","ã…‰"]);
    var vowels = ["ã…","ã…‘","ã…“","ã…•","ã…—","ã…›","ã…œ","ã… ","ã…¡","ã…£","ã…”","ã…"];
    if (isExtend()) vowels = vowels.concat(["ã…’","ã…–","ã…˜","ã…™","ã…š","ã…","ã…","ã…Ÿ","ã…¢"]);
    var finals = ["","ã„±","ã„´","ã„·","ã„¹","ã…","ã…‚","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    if (isExtend()) finals = ["","ã„±","ã„²","ã„³","ã„´","ã„µ","ã„¶","ã„·","ã„¹","ã„º","ã„»","ã„¼","ã„½","ã„¾","ã„¿","ã…€","ã…","ã…‚","ã…„","ã……","ã…†","ã…‡","ã…ˆ","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
    var repeated = [];
    for (var i = 0; i < (isExtend() ? 1 : 1); i++) {
        var syllables = [];
        for (var c of consonants) {
            for (var v of vowels) {
                for (var f of finals) {
                    var letter = Hangul.a([c, v, f]);
                    if (isKSX1001(letter)) syllables.push(letter);
                }
            }
        }
        if (isRandom()) syllables.sort(() => Math.random() - 0.5);
        repeated = repeated.concat(syllables);
        repeated = array_shuffle(repeated)
    }
    repeated = repeated.flatMap(item => Array(getRepeatCount()).fill(item));
    add_string(repeated);
    var data = repeated.join(space_add());
    changeQsoSample(data);
}
function hangulFrequentSyllables() {
    if (!stopped) stop.click();
    var SYLLABLES = ["ê°€","ê²Œ","ê°€","ê²©","ê°€","êµ¬","ê°€","ë°©","ê°€","ìˆ˜","ê°€","ìŠ´","ê°€","ìš”","ê°€","ìœ„","ê°€","ì„","ê°€","ì¡±","ê°„","ì‹","ê°„","ì¥","ê°ˆ","ë¹„","ê°ˆ","ìƒ‰","ê°","ê¸°","ê°","ë™","ê°","ì","ê°œ","ì¸","ê±°","ê¸°","ê±°","ë¦¬","ê±°","ì‹¤","ê±°","ìš¸","ê±´","ë¬¼","ê²Œ","ì„","ê²¨","ìš¸","ê²°","ê³¼","ê²½","ê¸°","ê²½","ì£¼","ê²½","ì°°","ê²½","ì¹˜","ê²½","í—˜","ê³„","ë‹¨","ê³„","ë€","ê³„","ì ˆ","ê³„","íš","ê³ ","ê¸°","ê³ ","ëª¨","ê³ ","ì¥","ê³ ","ì¶”","ê³ ","í–¥","ê³¨","ëª©","ê³¨","í”„","ê³µ","ê°„","ê³µ","ê¸°","ê³µ","ì—°","ê³µ","ì›","ê³µ","ì§œ","ê³µ","ì±…","ê³µ","í•­","ê³¼","ê±°","ê³¼","ì¼","ê³¼","ì","ê³¼","í•™","ê´€","ê³„","ê´€","ì‹¬","ê´‘","ê³ ","êµ","ìˆ˜","êµ","ì‹¤","êµ","í†µ","êµ","íšŒ","êµ¬","ë‘","êµ¬","ë¦„","êµ¬","ì›”","êµ­","ë‚´","êµ­","ë¦½","êµ­","ìˆ˜","êµ­","ì–´","êµ­","ì ","êµ­","ì œ","êµ°","ì¸","ê·œ","ì¹™","ê·¸","ê±°","ê·¸","ê²ƒ","ê·¸","ê³³","ê·¸","ë‚ ","ê·¸","ë•Œ","ê·¸","ë¨","ê·¸","ë¦‡","ê·¸","ë¦¼","ê·¸","ë¶„","ê·¸","ìª½","ê·¹","ì¥","ê·¼","ì²˜","ê¸ˆ","ì—°","ê¸°","ê°„","ê¸°","ë¦„","ê¸°","ë¶„","ê¸°","ì‚¬","ê¸°","ì‚¬","ê¸°","ì˜¨","ê¸°","ì","ê¸°","ì°¨","ê¸°","ì¹¨","ê¸°","íƒ€","ê¹€","ë°¥","ê¹€","ì¹˜","ê½ƒ","ì§‘","ë‚˜","ë¼","ë‚˜","ë¬´","ë‚˜","ì´","ë‚˜","ì¤‘","ë‚˜","í˜","ë‚š","ì‹œ","ë‚ ","ì”¨","ë‚ ","ì§œ","ë‚¨","ë…€","ë‚¨","ë¯¸","ë‚¨","ì‚°","ë‚¨","ì","ë‚¨","ìª½","ë‚¨","í¸","ë‚´","ê³¼","ë‚´","ë…„","ë‚´","ìš©","ë‚´","ì¼","ëƒ„","ë¹„","ëƒ„","ìƒˆ","ëƒ‰","ë©´","ë…¸","ë˜","ë…¸","íŠ¸","ë…¹","ìƒ‰","ë…¹","ì°¨","ë†","êµ¬","ëˆ„","êµ¬","ëˆ„","ë‚˜","ëˆˆ","ë¬¼","ë‰´","ìŠ¤","ë‰´","ìš•","ëŠ","ë‚Œ","ëŠ¥","ë ¥","ë‹¤","ë¦¬","ë‹¤","ë¦¬","ë‹¤","ìŒ","ë‹¨","ì–´","ë‹¨","ì ","ë‹¬","ëŸ¬","ë‹¬","ë ¥","ë‹´","ë°°","ë‹µ","ì¥","ë‹¹","ê·¼","ë‹¹","ì‹ ","ëŒ€","í•™","ëŒ€","í™”","ëŒ€","íšŒ","ë•","ë¶„","ë„","ë¡œ","ë„","ì‹œ","ë„","ì›€","ë„","ì¿„","ë…","ì„œ","ë…","ì¼","ë™","ë„¤","ë™","ë¬¼","ë™","ìƒ","ë™","ì•ˆ","ë™","ì–‘","ë™","ì „","ë™","ìª½","ë¼","ì§€","ëœ","ì¥","ë‘","ë¶€","ë“£","ê¸°","ë“±","ì‚°","ë”¸","ê¸°","ë–¡","êµ­","ë¼","ë©´","ë¡œ","ì…˜","ë§ˆ","ëŠ˜","ë§ˆ","ìŒ","ë§Œ","ë‘","ë§Œ","í™”","ë§¤","ì¼","ë§¤","ì£¼","ë§¥","ì£¼","ë¨¸","ë¦¬","ë¨¸","ë¦¬","ë©”","ë‰´","ë©”","ëª¨","ë©°","ì¹ ","ë©´","ë„","ëª…","ì ˆ","ëª¨","ì–‘","ëª¨","ì„","ëª¨","ì","ëª©","ì ","ëª¸","ì‚´","ëª½","ê³¨","ë¬´","ë£Œ","ë¬´","ë¦","ë¬´","ì—‡","ë¬´","ì—­","ë¬´","ìš©","ë¬¸","ì¥","ë¬¸","ì œ","ë¬¸","í™”","ë¬¼","ê±´","ë¯¸","êµ­","ë¯¸","ë˜","ë¯¸","ìˆ ","ë°”","ë‹¤","ë°”","ëŒ","ë°”","ì§€","ë°•","ìˆ˜","ë°˜","ì§€","ë°˜","ì°¬","ë°œ","ìŒ","ë°œ","í‘œ","ë°©","ë²•","ë°©","ì†¡","ë°©","í•™","ë°°","êµ¬","ë°°","ë‹¬","ë°°","ìš°","ë°°","íƒˆ","ë²„","ìŠ¤","ë²ˆ","í˜¸","ë²š","ê½ƒ","ë³‘","ì›","ë³¼","íœ","ë´‰","ì§€","ë´‰","íˆ¬","ë¶€","ëª¨","ë¶€","ë¶€","ë¶€","ì‚°","ë¶€","ì—Œ","ë¶€","ì¸","ë¶€","íƒ","ë¶","ìª½","ë¹„","ëˆ„","ë¹„","ë°€","ë¹Œ","ë”©","ë¹¨","ë˜","ë¹µ","ì§‘","ì‚¬","ê³ ","ì‚¬","ê³¼","ì‚¬","ëŒ","ì‚¬","ë¬¼","ì‚¬","ì›","ì‚¬","ì›”","ì‚¬","ì´","ì‚¬","ì¥","ì‚¬","ì „","ì‚¬","ì§„","ì‚¬","ì´Œ","ì‚¬","íƒ•","ì‚¬","í˜","ì‚°","ì±…","ì‚¼","ì›”","ì‚¼","ì´Œ","ìƒ","ì","ìƒ","ì²˜","ìƒ","í’ˆ","ìƒˆ","ë²½","ìƒˆ","ìš°","ìƒ‰","ê¹”","ìƒ","ì„ ","ìƒ","ì‹ ","ìƒ","ì¼","ìƒ","í™œ","ìƒ´","í‘¸","ì„œ","ë¥˜","ì„œ","ì–‘","ì„œ","ìš¸","ì„œ","ì ","ì„œ","ìª½","ì„ ","ë°°","ì„ ","ìˆ˜","ì„¤","ë‚ ","ì„¤","íƒ•","ì„±","ê²©","ì„±","í•¨","ì„¸","ê³„","ì„¼","í„°","ì†Œ","ë¦¬","ì†Œ","ì„¤","ì†Œ","ì‹","ì†Œ","íŒŒ","ì†Œ","í¬","ì†Œ","í’","ì†","ë‹˜","ì†¡","ì´","ìˆ˜","ê±´","ìˆ˜","ë„","ìˆ˜","ë°•","ìˆ˜","ì—…","ìˆ˜","ì˜","ìˆ˜","ì €","ìˆ˜","ì²©","ìˆ˜","í•™","ìˆ™","ì œ","ìˆœ","ì„œ","ìŠ¤","í‚¤","ìŠµ","ê´€","ì‹œ","ê°„","ì‹œ","ê³„","ì‹œ","ê³¨","ì‹œ","ë‚´","ì‹œ","ë””","ì‹œ","ë¯¼","ì‹œ","ì„¤","ì‹œ","ì™¸","ì‹œ","ì›”","ì‹œ","ì‘","ì‹œ","ì¥","ì‹œ","ì²­","ì‹œ","í—˜","ì‹","ë‹¹","ì‹","ì‚¬","ì‹","íƒ","ì‹ ","ë¬¸","ì‹ ","ë°œ","ì‹¤","ìˆ˜","ì“°","ê¸°","ì•„","ê¸°","ì•„","ë‚´","ì•„","ë“¤","ì•„","ë˜","ì•„","ë¹ ","ì•„","ì´","ì•„","ì¹¨","ì•„","ì¹¨","ì•…","ê¸°","ì•ˆ","ê²½","ì•¼","êµ¬","ì•¼","ì±„","ì•½","êµ­","ì•½","ì‚¬","ì•½","ì†","ì–‘","ë§","ì–‘","ë³µ","ì–‘","ì‹","ì–‘","íŒŒ","ì–´","ê¹¨","ì–´","ë””","ì–´","ë¥¸","ì–¸","ë‹ˆ","ì–¼","êµ´","ì–¼","ë§ˆ","ì–¼","ìŒ","ì—„","ë§ˆ","ì—¬","ê¶Œ","ì—¬","ê¸°","ì—¬","ë¦„","ì—¬","ì","ì—¬","í–‰","ì—­","ì‚¬","ì—°","ì„¸","ì—°","í•„","ì—°","íœ´","ì—´","ì‡ ","ì—´","ì°¨","ì—½","ì„œ","ì˜","êµ­","ì˜","ìƒ","ì˜","ì–´","ì˜","í•˜","ì˜","í™”","ì˜ˆ","ì•½","ì˜›","ë‚ ","ì˜¤","ë¦¬","ì˜¤","ë¹ ","ì˜¤","ì›”","ì˜¤","ì´","ì˜¤","ì „","ì˜¤","í›„","ì˜¬","í•´","ì˜·","ì¥","ì™¸","êµ­","ì™¼","ìª½","ìš”","ê¸ˆ","ìš”","ë¦¬","ìš”","ì¼","ìš”","ì¦˜","ìš°","ë¦¬","ìš°","ì‚°","ìš°","ìœ ","ìš°","í‘œ","ì›”","ê¸‰","ì›”","ì„¸","ì›¬","ì¼","ìœ„","ì¹˜","ìœ ","ëŸ½","ìœ ","ë¦¬","ìœ ","ì›”","ìœ ","í•™","ìœ ","í–‰","ì€","í–‰","ìŒ","ì‹","ìŒ","ì•…","ì˜","ë¯¸","ì˜","ì‚¬","ì˜","ì","ì´","ê±°","ì´","ê²ƒ","ì´","ê³³","ì´","ë¦„","ì´","ëª¨","ì´","ë²ˆ","ì´","ë¶„","ì´","ì‚¬","ì´","ì›”","ì´","ìœ ","ì´","ìª½","ì´","í‹€","ì¸","êµ¬","ì¸","ê¸°","ì¸","ë„","ì¸","ì‚¼","ì¸","ìƒ","ì¸","ì²œ","ì¸","í˜•","ì¼","ê¸°","ì¼","ë³¸","ì¼","ì‹","ì¼","ì›”","ì½","ê¸°","ì…","êµ¬","ì…","í•™","ì","ê¸°","ì","ë£Œ","ì","ë¦¬","ì","ì‹ ","ì","ì—°","ì","ìœ ","ì‘","ë…„","ì”","ì¹˜","ì¡","ì§€","ì¥","ê°‘","ì¥","ë§ˆ","ì¥","ë¯¸","ì¥","ì†Œ","ì¥","ì ","ì¬","ë£Œ","ì¬","í‚·","ì €","ê±°","ì €","ê²ƒ","ì €","ê³³","ì €","ê¸°","ì €","ë…","ì €","ë…","ì €","ë¶„","ì €","ìª½","ì €","í¬","ì „","ê³µ","ì „","í™”","ì ","ìˆ˜","ì ","ì‹¬","ì ","ì‹¬","ì ","ì›","ì ","í¼","ì •","ë„","ì •","ë¬¸","ì •","ë³´","ì œ","ëª©","ì œ","ì¼","ì¡°","ì¹´","ì¢…","ë¡œ","ì¢…","ë¥˜","ì¢…","ì´","ì¢…","ì¼","ì£¼","ë§","ì£¼","ë³€","ì£¼","ë¶€","ì£¼","ì‚¬","ì£¼","ì†Œ","ì£¼","ìŠ¤","ì£¼","ìœ„","ì£¼","ì¸","ì¤‘","êµ­","ì¤‘","ì‹","ì¤‘","ì‹¬","ì¦","ì„¸","ì§€","ê°‘","ì§€","ë„","ì§€","ë°©","ì§€","í•˜","ì§","ì—…","ì§","ì›","ì§","ì¥","ì°Œ","ê°œ","ì°½","ë¬¸","ì±„","ì†Œ","ì±…","ìƒ","ì±…","ì¥","ì²˜","ìŒ","ìµœ","ê³ ","ì¶”","ì„","ì¶”","ì–µ","ì¶•","êµ¬","ì¶•","ì œ","ì¶œ","êµ¬","ì¶œ","ì¥","ì·¨","ë¯¸","ì¹˜","ê³¼","ì¹˜","ë§ˆ","ì¹˜","ì•½","ì¹œ","êµ¬","ì¹œ","ì²™","ì¹ ","ì›”","ì¹ ","íŒ","ì¹¨","ëŒ€","ì¹«","ì†”","ì¹´","ë“œ","ì¹´","ë ˆ","ì¹´","í˜","ì»¤","í”¼","ì½”","íŠ¸","ì½”","í”¼","ì½œ","ë¼","ì½§","ë¬¼","í¬","ê¸°","íƒ","êµ¬","íƒœ","êµ­","íƒœ","í’","íƒ","ì‹œ","í†µ","ì¥","íŠ¹","ì§•","íŒŒ","í‹°","íŒ”","ì›”","íŒ¨","ì…˜","í¸","ì§€","í‰","ì¼","í¬","ë„","í¬","ì¥","í‘œ","í˜„","í”¼","ì","í•„","ë¦„","í•„","í†µ","í•˜","ëŠ˜","í•˜","ë£¨","í•˜","ìˆ™","í•™","êµ","í•™","ê¸°","í•™","ë…„","í•™","ìƒ","í•™","ì›","í•œ","ê°•","í•œ","êµ­","í•œ","ê¸€","í•œ","ë²ˆ","í•œ","ë³µ","í•œ","ì‹","í•œ","ì","í• ","ì¸","í•©","ê²©","í•´","ì™¸","í–‡","ë¹›","í–‰","ë³µ","í–‰","ì‚¬","í—ˆ","ë¦¬","í˜„","ê¸ˆ","í˜„","ì¬","í˜•","ì œ","í˜¸","ì£¼","í˜¸","í…”","í˜¼","ì","í™","ì°¨","í™”","ê°€","í™˜","ì","íšŒ","ì‚¬","íšŒ","ìƒ‰","íšŒ","ì˜","í›„","ë°°","íœ´","ê°€","íœ´","ì¼","íœ´","ì§€","í°","ìƒ‰"];
    SYLLABLES = SYLLABLES.flatMap(item => Array(getRepeatCount()).fill(item));
    add_string(SYLLABLES);
    var data = SYLLABLES.join(space_add());
    changeQsoSample(data);
}
function textarea_change(qso_name){
if (!stopped) stop.click();

var hangul_qso_1_caption = "â€» QSO Sample from : <a href='https://hl5ky.tistory.com/105' target='_blank'>https://hl5ky.tistory.com/105</a>";
var hangul_qso_1 = (`CQ CQ CQ DE HL5KY HL5KY <AR> K

HL5KY DE DS1ABC DS1ABC K

DS1ABC DE HL5KY TNX FER CALL UR RST IS 599 5NN VY GUD <BT> NAME IS JOE JOE QTH IS BUSAN BUSAN HW? DS1ABC DE HL5KY K

HL5KY DE DS1ABC <KA> ì¡°ì˜¤ì— ë‹˜ ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ? <BT> ì‹ í˜¸ëŠ” ì—­ì‹œ 599 5NNìœ¼ë¡œ ì˜ ë“¤ì–´ì˜µë‹ˆë‹¤. ì €ì˜ ì´ë¦„ì€ í™ê¸¸ë™ í™ê¸¸ë™ì´ë©° ì„œìš¸ ì„œìš¸ì— ì‚´ê³  ìˆìŠµë‹ˆë‹¤ <KA> HL5KY DE DS1ABC K

DS1ABC DE HL5KY <KA> ì˜ˆ í™ê¸¸ë™ë‹˜ ë°˜ê°‘ìŠµë‹ˆë‹¤ <BT> ì €ì˜ ì´ë¦„ì€ ì¡°ìœ¤ì¬ ì¡°ìœ¤ì¬ì…ë‹ˆë‹¤. í•œê¸€ë¡œ êµì‹ í•˜ê²Œ ë˜ë‹ˆ ì•„ì£¼ ì¢‹ìŠµë‹ˆë‹¤ ì¢…ì¢… ëµ™ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤ <AR> DS1ABC DE HL5KY <KN>

HL5KY DE DS1ABC <KA> ì˜ˆ ì¡°ì˜¤ì— ë‹˜ ì²« êµì‹  ëŒ€ë‹¨íˆ ê°ì‚¬í•©ë‹ˆë‹¤ <BT> ë‹¤ìŒì— ë˜ ëµ™ê² ìŠµë‹ˆë‹¤. ì•ˆë…•íˆ ê³„ì‹­ì‹œì˜¤ <AR> HL5KY DE DS1ABC 73 TU <SK> E E

TNX QSO 73 TU <SK> E E

TU E E`);

var hangul_qso_2_caption = "â€» QSO Sample from : <a href='https://hl5ky.tistory.com/106' target='_blank'>https://hl5ky.tistory.com/106</a>";
var hangul_qso_2 = (`CQ CQ CQ DE HL4LF HL4LF <AR>

HL4LF DE 6K5EIA 6K5EIA <KN>

6K5EIA DE HL4LF <KA> ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ ë°˜ê°‘ìŠµë‹ˆë‹¤. ê·€êµ­ì˜ ì‹ í˜¸ëŠ” 599 5NNìœ¼ë¡œ ì˜ ìˆ˜ì‹ ë©ë‹ˆë‹¤. ì´ê³³ì€ ì—¬ìˆ˜ ì—¬ìˆ˜ì…ë‹ˆë‹¤. ì €ì˜ ì´ë¦„ì€ ì •ê²½ì²  ì •ê²½ì² ì…ë‹ˆë‹¤. <AR> 6K5EIA DE HL4LF <KN>

HL4LF DE 6K5EIA <KA> ì˜ˆ ì •ì˜¤ì— ë‹˜ ì´ë ‡ê²Œ ëµ™ê²Œ ë˜ì–´ ë°˜ê°‘ìŠµë‹ˆë‹¤. ì‹ í˜¸ëŠ” 579 57Nìœ¼ë¡œ ë“¤ì–´ì˜µë‹ˆë‹¤ <BT> ì €ì˜ ì´ë¦„ì€ ì¥ì„ëŒ€ ì¥ì„ëŒ€ë¼ê³  í•˜ë©° ìš¸ì‚° ìš¸ì‚°ì— ì‚´ê³  ìˆìŠµë‹ˆë‹¤. ìš¸ì‚°ì˜ ë‚ ì”¨ëŠ” ì¡°ê¸ˆ íë¦¬ê³  ë¹—ë°©ìš¸ì´ ë–¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤. <KA> HL4LF DE 6K5EIA <KN>

6K5EIA DE HL4LF <KA> ì˜ˆ ì¥ì„ëŒ€ì˜¤ì— ë‹˜ ë°˜ê°‘ìŠµë‹ˆë‹¤ <BT> ë°©ê¸ˆ ì¼ë³¸ ì‹ í˜¸ê°€ ê°•í•˜ê²Œ ë“¤ì–´ì™€ì„œ ì¡°ê¸ˆ í˜¼ì‹ ì„ ë°›ì•˜ì§€ë§Œ ì˜ ìˆ˜ì‹ í•˜ì˜€ìŠµë‹ˆë‹¤. ì—¬ìˆ˜ë„ ì•„ì¹¨ì— ë¹„ê°€ ì™”ëŠ”ë° ì§€ê¸ˆì€ í–‡ì‚´ì´ ë¹„ì¹˜ê³  ìˆìŠµë‹ˆë‹¤. ê¸°ì˜¨ì€ ì•½ 20ë„ ì •ë„ì…ë‹ˆë‹¤ <AR> 6K5EIA DE HL4LF K

HL4LF DE 6K5EIA <KA> ì¼ë³¸ í˜¼ì‹ ì´ ìˆêµ°ìš”. ìš¸ì‚°ì—ì„œë„ ì¼ë³¸ ì‹ í˜¸ê°€ ì˜ ìˆ˜ì‹ ë˜ì–´ì„œ ìì£¼ í˜¼ì‹ ì„ ë°›ëŠ” í¸ì…ë‹ˆë‹¤. ì—¬ìˆ˜ëŠ” ë‚ ì´ ê°œì—ˆêµ°ìš”. ê·¸ëŸ¬ë©´ ì¢‹ì€ ì£¼ë§ ë³´ë‚´ì‹œê³  ë‹¤ìŒì— ë˜ ëµ™ê¸° ë°”ëë‹ˆë‹¤. ê±´ê°•í•˜ì„¸ìš” <AR> HL4LF DE 6K5EIA 73 <SK>

6K5EIA DE HL4LF <KA> ì˜ˆ ì˜ ì•Œê² ìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ êµì‹  ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ìì£¼ ì „ì‹ ì—ì„œ ëµ™ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì¦ê±°ìš´ ì£¼ë§ ë³´ë‚´ì‹­ì‹œì˜¤ 6K5EIA DE HL4LF 73 TU <SK> E E

TU <SK> E E

E E`);

var hangul_qso_3_caption = "â€» QSO Sample from : <a href='https://hl5ky.tistory.com/107' target='_blank'>https://hl5ky.tistory.com/107</a>";
var hangul_qso_3 = (`CQ CQ CQ DE HL2BCW HL2BCW K

HL2BCW DE HL5MP <KN>

HL5MP DE HL2BCW <KA> ì•„ì´êµ¬ ì´ì˜¤ì— ë‹˜ ì´ê±° ì–¼ë§ˆë§Œì…ë‹ˆê¹Œ?  ì¡°ì˜ë³´ ì¡°ì˜ë³´ì…ë‹ˆë‹¤. ì˜ ì§€ë‚´ì‹­ë‹ˆê¹Œ? ì‹ í˜¸ëŠ” 589 58Nìœ¼ë¡œ ì˜ ë“¤ì–´ì˜µë‹ˆë‹¤. ì €ëŠ” ì§€ê¸ˆ ì›ì£¼ ì›ì£¼ì— ì‚´ê³  ìˆìŠµë‹ˆë‹¤ <AR> HL5MP DE HL2BCW <KN>

HL2BCW DE HL5MP <KA> ì˜ˆ ì¡°ì˜¤ì—  ì˜¤ëœë§Œì…ë‹ˆë‹¤. ì‹ í˜¸ëŠ” 599 5NNì…ë‹ˆë‹¤. ì •ë§ ì˜¤ëœë§Œì´ë„¤ìš”. ì•„ë§ˆ ì–¼êµ´ ë³¸ ì§€ê°€ 20ë…„ì€ ë„˜ì—ˆì„ê²ë‹ˆë‹¤. ì €ëŠ” ë•ë¶„ì— ì˜ ì§€ë‚´ê³  ìˆìŠµë‹ˆë‹¤. ì˜¤ë˜ì „ì— í‡´ì§í•´ì„œ ì§€ê¸ˆì€ ì–‘ì‚° ì–‘ì‚°ì— ì‚´ê³  ìˆìŠµë‹ˆë‹¤. ìš”ì¦˜ì€ ì£¼ë¡œ ë‚šì‹œë¥¼ ë§ì´ ë‹¤ë‹ˆê³  ê±´ê°•ì„ ìœ„í•´ì„œ ìš´ë™ë„ ê¾¸ì¤€íˆ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë‹¨íŒŒ ìš´ìš©ì„ ë‹¤ì‹œ ì‹œì‘í•œ ì§€ëŠ” ì–¼ë§ˆ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë² ë€ë‹¤ì— ì¡°ê·¸ë§Œ ì•ˆí…Œë‚˜ë¥¼ ì„¤ì¹˜í•´ì„œ ìš´ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. HL2BCW DE HL5MP <KN>

HL5MP DE HL2BCW <KA> ê·¸ëŸ¬ì‹œêµ°ìš”. ì €ë„ ê³§ í‡´ì§ì„ ì•ë‘ê³  ìˆìŠµë‹ˆë‹¤. í‡´ì§í›„ì— ê³ í–¥ì— ê°ˆê¹Œ í•˜ëŠ” ìƒê°ë„ í•´ ë³´ì•˜ì§€ë§Œ ì˜¤ë«ë™ì•ˆ ê°ì§€ì—ì„œ ì§€ë‚´ë‹¤ë³´ë‹ˆ ê²°ì •ì´ ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ì €ë„ ë‹¤ë¥¸ ìª½ì— ê´€ì‹¬ì„ ë‘ê³  ìˆì–´ì„œ í–„í™œë™ì€ ë§ì´ í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìµœê·¼ì— ë‹¨íŒŒ ìƒíƒœê°€ ì¢‹ì•„ì¡Œë‹¤ê³  í•´ì„œ ìš”ì¦˜ì€ ê°€ë” ë¬´ì „ê¸°ì˜ ì „ì›ì„ ë„£ì–´ ë³´ê³  ìˆìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œ ì¢…ì¢… ëµ™ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. HL5MP DE HL2BCW <KN>

HL2BCW DE HL5MP <KA> ì˜ˆ ë‹¤ë“¤ ë‚˜ì´ê°€ ë“œë‹ˆ ì´ì „ì— ì¦ê¸°ë˜ ì·¨ë¯¸ë¡œ ëŒì•„ì˜¤ëŠ” ëª¨ì–‘ì…ë‹ˆë‹¤. ê¸°íšŒê°€ ë˜ë©´ ìŒì„± êµì‹ ë„ ê¸°ëŒ€í•˜ê² ìŠµë‹ˆë‹¤. ì¦ê±°ìš´ ì£¼ë§ ë³´ë‚´ì‹œê¸° ë°”ë¼ë©° ì´ë§Œ 73 <AR> HL2BCW DE HL5MP <KN>

R <BT> ì˜ˆ ìì£¼ ë‚˜ì˜¤ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. í•­ìƒ ê±´ê°•í•˜ì‹­ì‹œì˜¤ 73 <SK> E E

73 TU <SK> E E

E E`);

var hangul_qso_4_caption = "â€» QSO Sample from : <a href='https://www.youtube.com/watch?v=TkbhZqdAPdw' target='_blank'>https://www.youtube.com/watch?v=TkbhZqdAPdw</a>";
var hangul_qso_4 = (`HL2LKL DE HL1SB K

HL1SB DE HL2LKL <BT> <KA> ìœ  ì˜¤ì— ë‹˜ <BT> ì•ˆë…•í•˜ì„¸ìš”? ì‹ í˜¸ëŠ” 599 599 ì…ë‹ˆë‹¤. <AR> HL1SB DE HL2LKL K

HL2LKL DE HL1SB <BT> <KA> <KA> <BT> ì „ ì˜¤ì— ë‹˜ ë˜ ë§Œë‚˜ëµ™ê²Œ ë˜ì–´ ë°˜ê°‘ìŠµë‹ˆë‹¤, ì‹ í˜¸ ì—­ì‹œ 599 ì¢‹ìŠµë‹ˆë‹¤, ì§€ê¸ˆ ì €ì˜ ì¶œë ¥ì€ 20ì™€íŠ¸ 20ì™€íŠ¸ ì…ë‹ˆë‹¤, ê³µê°„ìƒíƒœê°€ ì¢‹ì•„ì„œ ì €ì¶œë ¥ì¸ë°ë„ ì‹ í˜¸ê°€ ì˜ ë“¤ì–´ê°€ëŠ” ê²ƒ ê°™ì•„ì„œ ë‹¤í–‰ì…ë‹ˆë‹¤. <AR> HL2LKL DE HL1SB K

HL1SB DE HL2LKL <BT> <KA> ì˜ˆ, ì˜¤ì— ë‹˜ ëª‡ì¼ë§Œì— ë§Œë‚˜ì„œ ë°˜ê°‘ìŠµë‹ˆë‹¤ <BT> ì˜ˆ, ì˜¤ëŠ˜ì€ ê³µê°„ìƒíƒœê°€ ì¢‹ì•„ì„œ <BT> ì € ì¶œë ¥ì¸ 20ì™“íŠ¸ë¡œ ì†¡ì‹ í•˜ì‹œëŠ” ë°ë„ <BT> ì•ˆì‚°ì— ì•„ì£¼ ê°•ë ¥í•˜ê²Œ ì‹ í˜¸ê°€ ë“¤ì–´ì˜µë‹ˆë‹¤ <BT> ì €ëŠ” í˜„ì¬ ì¶œë ¥ì´ ë°±ì™“íŠ¸ì…ë‹ˆë‹¤. <AR> HL1SB DE HL2LKL K

R HL2LKL DE HL1SB <BT> <KA> <BT> ì˜ˆ, ì „ ì˜¤ì— ë‹˜ ì˜ ìˆ˜ì‹ í–ˆìŠµë‹ˆë‹¤, ì˜¤ì— ë‹˜ ì‹ í˜¸ëŠ” ì–¸ì œë‚˜ ì´ê³³ì—ì„œ ì˜ ìˆ˜ì‹ ë˜ê³  ìˆìŠµë‹ˆë‹¤ HI HI <BT> ì œê°€ ì§€ê¸ˆ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì¥ë¹„ëŠ” ë©”ì¸ ì¥ë¹„ê°€ ì•„ë‹ˆê³ , í¬í„°ë¸”ìš© ì €ì¶œë ¥ ì¥ë¹„ë¼ì„œ, ìµœëŒ€ì¶œë ¥ì´ 20ì™“íŠ¸ë°–ì— ì•ˆ ë©ë‹ˆë‹¤, ì£¼ë¡œ ì´ ì¥ë¹„ë¥¼ ì „ì‹  êµì‹ ì— ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. <AR> HL2LKL DE HL1SB K

HL1SB DE HL2LKL <BT> <KA> ì˜ˆ, ì˜¤ì— ë‹˜ ë§ì”€ ì˜ ìˆ˜ì‹ í–ˆìŠµë‹ˆë‹¤ <BT> ì˜¤ì— ë‹˜ê»˜ì„œëŠ” ì•„ì£¼ ì˜ˆì „ ì¥ë¹„ë¥¼ ì‚¬ìš©í•˜ì‹œë„¤ìš” <BT> ì¶œë ¥ì´ ìµœëŒ€ê°€ 20ì™“íŠ¸ ì¥ë¹„ì´ì‹œë„¤ìš” <BT> ê·¸ëŸ¬ë‚˜ ìŒì§ˆë„ ì•„ì£¼ ì¢‹ìŠµë‹ˆë‹¤ <BT> ì˜ˆì „ ì¥ë¹„ë¥¼ ì‚¬ìš©í•˜ì‹œëŠ” ì˜¤ì— ë‹˜ì„ ë§Œë‚˜ë©´ ë¶€ëŸ½ìŠµë‹ˆë‹¤ <BT> ì €ëŠ” ì•„ì´ì½¤ IC7300 IC7300 ì¥ë¹„ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤ <BT> ì•ˆí…Œë‚˜ëŠ” ì‹­ì˜¤ì¸µ ì˜¥ìƒì— ë‹¤ì´í´ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤ <BT> ë‹¤í–‰íˆ ê´€ë¦¬ì‚¬ë¬´ì†Œì—ì„œ ìŠ¹ì¸í•˜ì—¬ì„œìš” <BT> ì•ˆí…Œë‚˜ëŠ” ì•ˆì‚° ì˜¤ì— ë‹˜ë“¤ì´ ì˜¤ì…”ì„œ ì„¤ì¹˜í•´ ì£¼ì—ˆìŠµë‹ˆë‹¤. <AR> HL1SB DE HL2LKL K

HL2LKL DE HL1SB <BT> <KA> <BT> ì˜ˆ, ì „ ì˜¤ì— ë‹˜ ì˜ ìˆ˜ì‹ í–ˆìŠµë‹ˆë‹¤, ì œ ì¥ë¹„ëŠ” ì˜›ë‚  ì¥ë¹„ëŠ” ì•„ë‹ˆê³ ìš”, ë¹„êµì  ìµœì‹  ì¥ë¹„ì´ê¸´ í•œë°, ì¤‘êµ­ì œ ì†Œí˜• SDR SDR ì¥ë¹„ì…ë‹ˆë‹¤, ì˜¤ì— ë‹˜ê»˜ì„œ ì‚¬ìš©í•˜ì‹œëŠ” ì¥ë¹„ë„ SDR ì¥ë¹„ì£  HI HI <BT> ì˜¤ì— ë‹˜ì˜ ì•ˆí…Œë‚˜ë„ 15ì¸µ ì˜¥ìƒì— ì„¤ì¹˜í•œ ë‹¤ì´í´ì´êµ°ìš”, ì €ë„ 15ì¸µ ì˜¥ìƒì— ì•ˆí…Œë‚˜ë¥¼ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤, ì‚¼ì ì˜¤ì™€ ì¹ ë©”ê°€ ìš© ë‹¤ì´í´ì…ë‹ˆë‹¤ HI HI <BT> ì „ ì˜¤ì— ë‹˜, ì˜¤ëŠ˜ ì´ë ‡ê²Œ ë˜ ë‹¤ì‹œ ë§Œë‚˜ì„œ ë¡±íì—ìŠ¤ì˜¤ í•˜ê²Œ ë˜ì–´ ì¦ê±°ì› ìŠµë‹ˆë‹¤, ë¬´ë”ìš´ ë‚ ì”¨ì— ë¬´íƒˆí•˜ê²Œ ê³„ì‹œê¸° ë°”ëë‹ˆë‹¤, ë‹¤ìŒì— ëµ ë•Œê¹Œì§€ ì•ˆë…•íˆ ê³„ì‹œê¸° ë°”ëë‹ˆë‹¤. <AR> HL2LKL DE HL1SB K

HL1SB DE HL2LKL <BT> <KA> ì˜ˆ, ì˜¤ì— ë‹˜ê»˜ì„œ ì‚¬ìš©í•˜ì‹œëŠ” ì¥ë¹„ëŠ” ìµœê·¼ ì¥ë¹„ì´ì‹œêµ°ìš” <BT> ì¤‘êµ­ì˜ SDR ì¥ë¹„ì´ì‹œë¼ê³  ìˆ˜ì‹ í•˜ì˜€ìŠµë‹ˆë‹¤ <BT> ì•ˆí…Œë‚˜ë„ 15ì¸µì— ì„¤ì¹˜í•˜ì…¨ê³ ìš” <BT> ì˜¤ì— ë‹˜ ë¬´ë”ìš´ ë‚ ì”¨ì— ê±´ê°• ì¡°ì‹¬í•˜ì‹œê³ ìš” <BT> ë˜ ë§Œë‚  ë•Œê¹Œì§€ ì•ˆë…•íˆ ê³„ì‹­ì‹œìš”. <AR> HL1SB DE HL2LKL GL GB TU <VA> E E

R FB HL2LKL DE HL1SB <BT> <KA> ì˜ˆ, ì „ ì˜¤ì— ë‹˜ ì˜¤ëŠ˜ êµì‹  ì •ë§ ê°ì‚¬í–ˆìŠµë‹ˆë‹¤, ê·¸ëŸ¼ ì´ë§Œ ì‹¤ë¡€í•©ë‹ˆë‹¤, ì•ˆë…•íˆ ê³„ì„¸ìš” 73 HL2LKL DE HL1SB 73 TU TU E E

OK <BT> <KA> ì˜ˆ, ì˜¤ì— ë‹˜ ì œê°€ ë” êµì‹ ì„ í•  ìˆ˜ê°€ ìˆì–´ì„œ ì˜ê´‘ì´ì—ˆìŠµë‹ˆë‹¤ <BT> ì•ìœ¼ë¡œ ìì£¼ ë§Œë‚˜ëµ™ê² ìŠµë‹ˆë‹¤ <BT> ë˜ ë§Œë‚˜ë©´ ì•„ë§ˆì¶”ì–´ì— ëŒ€í•´ í•œìˆ˜ë¥¼ ê°€ë¥´ì³ì£¼ì„¸ìš” HI HI <BT> ì•ˆë…•íˆ ê³„ì„¸ìš”. <AR> HL1SB DE HL2LKL GL GB 73 TU TU E E

OK DE HL1SB <BT> <KA> <BT> ì•„ì´ê³  ì˜¤ì— ë‹˜, ê°€ë¥´ì³ ë“œë¦¬ë‹¤ë‡¨ HI ì˜¤ì— ë‹˜ê»˜ì„œëŠ” ì´ë¯¸ ê³ ìˆ˜ì´ì‹ ë°ìš” HI HI 73 HL2LKL DE HL1SB 73 TU TU E E

QSL DR OM TNX FB QSO HPE CUAGN <BT> <AR> HL1SB DE HL2LKL 73 TU E E

73 GB TU TU E E

TU

E

E`);

var english_qso_1_caption = "â€» QSO Sample from : DS1TZE";
var english_qso_1 = (`CQ CQ CQ DE DS1TWO DS1TWO <AR>
DS1TWO DE 6K2KXY 6K2KXY <KN>
6K2KXY DE DS1TWO GM DR OM ES TKS FER CALL <BT> UR RST RST 599 5NN <BT> NAME NAME CHOI CHOI <BT> QTH QTH SEONGNAM SEONGNAM <AR> 6K2KXY DE DS1TWO <KN>
R R DS1TWO DE 6K2KXY GM DR CHOI OM <BT> UR RST RST 599 5NN <BT> NAME NAME SEO SEO <BT> QTH QTH ANYANG ANYANG <AR> DS1TWO DE 6K2KXY <KN>
R R 6K2KXY DE DS1TWO <BT> TKS FER FB QSO DR SEO OM ES HPE CUAGN <AR> 6K2KXY DE DS1TWO 73 SK TU E E
R R DS1TWO DE 6K2KXY <BT> TKS FER FB QSO DR CHOI OM ES HPE CUAGN <AR> DS1TWO DE 6K2KXY 73 SK TU E E
E
E`);

var english_qso_2_caption = "â€» QSO Sample from : <a href='https://hl5ky.tistory.com/99' target='_blank'>https://hl5ky.tistory.com/99</a>";
var english_qso_2  = (`CQ CQ CQ DE HL1ABC HL1ABC PSE K

HL1ABC DE DS5XYZ DS5XYZ <KN>

DS5XYZ DE HL1ABC <BT> GA ES TNX FER CALL <BT> UR RST 569 56N <BT> NAME IS LEE LEE QTH SEOUL SEOUL <BT> HW? <AR> DS5XYZ DE HL1ABC <KN>

HL1ABC DE DS5XYZ <BT> GA DR LEE TNX FB RPT UR RST 599 5NN <BT> OP PARK PARK ES QTH MASAN MASAN <BT> HW? <AR> HL1ABC DE DS5XYZ <KN>

DS5XYZ DE HL1ABC <BT> R PARK TNX RPT ES INFO OM PARK <BT> RIG IS IC7300 ANT IS DP <BT> WX IS WARM 28DC <BT> HW? <AR> DS5XYZ DE HL1ABC <KN>

HL1ABC DE DS5XYZ <BT> RIG IS FT817 ANT IS INV <BT> WX IS RAINY AND COOL <AR> HL1ABC DE DS5XYZ <KN>

DS5XYZ DE HL1ABC <BT> MNI TNX INFO ES FB QSO <BT> QSL VIA BURO <BT> 73 ES CUAGN <AR> DS5XYZ DE HL1ABC <SK>

HL1ABC DE DS5XYZ <BT> FB LEE TNX FER NICE QSO 73 ES BCNU <AR> HL1ABC DE DS5XYZ <SK>

TU 73 E E

TU E E`);

var doc_str = "";
if(qso_name=="hangul_qso_1"){
    doc_str  = hangul_qso_1;
    document.getElementById('user_txt_caption').innerHTML  = hangul_qso_1_caption;
}else if(qso_name=="hangul_qso_2"){
    doc_str  = hangul_qso_2;
    document.getElementById('user_txt_caption').innerHTML  = hangul_qso_2_caption;
}else if(qso_name=="hangul_qso_3"){
    doc_str  = hangul_qso_3;
    document.getElementById('user_txt_caption').innerHTML  = hangul_qso_3_caption;
}else if(qso_name=="hangul_qso_4"){
    doc_str  = hangul_qso_4;
    document.getElementById('user_txt_caption').innerHTML  = hangul_qso_4_caption;
}else if(qso_name=="english_qso_1"){
    doc_str  = english_qso_1;
    document.getElementById('user_txt_caption').innerHTML  = english_qso_1_caption;
}else if(qso_name=="english_qso_2"){
    doc_str  = english_qso_2;
    document.getElementById('user_txt_caption').innerHTML  = english_qso_2_caption;
}
if(document.getElementById('add_vvv').checked) doc_str = add_vvv_text.value + doc_str;
if(document.getElementById('add_ar').checked) doc_str = doc_str + add_ar_text.value;
changeQsoSample(doc_str);
}

function getDeviceInfo() {
    var userAgent = navigator.userAgent.toLowerCase();
    if (/iphone|ipad|ipod/.test(userAgent)) {
        var connected_macine = "Apple Mobile";
    } else if (/android/.test(userAgent)) {
        var connected_macine = "Android Mobile";
    } else {
        var connected_macine = "Personal Computer";
    }
    if (userAgent.indexOf('chrome') > -1) {
        var connected_browser = 'Chrome Browser';
    } else if (userAgent.indexOf('firefox') > -1) {
        var connected_browser = 'Firefox Browser';
    } else if (userAgent.indexOf('safari') > -1) {
        var connected_browser = 'Safari Browser';
    } else if (userAgent.indexOf('trident') > -1) {
        var connected_browser = 'Internet Explorer Browser';
    } else {
        var connected_browser = 'Unknown Browser';
    }
    document.getElementById('user_txt_caption').innerHTML = 'Connected To ' + connected_macine + ' & ' + connected_browser;
}

if(!isAndroid && !isIOS){
    document.getElementById("keyer_setting").style.display = 'inline-block'; 
    var width = 950;
    var height = 300;
    const allelements = document.querySelectorAll('fieldset');
    allelements.forEach(element => {
        element.style.width = width + 'px';
    });
    const allelements2 = document.querySelectorAll('.main_button');
    allelements2.forEach(element => {
        element.style.width = '145px';
        element.style.height = '40px';
        element.style.fontSize = '20px';
        element.style.margin = '0px 5px 0px 5px'; 
    });
    document.getElementById('font_select').style.width = '200px';
    document.querySelector('.CodeMirror').style.width = width + 'px';
    document.querySelector('.CodeMirror').style.height = height + 'px';
    document.querySelector('.log_container_ditdah').style.width = width + 'px';
    document.getElementById('char_layer').style.width = `${width + 2}px`;
    document.getElementById('char_layer').style.height = `${height + 2}px`;
    document.getElementById('textarea_select_char').style.width = `${width + 2}px`;
    document.getElementById('textarea_select_char').style.height = `${height + 2}px`;
    document.querySelector('.progress-bar').style.width = width + 'px';
    font_resize('18');
}

if(localStorage.getItem('textarea_fontsize')){
    document.getElementById('user_txt').style.fontSize = localStorage.getItem('textarea_fontsize');
    document.getElementById('font_text').innerHTML = localStorage.getItem('textarea_fontsize');
} else{
    document.getElementById('user_txt').style.fontSize = '21px';
    document.getElementById('font_text').innerHTML = '21px';
}

function resize(element,size){
    const allelements = document.querySelectorAll(element);
    allelements.forEach(element => {
        element.style.fontSize = size + 'px';
    });
}

function font_resize(size){
    resize('label',size);
    resize('label',size);
    resize('input',size);
    resize('select',size);
    resize('span',size);
}

getDeviceInfo();
</script>
<script>
    function updateLayerPosition() {
        const rect = targetDiv.getBoundingClientRect();
        char_layer.style.top = `${rect.top + window.scrollY}px`;
        char_layer.style.left = `${rect.left + window.scrollX}px`;
    }
    const toggleButton = document.getElementById('textarea_play_char');
    const char_layer = document.getElementById('char_layer');
    const targetDiv = document.getElementById('user_txt');
    const rect = targetDiv.getBoundingClientRect(); 
    toggleButton.addEventListener('click', function() {
        if (char_layer.style.display === 'none' || char_layer.style.display === '') {
            char_layer.style.display = 'block';
            updateLayerPosition();
            char_layer.focus();
        } else {
            char_layer.style.display = 'none';
        }
    });

document.getElementById('textarea_select_char').addEventListener('click', function() {
    play.click();
});

function view_toggle(){
    if(document.getElementById('view1').checked && document.getElementById('view2').checked)
    {
        document.getElementById('view1').checked = false;
        document.getElementById('view2').checked = false;
        toggleSetting1(false);
        toggleSetting2(false);
    }else{
        document.getElementById('view1').checked = true;
        document.getElementById('view2').checked = true;
        toggleSetting1(true);
        toggleSetting2(true);
    }
}

document.getElementById('ditdah').addEventListener('click', function() {
    document.getElementById('textarea_play_char').click();
});

document.querySelector('.progress-bar').addEventListener('click', function() {
    play.click();
});

function setProgressBar(percent) {
    const progressBar = document.querySelector('.progress');
    progressBar.style.width = percent + '%';
}
setProgressBar(0);
</script>

<script>
    let timerDisplay = 0;
    let secondsElapsed = 0;

    let timer = null;
    let running = false;

    if(window.localStorage.getItem('timerDisplay_total')){
        var timerDisplay_total = window.localStorage.getItem('timerDisplay_total');
    }else{
        var timerDisplay_total = 0; 
    }

    window.localStorage.setItem('timerDisplay_total', timerDisplay_total);
    document.getElementById('timerDisplay_total').innerHTML = formatTime(timerDisplay_total);

    function formatTime(seconds) {
        const hours = String(Math.floor(seconds / 3600)).padStart(2, '0');
        const minutes = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
        const secondsLeft = String(seconds % 60).padStart(2, '0');
        return `${hours}:${minutes}:${secondsLeft}`;
    }

    function updateTimer() {
        secondsElapsed++;
        timerDisplay_total++;
        document.getElementById('timerDisplay').innerHTML = formatTime(secondsElapsed);
        document.getElementById('timerDisplay_total').innerHTML = formatTime(timerDisplay_total);
        window.localStorage.setItem('timerDisplay_total', timerDisplay_total);
        updateLayerPosition();
    }

    function timer_stop(){
        clearInterval(timer);
        running = false;
    }
    function timer_start(){
        timer = setInterval(updateTimer, 1000);
        running = true;
    }
    function timer_reset(){
        timer_stop();
        secondsElapsed = 0;
        document.getElementById('timerDisplay').innerHTML = '00:00:00';
    }

const targetElement = document.getElementById('user_txt');
const observer = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
    if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
        updateLayerPosition();
    }
    });
});
const config = { attributes: true };
observer.observe(targetElement, config);
</script>
</BODY>
</HTML>  